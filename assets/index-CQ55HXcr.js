import{r as Vn}from"./katex-tJs74nH5.js";import{M as wi}from"./marked-6_4nRR25.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();var Ot,x,wn,xn,ht,Ue,kn,be,Hn,Ae,Ve,we,Cn,Pt={},Mn=[],xi=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,le=Array.isArray;function st(n,t){for(var e in t)n[e]=t[e];return n}function $e(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function Jt(n,t,e){var i,s,r,o={};for(r in t)r=="key"?i=t[r]:r=="ref"?s=t[r]:o[r]=t[r];if(arguments.length>2&&(o.children=arguments.length>3?Ot.call(arguments,2):e),typeof n=="function"&&n.defaultProps!=null)for(r in n.defaultProps)o[r]===void 0&&(o[r]=n.defaultProps[r]);return Mt(n,o,i,s,null)}function Mt(n,t,e,i,s){var r={type:n,props:t,key:e,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++wn,__i:-1,__u:0};return s==null&&x.vnode!=null&&x.vnode(r),r}function ft(n){return n.children}function nt(n,t){this.props=n,this.context=t}function yt(n,t){if(t==null)return n.__?yt(n.__,n.__i+1):null;for(var e;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null)return e.__e;return typeof n.type=="function"?yt(n):null}function Sn(n){var t,e;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,t=0;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null){n.__e=n.__c.base=e.__e;break}return Sn(n)}}function xe(n){(!n.__d&&(n.__d=!0)&&ht.push(n)&&!Qt.__r++||Ue!==x.debounceRendering)&&((Ue=x.debounceRendering)||kn)(Qt)}function Qt(){var n,t,e,i,s,r,o,a;for(ht.sort(be);n=ht.shift();)n.__d&&(t=ht.length,i=void 0,r=(s=(e=n).__v).__e,o=[],a=[],e.__P&&((i=st({},s)).__v=s.__v+1,x.vnode&&x.vnode(i),Le(e.__P,i,s,e.__n,e.__P.namespaceURI,32&s.__u?[r]:null,o,r??yt(s),!!(32&s.__u),a),i.__v=s.__v,i.__.__k[i.__i]=i,Ln(o,i,a),i.__e!=r&&Sn(i)),ht.length>t&&ht.sort(be));Qt.__r=0}function An(n,t,e,i,s,r,o,a,l,u,f){var h,d,p,_,y,k,g=i&&i.__k||Mn,v=t.length;for(l=ki(e,t,g,l,v),h=0;h<v;h++)(p=e.__k[h])!=null&&(d=p.__i===-1?Pt:g[p.__i]||Pt,p.__i=h,k=Le(n,p,d,s,r,o,a,l,u,f),_=p.__e,p.ref&&d.ref!=p.ref&&(d.ref&&Ie(d.ref,null,p),f.push(p.ref,p.__c||_,p)),y==null&&_!=null&&(y=_),4&p.__u||d.__k===p.__k?l=$n(p,l,n):typeof p.type=="function"&&k!==void 0?l=k:_&&(l=_.nextSibling),p.__u&=-7);return e.__e=y,l}function ki(n,t,e,i,s){var r,o,a,l,u,f=e.length,h=f,d=0;for(n.__k=new Array(s),r=0;r<s;r++)(o=t[r])!=null&&typeof o!="boolean"&&typeof o!="function"?(l=r+d,(o=n.__k[r]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Mt(null,o,null,null,null):le(o)?Mt(ft,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?Mt(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,a=null,(u=o.__i=Hi(o,e,l,h))!==-1&&(h--,(a=e[u])&&(a.__u|=2)),a==null||a.__v===null?(u==-1&&d--,typeof o.type!="function"&&(o.__u|=4)):u!=l&&(u==l-1?d--:u==l+1?d++:(u>l?d--:d++,o.__u|=4))):n.__k[r]=null;if(h)for(r=0;r<f;r++)(a=e[r])!=null&&!(2&a.__u)&&(a.__e==i&&(i=yt(a)),In(a,a));return i}function $n(n,t,e){var i,s;if(typeof n.type=="function"){for(i=n.__k,s=0;i&&s<i.length;s++)i[s]&&(i[s].__=n,t=$n(i[s],t,e));return t}n.__e!=t&&(t&&n.type&&!e.contains(t)&&(t=yt(n)),e.insertBefore(n.__e,t||null),t=n.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function te(n,t){return t=t||[],n==null||typeof n=="boolean"||(le(n)?n.some(function(e){te(e,t)}):t.push(n)),t}function Hi(n,t,e,i){var s,r,o=n.key,a=n.type,l=t[e];if(l===null||l&&o==l.key&&a===l.type&&!(2&l.__u))return e;if(i>(l!=null&&!(2&l.__u)?1:0))for(s=e-1,r=e+1;s>=0||r<t.length;){if(s>=0){if((l=t[s])&&!(2&l.__u)&&o==l.key&&a===l.type)return s;s--}if(r<t.length){if((l=t[r])&&!(2&l.__u)&&o==l.key&&a===l.type)return r;r++}}return-1}function Re(n,t,e){t[0]=="-"?n.setProperty(t,e??""):n[t]=e==null?"":typeof e!="number"||xi.test(t)?e:e+"px"}function Bt(n,t,e,i,s){var r;t:if(t=="style")if(typeof e=="string")n.style.cssText=e;else{if(typeof i=="string"&&(n.style.cssText=i=""),i)for(t in i)e&&t in e||Re(n.style,t,"");if(e)for(t in e)i&&e[t]===i[t]||Re(n.style,t,e[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(Hn,"$1")),t=t.toLowerCase()in n||t=="onFocusOut"||t=="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),n.l||(n.l={}),n.l[t+r]=e,e?i?e.u=i.u:(e.u=Ae,n.addEventListener(t,r?we:Ve,r)):n.removeEventListener(t,r?we:Ve,r);else{if(s=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in n)try{n[t]=e??"";break t}catch{}typeof e=="function"||(e==null||e===!1&&t[4]!="-"?n.removeAttribute(t):n.setAttribute(t,t=="popover"&&e==1?"":e))}}function Be(n){return function(t){if(this.l){var e=this.l[t.type+n];if(t.t==null)t.t=Ae++;else if(t.t<e.u)return;return e(x.event?x.event(t):t)}}}function Le(n,t,e,i,s,r,o,a,l,u){var f,h,d,p,_,y,k,g,v,W,L,q,j,C,E,z,M,U=t.type;if(t.constructor!==void 0)return null;128&e.__u&&(l=!!(32&e.__u),r=[a=t.__e=e.__e]),(f=x.__b)&&f(t);t:if(typeof U=="function")try{if(g=t.props,v="prototype"in U&&U.prototype.render,W=(f=U.contextType)&&i[f.__c],L=f?W?W.props.value:f.__:i,e.__c?k=(h=t.__c=e.__c).__=h.__E:(v?t.__c=h=new U(g,L):(t.__c=h=new nt(g,L),h.constructor=U,h.render=Mi),W&&W.sub(h),h.props=g,h.state||(h.state={}),h.context=L,h.__n=i,d=h.__d=!0,h.__h=[],h._sb=[]),v&&h.__s==null&&(h.__s=h.state),v&&U.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=st({},h.__s)),st(h.__s,U.getDerivedStateFromProps(g,h.__s))),p=h.props,_=h.state,h.__v=t,d)v&&U.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),v&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(v&&U.getDerivedStateFromProps==null&&g!==p&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(g,L),!h.__e&&(h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(g,h.__s,L)===!1||t.__v==e.__v)){for(t.__v!=e.__v&&(h.props=g,h.state=h.__s,h.__d=!1),t.__e=e.__e,t.__k=e.__k,t.__k.some(function(Y){Y&&(Y.__=t)}),q=0;q<h._sb.length;q++)h.__h.push(h._sb[q]);h._sb=[],h.__h.length&&o.push(h);break t}h.componentWillUpdate!=null&&h.componentWillUpdate(g,h.__s,L),v&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(p,_,y)})}if(h.context=L,h.props=g,h.__P=n,h.__e=!1,j=x.__r,C=0,v){for(h.state=h.__s,h.__d=!1,j&&j(t),f=h.render(h.props,h.state,h.context),E=0;E<h._sb.length;E++)h.__h.push(h._sb[E]);h._sb=[]}else do h.__d=!1,j&&j(t),f=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++C<25);h.state=h.__s,h.getChildContext!=null&&(i=st(st({},i),h.getChildContext())),v&&!d&&h.getSnapshotBeforeUpdate!=null&&(y=h.getSnapshotBeforeUpdate(p,_)),a=An(n,le(z=f!=null&&f.type===ft&&f.key==null?f.props.children:f)?z:[z],t,e,i,s,r,o,a,l,u),h.base=t.__e,t.__u&=-161,h.__h.length&&o.push(h),k&&(h.__E=h.__=null)}catch(Y){if(t.__v=null,l||r!=null)if(Y.then){for(t.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,t.__e=a}else for(M=r.length;M--;)$e(r[M]);else t.__e=e.__e,t.__k=e.__k;x.__e(Y,t,e)}else r==null&&t.__v==e.__v?(t.__k=e.__k,t.__e=e.__e):a=t.__e=Ci(e.__e,t,e,i,s,r,o,l,u);return(f=x.diffed)&&f(t),128&t.__u?void 0:a}function Ln(n,t,e){for(var i=0;i<e.length;i++)Ie(e[i],e[++i],e[++i]);x.__c&&x.__c(t,n),n.some(function(s){try{n=s.__h,s.__h=[],n.some(function(r){r.call(s)})}catch(r){x.__e(r,s.__v)}})}function Ci(n,t,e,i,s,r,o,a,l){var u,f,h,d,p,_,y,k=e.props,g=t.props,v=t.type;if(v=="svg"?s="http://www.w3.org/2000/svg":v=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((p=r[u])&&"setAttribute"in p==!!v&&(v?p.localName==v:p.nodeType==3)){n=p,r[u]=null;break}}if(n==null){if(v==null)return document.createTextNode(g);n=document.createElementNS(s,v,g.is&&g),a&&(x.__m&&x.__m(t,r),a=!1),r=null}if(v===null)k===g||a&&n.data===g||(n.data=g);else{if(r=r&&Ot.call(n.childNodes),k=e.props||Pt,!a&&r!=null)for(k={},u=0;u<n.attributes.length;u++)k[(p=n.attributes[u]).name]=p.value;for(u in k)if(p=k[u],u!="children"){if(u=="dangerouslySetInnerHTML")h=p;else if(!(u in g)){if(u=="value"&&"defaultValue"in g||u=="checked"&&"defaultChecked"in g)continue;Bt(n,u,null,p,s)}}for(u in g)p=g[u],u=="children"?d=p:u=="dangerouslySetInnerHTML"?f=p:u=="value"?_=p:u=="checked"?y=p:a&&typeof p!="function"||k[u]===p||Bt(n,u,p,k[u],s);if(f)a||h&&(f.__html===h.__html||f.__html===n.innerHTML)||(n.innerHTML=f.__html),t.__k=[];else if(h&&(n.innerHTML=""),An(n,le(d)?d:[d],t,e,i,v=="foreignObject"?"http://www.w3.org/1999/xhtml":s,r,o,r?r[0]:e.__k&&yt(e,0),a,l),r!=null)for(u=r.length;u--;)$e(r[u]);a||(u="value",v=="progress"&&_==null?n.removeAttribute("value"):_!==void 0&&(_!==n[u]||v=="progress"&&!_||v=="option"&&_!==k[u])&&Bt(n,u,_,k[u],s),u="checked",y!==void 0&&y!==n[u]&&Bt(n,u,y,k[u],s))}return n}function Ie(n,t,e){try{if(typeof n=="function"){var i=typeof n.__u=="function";i&&n.__u(),i&&t==null||(n.__u=n(t))}else n.current=t}catch(s){x.__e(s,e)}}function In(n,t,e){var i,s;if(x.unmount&&x.unmount(n),(i=n.ref)&&(i.current&&i.current!==n.__e||Ie(i,null,t)),(i=n.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){x.__e(r,t)}i.base=i.__P=null}if(i=n.__k)for(s=0;s<i.length;s++)i[s]&&In(i[s],t,e||typeof n.type!="function");e||$e(n.__e),n.__c=n.__=n.__e=void 0}function Mi(n,t,e){return this.constructor(n,e)}function Si(n,t,e){var i,s,r,o;t==document&&(t=document.documentElement),x.__&&x.__(n,t),s=(i=!1)?null:t.__k,r=[],o=[],Le(t,n=t.__k=Jt(ft,null,[n]),s||Pt,Pt,t.namespaceURI,s?null:t.firstChild?Ot.call(t.childNodes):null,r,s?s.__e:t.firstChild,i,o),Ln(r,n,o)}function Ai(n,t,e){var i,s,r,o,a=st({},n.props);for(r in n.type&&n.type.defaultProps&&(o=n.type.defaultProps),t)r=="key"?i=t[r]:r=="ref"?s=t[r]:a[r]=t[r]===void 0&&o!==void 0?o[r]:t[r];return arguments.length>2&&(a.children=arguments.length>3?Ot.call(arguments,2):e),Mt(n.type,a,i||n.key,s||n.ref,null)}function Pe(n,t){var e={__c:t="__cC"+Cn++,__:n,Consumer:function(i,s){return i.children(s)},Provider:function(i){var s,r;return this.getChildContext||(s=new Set,(r={})[t]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){s=null},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&s.forEach(function(a){a.__e=!0,xe(a)})},this.sub=function(o){s.add(o);var a=o.componentWillUnmount;o.componentWillUnmount=function(){s&&s.delete(o),a&&a.call(o)}}),i.children}};return e.Provider.__=e.Consumer.contextType=e}Ot=Mn.slice,x={__e:function(n,t,e,i){for(var s,r,o;t=t.__;)if((s=t.__c)&&!s.__)try{if((r=s.constructor)&&r.getDerivedStateFromError!=null&&(s.setState(r.getDerivedStateFromError(n)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(n,i||{}),o=s.__d),o)return s.__E=s}catch(a){n=a}throw n}},wn=0,xn=function(n){return n!=null&&n.constructor==null},nt.prototype.setState=function(n,t){var e;e=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=st({},this.state),typeof n=="function"&&(n=n(st({},e),this.props)),n&&st(e,n),n!=null&&this.__v&&(t&&this._sb.push(t),xe(this))},nt.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),xe(this))},nt.prototype.render=ft,ht=[],kn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,be=function(n,t){return n.__v.__b-t.__v.__b},Qt.__r=0,Hn=/(PointerCapture)$|Capture$/i,Ae=0,Ve=Be(!1),we=Be(!0),Cn=0;var $i=0;function c(n,t,e,i,s,r){t||(t={});var o,a,l=t;if("ref"in l)for(a in l={},t)a=="ref"?o=t[a]:l[a]=t[a];var u={type:n,props:l,key:e,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--$i,__i:-1,__u:0,__source:s,__self:r};if(typeof n=="function"&&(o=n.defaultProps))for(a in o)l[a]===void 0&&(l[a]=o[a]);return x.vnode&&x.vnode(u),u}var pt,P,_e,Fe,Nt=0,Pn=[],G=x,qe=G.__b,je=G.__r,Ze=G.diffed,Ye=G.__c,Xe=G.unmount,Ke=G.__;function Wt(n,t){G.__h&&G.__h(P,n,Nt||t),Nt=0;var e=P.__H||(P.__H={__:[],__h:[]});return n>=e.__.length&&e.__.push({}),e.__[n]}function ce(n){return Nt=1,Li(Dn,n)}function Li(n,t,e){var i=Wt(pt++,2);if(i.t=n,!i.__c&&(i.__=[e?e(t):Dn(void 0,t),function(a){var l=i.__N?i.__N[0]:i.__[0],u=i.t(l,a);l!==u&&(i.__N=[u,i.__[1]],i.__c.setState({}))}],i.__c=P,!P.u)){var s=function(a,l,u){if(!i.__c.__H)return!0;var f=i.__c.__H.__.filter(function(d){return!!d.__c});if(f.every(function(d){return!d.__N}))return!r||r.call(this,a,l,u);var h=i.__c.props!==a;return f.forEach(function(d){if(d.__N){var p=d.__[0];d.__=d.__N,d.__N=void 0,p!==d.__[0]&&(h=!0)}}),r&&r.call(this,a,l,u)||h};P.u=!0;var r=P.shouldComponentUpdate,o=P.componentWillUpdate;P.componentWillUpdate=function(a,l,u){if(this.__e){var f=r;r=void 0,s(a,l,u),r=f}o&&o.call(this,a,l,u)},P.shouldComponentUpdate=s}return i.__N||i.__}function ue(n,t){var e=Wt(pt++,3);!G.__s&&Ne(e.__H,t)&&(e.__=n,e.i=t,P.__H.__h.push(e))}function Tt(n,t){var e=Wt(pt++,4);!G.__s&&Ne(e.__H,t)&&(e.__=n,e.i=t,P.__h.push(e))}function gt(n){return Nt=5,he(function(){return{current:n}},[])}function Nn(n,t,e){Nt=6,Tt(function(){return typeof n=="function"?(n(t()),function(){return n(null)}):n?(n.current=t(),function(){return n.current=null}):void 0},e==null?e:e.concat(n))}function he(n,t){var e=Wt(pt++,7);return Ne(e.__H,t)&&(e.__=n(),e.__H=t,e.__h=n),e.__}function Tn(n){var t=P.context[n.__c],e=Wt(pt++,9);return e.c=n,t?(e.__==null&&(e.__=!0,t.sub(P)),t.props.value):n.__}function Ii(){for(var n;n=Pn.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(Xt),n.__H.__h.forEach(ke),n.__H.__h=[]}catch(t){n.__H.__h=[],G.__e(t,n.__v)}}G.__b=function(n){P=null,qe&&qe(n)},G.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),Ke&&Ke(n,t)},G.__r=function(n){je&&je(n),pt=0;var t=(P=n.__c).__H;t&&(_e===P?(t.__h=[],P.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.i=e.__N=void 0})):(t.__h.forEach(Xt),t.__h.forEach(ke),t.__h=[],pt=0)),_e=P},G.diffed=function(n){Ze&&Ze(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(Pn.push(t)!==1&&Fe===G.requestAnimationFrame||((Fe=G.requestAnimationFrame)||Pi)(Ii)),t.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.i=void 0})),_e=P=null},G.__c=function(n,t){t.some(function(e){try{e.__h.forEach(Xt),e.__h=e.__h.filter(function(i){return!i.__||ke(i)})}catch(i){t.some(function(s){s.__h&&(s.__h=[])}),t=[],G.__e(i,e.__v)}}),Ye&&Ye(n,t)},G.unmount=function(n){Xe&&Xe(n);var t,e=n.__c;e&&e.__H&&(e.__H.__.forEach(function(i){try{Xt(i)}catch(s){t=s}}),e.__H=void 0,t&&G.__e(t,e.__v))};var Je=typeof requestAnimationFrame=="function";function Pi(n){var t,e=function(){clearTimeout(i),Je&&cancelAnimationFrame(t),setTimeout(n)},i=setTimeout(e,100);Je&&(t=requestAnimationFrame(e))}function Xt(n){var t=P,e=n.__c;typeof e=="function"&&(n.__c=void 0,e()),P=t}function ke(n){var t=P;n.__c=n.__(),P=t}function Ne(n,t){return!n||n.length!==t.length||t.some(function(e,i){return e!==n[i]})}function Dn(n,t){return typeof t=="function"?t(n):t}const Ni={id:"wire",name:"Wire",category:"Conductors",prefix:"W",shapes:[["l",-15,15,15,-15]],pins:[["a",-15,15],["a",15,-15]],labels:[0,0,"cm"],device:null},Ti={id:"g",name:"Ground",category:"Conductors",prefix:"G",shapes:[["l",0,0,0,15],["l",-20,15,20,15],["l",-10,20,10,20],["l",-5,25,5,25]],pins:[["a",0,0]],labels:[0,30,"ct"],device:null},Di={id:"p",name:"Port",category:"Conductors",prefix:"P",shapes:[["l",0,-15,0,0],["c",0,-25,10]],pins:[["a",0,0]],labels:[0,-40,"cb"],device:null},rt={wire:Ni,ground:Ti,port:Di};class Z extends Error{name="CircuitError";constructor(t,e){super(t,e)}}let V=class En{static number(t){return{type:"number",...t}}static string(t){return{type:"string",...t}}static temp=En.number({defaultValue:26.85,range:["real",">",-273.15],title:"device temperature in degrees Celsius"});schema=new Map;values=new Map;constructor(t){for(const[e,i]of Object.entries(t))this.schema.set(e,i)}names(){return[...this.schema.keys()]}prop(t){const e=this.schema.get(t);if(e==null){const i=this.names();throw new Z(`Unknown property [${t}]. Expected one of ${i.map(s=>`[${s}]`).join(", ")}.`)}return e}from(t){for(const[e,i]of t.values.entries())this.set(e,i)}hasAll(){for(const[t,e]of this.schema.entries())if(!this.values.has(t)&&e.defaultValue==null)return!1;return!0}has(t){return this.prop(t),this.values.has(t)}set(t,e){const i=this.prop(t);switch(i.type){case"number":{Ei(i,t,e);break}case"string":{Gi(i,t,e);break}}return this.values.set(t,e),this}getNumber(t,e=null){const i=this.prop(t);if(i.type!=="number")throw new Z(`Property [${t}] is not a number.`);const s=this.values.get(t)??e??i.defaultValue;if(s==null)throw new Z(`Property [${t}] has no value.`);return s}getString(t,e=null){const i=this.prop(t);if(i.type!=="string")throw new Z(`Property [${t}] is not a string.`);const s=this.values.get(t)??e??i.defaultValue;if(s==null)throw new Z(`Property [${t}] has no value.`);return s}};function Ei(n,t,e){if(typeof e!="number")throw new Z(`Invalid value for property [${t}]. Expected a number, got ${ct(e)}.`);const{range:i=["real"]}=n,[s,...r]=i;switch(s){case"real":if(!Number.isFinite(e))throw new Z(`Invalid value for property [${t}]. Not a finite value.`);break;case"integer":if(!Number.isInteger(e))throw new Z(`Invalid value for property [${t}]. Not an integer value.`);break}let o=0;for(;o<r.length;){const a=r[o++],l=r[o++];switch(a){case">":if(e<=l)throw new Z(`Invalid value for property [${t}]. Expected a value larger than ${l}, got ${ct(e)}.`);break;case">=":if(e<l)throw new Z(`Invalid value for property [${t}]. Expected a value larger than or equal to ${l}, got ${ct(e)}.`);break;case"<":if(e>=l)throw new Z(`Invalid value for property [${t}]. Expected a value less than ${l}, got ${ct(e)}.`);break;case"<=":if(e>l)throw new Z(`Invalid value for property [${t}]. Expected a value less than or equal to ${l}, got ${ct(e)}.`);break;case"<>":if(e===l)throw new Z(`Invalid value for property [${t}]. Expected a value not equal to ${l}.`);break}}}function Gi(n,t,e){if(typeof e!="string")throw new Z(`Invalid value for property [${t}]. Expected a string, got ${ct(e)}.`);const{range:i=[]}=n;if(i.length>0&&!i.includes(e))throw new Z(`Invalid value for property [${t}]. Expected one of ${i.map(s=>ct(s)).join(", ")}, got ${ct(e)}.`)}function ct(n){switch(typeof n){case"string":return`"${n}"`;case"number":return String(n)}return`[${n}]`}class O{static dummy=new class extends O{static id="DUMMY";static numTerminals=0;static propsSchema={};static stateSchema={length:0,ops:[]};constructor(){super("DUMMY")}};static id;static numTerminals;static propsSchema;static stateSchema;static linear=!0;static Dc=class extends O{initTr(e,i){this.initDc(e,i)}loadTr(e,i,s){this.loadDc(e,i,s)}endTr(e,i){this.endDc(e,i)}};id;props;state;diffs=[];constructor(t){this.id=t;const{propsSchema:e,stateSchema:i}=this.deviceClass;this.props=new V(e),this.state=new Float64Array(i.length)}get deviceClass(){return this.constructor}connect(t,e){}init(t){}initDc(t,e){}loadDc(t,e,i){}endDc(t,e){}initTr(t,e){}loadTr(t,e,i){}endTr(t,e){}initAc(t){}loadAc(t,e,i){}endAc(t){}}function Oi(n){const t=new Array(n);for(let e=0;e<n;e++)t[e]=He(n);return t}function Wi(n,t=0){for(const e of n)e.fill(t)}function He(n){return new Float64Array(n)}function Qe(n,t=0){n.fill(t)}function Te(n,t){t.set(n)}function zi(n){const t=new Int32Array(n);return Gn(t),t}function Gn(n){for(let t=0;t<n.length;t++)n[t]=t}function On(n,t,e){return Ui(n,t,e,e)}function Ui(n,t,e,i){let s=e,r=Math.abs(n[e][i]);for(e++;e<t;){const o=Math.abs(n[e][i]);o>r&&(s=e,r=o),e++}return s}function ee(n,t,e){const i=n[t];n[t]=n[e],n[e]=i}class Ri extends Error{name="MathError";constructor(t,e){super(t,e)}}class De extends Ri{name="SingularMatrixError";constructor(t){super("Singular matrix.",t)}}function Bi(n){const{size:t,A:e,x:i,b:s}=n;for(let r=0;r<t;r++){n.findPivot(r);const o=e[r][r];if(o===0)throw new De;for(let a=r;a<t;a++)e[r][a]/=o;s[r]/=o;for(let a=0;a<t;a++)if(a!==r){const l=e[a][r];for(let u=r;u<t;u++)e[a][u]-=e[r][u]*l;s[a]-=s[r]*l}}Te(s,i)}function Fi(n){const{size:t,A:e,x:i,b:s}=n;for(let r=0;r<t-1;r++){n.findPivot(r);const o=e[r][r];if(o===0)throw new De;for(let a=r+1;a<t;a++){const l=e[a][r]/o;for(let u=r;u<t;u++)e[a][u]-=e[r][u]*l;s[a]-=s[r]*l}}for(let r=t-1;r>=0;r--){s[r]/=e[r][r];for(let o=r-1;o>=0;o--)s[o]-=e[o][r]*s[r]}Te(s,i)}function qi(n){const{size:t,A:e,perm:i}=n;for(let s=0;s<t;s++){Zi(e,i,t,s);const r=e[s][s];if(r===0)throw new De;for(let o=s+1;o<t;o++)e[s][o]/=r;for(let o=s+1;o<t;o++)for(let a=s+1;a<t;a++)e[o][a]-=e[o][s]*e[s][a]}}function ji(n){const{size:t,A:e,x:i,b:s,perm:r}=n;for(let o=0;o<t;o++){let a=0;for(let l=0;l<o;l++)a+=e[o][l]*i[l];i[o]=(s[r[o]]-a)/e[o][o]}for(let o=t-1;o>=0;o--){let a=0;for(let l=o+1;l<t;l++)a+=e[o][l]*s[l];s[o]=i[o]-a}Te(s,i)}function Zi(n,t,e,i){const s=On(n,e,i);s!==i&&(ee(n,i,s),ee(t,i,s))}var St;(function(n){n.Gauss="gauss",n.GaussJordan="gauss-jordan",n.LU="lu"})(St||(St={}));class Yi{size;A;x;b;perm;constructor(t){this.size=t,this.A=Oi(t),this.x=He(t),this.b=He(t),this.perm=zi(t)}clear(){Wi(this.A),Qe(this.x),Qe(this.b),Gn(this.perm)}solve(t){switch(t){case St.Gauss:Fi(this);break;case St.GaussJordan:Bi(this);break;case St.LU:qi(this),ji(this);break}}findPivot(t){const{size:e,A:i,b:s}=this,r=On(i,e,t);r!==t&&(ee(i,t,r),ee(s,t,r))}}var tn;(function(n){n.Euler="euler",n.Trapezoidal="trapezoidal",n.Gear="gear"})(tn||(tn={}));const en=Symbol("tran"),Xi=Symbol("index");class Wn{[en];[Xi];V=0;C=0;I=0;Geq=0;Ieq=0;diff(t,e){this[en].diff(this,t,e)}}const Ki=6;(()=>{const n=new Array;for(let t=0;t<=Ki+1;t++)n.push(new Yi(t));return n})();class Ji extends O{static id="C";static numTerminals=2;static propsSchema={C:V.number({title:"capacitance",range:["real",">",0]}),V0:V.number({title:"initial voltage",defaultValue:0})};static stateSchema={length:4,ops:[{index:2,name:"V",unit:"V"},{index:3,name:"I",unit:"A"}]};diff=new Wn;na;nb;constructor(t){super(t),this.diffs.push(this.diff)}connect(t,[e,i]){this.na=e,this.nb=i}init(t){t[0]=this.props.getNumber("C"),t[1]=this.props.getNumber("V0")}endDc(t,e){const{na:i,nb:s}=this;t[2]=i.voltage-s.voltage,t[3]=0}loadTr(t,{time:e},i){const{diff:s,na:r,nb:o}=this,a=t[0],l=e>0?r.voltage-o.voltage:t[1];s.diff(l,a),t[2]=s.V,t[3]=s.I,i.stampConductance(r,o,s.Geq),i.stampCurrentSource(r,o,s.Ieq)}loadAc(t,e,i){const{na:s,nb:r}=this,o=t[0],a=2*Math.PI*e*o;i.stampConductance(s,r,0,a)}}class Qi extends O{static id="L";static numTerminals=2;static propsSchema={L:V.number({title:"inductance",range:["real",">",0]}),I0:V.number({title:"initial current",defaultValue:0})};static stateSchema={length:4,ops:[{index:2,name:"V",unit:"V"},{index:3,name:"I",unit:"A"}]};diff=new Wn;na;nb;branch;constructor(t){super(t),this.diffs.push(this.diff)}connect(t,[e,i]){this.na=e,this.nb=i,this.branch=t.makeBranch(this.na,this.nb)}init(t){t[0]=this.props.getNumber("L"),t[1]=this.props.getNumber("I0")}loadDc(t,e,i){const{na:s,nb:r,branch:o}=this;i.stampVoltageSource(s,r,o,0)}endDc(t,e){const{branch:i}=this;t[2]=0,t[3]=i.current}loadTr(t,{time:e},i){const{diff:s,na:r,nb:o,branch:a}=this,l=t[0],u=e>0?a.current:t[1];s.diff(u,l),t[2]=s.I,t[3]=s.V,i.stampA(a,a,-s.Geq),i.stampVoltageSource(r,o,a,s.Ieq)}loadAc(t,e,i){const{na:s,nb:r}=this,o=t[0],a=-1/(2*Math.PI*e*o);i.stampConductance(s,r,0,a)}}class ts extends O.Dc{static id="R";static numTerminals=2;static propsSchema={R:V.number({title:"resistance",range:["real","<>",0]})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};na;nb;connect(t,[e,i]){this.na=e,this.nb=i}init(t){const e=this.props.getNumber("R");t[0]=1/e}loadDc(t,e,i){const{na:s,nb:r}=this,o=t[0];i.stampConductance(s,r,o)}endDc(t,e){const{na:i,nb:s}=this,r=t[0],o=i.voltage-s.voltage,a=o*r;t[1]=o,t[2]=a}loadAc(t,e,i){const{na:s,nb:r}=this,o=t[0];i.stampConductance(s,r,o,0)}}function zt(n){return n+273.15}const es=zt(26.85),ns=1602176634e-28,is=1380649e-29,ss=3,rs=1.11,os=2/Math.PI,as=Math.PI/2,tt=1e-12,zn="npn",Un="pnp",Ee="nfet",Ge="pfet";function ls(n){switch(n){case zn:return 1;case Un:return-1}}function Rn(n){switch(n){case Ee:return 1;case Ge:return-1}}function vt(n,t,e){const i=n/es,s=e*n*(is/ns),r=t*Math.pow(i,ss/e)*Math.exp((i-1)*(rs/s)),o=s*Math.log(s/Math.sqrt(2)/r);return[s,r,o]}function dt(n,t,e){if(n>=0){const i=1/e;return t*(Math.exp(i*n)-1)}else return 0}function _t(n,t,e){if(n>=0){const i=1/e;return i*t*Math.exp(i*n)}else return 0}function mt(n,t,e,i){if(n>=0&&n>i&&Math.abs(n-t)>2*e)if(t>0){const s=(n-t)/e;s>0?n=t+e*(2+Math.log(s-2)):n=t-e*(2+Math.log(2-s))}else n=i;return n}function Ft(n,t){return Math.abs(n-t)>.5?n>t?t+.5:t-.5:n}class Bn extends O.Dc{static id="BJT";static numTerminals=3;static propsSchema={polarity:V.string({range:[zn,Un],title:"transistor polarity"}),Bf:V.number({defaultValue:100,range:["real",">",0],title:"forward beta"}),Br:V.number({defaultValue:1,range:["real",">",0],title:"reverse beta"}),Is:V.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),Nf:V.number({defaultValue:1,range:["real",">",0],title:"forward emission coefficient"}),Nr:V.number({defaultValue:1,range:["real",">",0],title:"reverse emission coefficient"}),Vaf:V.number({defaultValue:10,range:["real",">=",0],title:"forward Early voltage"}),Var:V.number({defaultValue:0,range:["real",">=",0],title:"reverse Early voltage"}),temp:V.temp};static stateSchema={length:16,ops:[{index:8,name:"Vbe",unit:"V"},{index:9,name:"Vbc",unit:"V"},{index:10,name:"Vce",unit:"V"},{index:11,name:"Ie",unit:"A"},{index:12,name:"Ic",unit:"A"},{index:13,name:"Ib",unit:"A"}]};static linear=!1;ne;nb;nc;connect(t,[e,i,s]){this.ne=e,this.nb=i,this.nc=s}initDc(t,e){const i=this.props.getString("polarity"),s=this.props.getNumber("Bf"),r=this.props.getNumber("Br"),o=this.props.getNumber("Is"),a=this.props.getNumber("Nf"),l=this.props.getNumber("Nr"),u=zt(this.props.getNumber("temp",e.temp)),f=ls(i),h=s/(s+1),d=r/(r+1),[p,,_]=vt(u,o,a),[y,,k]=vt(u,o,l),[,g]=vt(u,o,1);t[0]=f,t[1]=h,t[2]=d,t[3]=g,t[4]=p,t[5]=y,t[6]=_,t[7]=k}eval(t,e){const{ne:i,nb:s,nc:r}=this,o=t[0],a=t[1],l=t[2],u=t[3],f=t[4],h=t[5],d=t[6],p=t[7];let _=o*(s.voltage-i.voltage),y=o*(s.voltage-r.voltage);e&&(_=mt(_,o*t[8],f,d),y=mt(y,o*t[9],h,p));const k=dt(_,u,f),g=dt(y,u,h),v=l*g-k,W=a*k-g,L=_t(_,u,f)+tt,q=_t(y,u,h)+tt;t[8]=o*_,t[9]=o*y,t[10]=o*(_-y),t[11]=o*v,t[12]=o*W,t[13]=o*-(v+W),t[14]=L,t[15]=q}loadDc(t,e,i){const{ne:s,nb:r,nc:o}=this;this.eval(t,!0);const a=t[0],l=t[1],u=t[2],f=a*t[8],h=a*t[9],d=a*t[11],p=a*t[12],_=t[14],y=t[15],k=-_,g=-y,v=u*y,W=l*_;i.stampConductance(s,r,-k),i.stampConductance(o,r,-g),i.stampTransconductance(s,r,o,r,-v),i.stampTransconductance(o,r,s,r,-W),i.stampCurrentSource(s,r,a*(d-k*f-v*h)),i.stampCurrentSource(o,r,a*(p-W*f-g*h))}endDc(t,e){this.eval(t,!1)}}class fe extends O.Dc{static id="Diode";static numTerminals=2;static propsSchema={Is:V.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:V.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:V.temp};static stateSchema={length:7,ops:[{index:4,name:"V",unit:"V"},{index:5,name:"I",unit:"A"}]};static linear=!1;na;nc;connect(t,[e,i]){this.na=e,this.nc=i}initDc(t,e){const i=this.props.getNumber("Is"),s=this.props.getNumber("N"),r=zt(this.props.getNumber("temp",e.temp)),[o,a,l]=vt(r,i,s);t[0]=a,t[2]=o,t[3]=l}eval(t,e){const{na:i,nc:s}=this,r=t[0],o=t[2],a=t[3];let l=i.voltage-s.voltage;e&&(l=mt(l,t[4],o,a));const u=dt(l,r,o),f=_t(l,r,o)+tt;t[4]=l,t[5]=u,t[6]=f}loadDc(t,e,i){const{na:s,nc:r}=this;this.eval(t,!0);const o=t[4],a=t[5],l=t[6];i.stampConductance(s,r,l),i.stampCurrentSource(s,r,a-l*o)}endDc(t,e){this.eval(t,!1)}}class Fn extends O.Dc{static id="JFET";static numTerminals=3;static propsSchema={polarity:V.string({range:[Ee,Ge],title:"transistor polarity"}),Vth:V.number({defaultValue:-2,range:["real"],title:"threshold voltage"}),beta:V.number({defaultValue:1e-4,range:["real",">",0],title:"transconductance parameter"}),lambda:V.number({defaultValue:0,range:["real",">=",0],title:"channel-length modulation parameter"}),Is:V.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:V.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:V.temp};static stateSchema={length:17,ops:[{index:7,name:"Vgs",unit:"V"},{index:10,name:"Vgd",unit:"V"},{index:13,name:"Vds",unit:"V"},{index:14,name:"Ids",unit:"A"}]};static linear=!1;ns;ng;nd;connect(t,[e,i,s]){this.ns=e,this.ng=i,this.nd=s}initDc(t,e){const i=this.props.getString("polarity"),s=this.props.getNumber("Vth"),r=this.props.getNumber("beta"),o=this.props.getNumber("lambda"),a=this.props.getNumber("Is"),l=this.props.getNumber("N"),u=zt(this.props.getNumber("temp",e.temp)),f=Rn(i),[h,d,p]=vt(u,a,l);t[0]=f,t[1]=s,t[2]=r,t[3]=o,t[4]=d,t[5]=h,t[6]=p}eval(t,e){const{ns:i,ng:s,nd:r}=this,o=t[0],a=t[1],l=t[2],u=t[3],f=t[4],h=t[5],d=t[6];let p=o*(s.voltage-i.voltage),_=o*(s.voltage-r.voltage);e&&(p=mt(p,o*t[7],h,d),_=mt(_,o*t[10],h,d));const y=p-_,k=dt(p,f,h),g=_t(p,f,h)+tt,v=dt(_,f,h),W=_t(_,f,h)+tt;let L,q,j;if(p>=_){const C=p-a;if(C<=0)L=0,q=tt,j=0;else{const E=u*y,z=l*(1+E);C<=y?(L=z*C*C,q=l*u*C*C,j=2*z*C):(L=z*y*(2*C-y),q=2*z*(C-y)+l*E*(2*C-y),j=2*z*y)}}else{const C=_-a;if(C<=0)L=0,q=tt,j=0;else{const E=-y,z=u*E,M=l*(1+z);C<=E?(L=-M*C*C,q=l*u*C*C+2*M*C,j=-2*M*C):(L=-M*E*(2*C-E),q=2*M*C+l*z*(2*C-E),j=-2*M*E)}}t[7]=o*p,t[10]=o*_,t[13]=o*y,t[8]=o*k,t[9]=g,t[11]=o*v,t[12]=W,t[14]=o*L,t[15]=q,t[16]=j}loadDc(t,e,i){const{ns:s,ng:r,nd:o}=this;this.eval(t,!0);const a=t[0],l=a*t[7],u=a*t[8],f=t[9],h=a*t[10],d=a*t[11],p=t[15],_=a*t[13],y=a*t[14],k=t[15],g=t[16];i.stampConductance(r,s,f),i.stampCurrentSource(r,s,a*(u-f*l)),i.stampConductance(r,o,p),i.stampCurrentSource(r,o,a*(d-p*h)),i.stampConductance(o,s,k),i.stampTransconductance(o,s,r,s,g),i.stampCurrentSource(o,s,a*(y-k*_-g*l))}endDc(t,e){this.eval(t,!1)}}class qn extends O.Dc{static id="MOSFET";static numTerminals=4;static propsSchema={polarity:V.string({range:[Ee,Ge],title:"transistor polarity"}),Vth:V.number({range:["real"],title:"threshold voltage"}),beta:V.number({defaultValue:.02,range:["real",">",0],title:"transconductance parameter"}),lambda:V.number({defaultValue:0,range:["real",">=",0],title:"channel-length modulation parameter"}),Is:V.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:V.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:V.temp};static stateSchema={length:19,ops:[{index:13,name:"Vgs",unit:"V"},{index:14,name:"Vgd",unit:"V"},{index:15,name:"Vds",unit:"V"},{index:16,name:"Ids",unit:"A"}]};static linear=!1;ns;ng;nd;nb;connect(t,[e,i,s,r]){this.ns=e,this.ng=i,this.nd=s,this.nb=r}initDc(t,e){const i=this.props.getString("polarity"),s=this.props.getNumber("Vth"),r=this.props.getNumber("beta"),o=this.props.getNumber("lambda"),a=this.props.getNumber("Is"),l=this.props.getNumber("N"),u=zt(this.props.getNumber("temp",e.temp)),f=Rn(i),[h,d,p]=vt(u,a,l);t[0]=f,t[1]=s,t[2]=r,t[3]=o,t[4]=d,t[5]=h,t[6]=p}eval(t,e){const{ns:i,ng:s,nd:r,nb:o}=this,a=t[0],l=t[1],u=t[2],f=t[3],h=t[4],d=t[5],p=t[6];let _=a*(o.voltage-i.voltage),y=a*(o.voltage-r.voltage),k=t[13]=a*(s.voltage-i.voltage),g=t[14]=a*(s.voltage-r.voltage),v=k-g;e&&(_=mt(_,a*t[7],d,p),y=mt(y,a*t[10],d,p),v>0?(k=Ft(k,a*t[13]),v=Ft(k-g,a*t[15])):(g=Ft(g,a*t[14]),v=Ft(k-g,a*t[15])));const W=dt(_,h,d),L=_t(_,h,d)+tt,q=dt(y,h,d),j=_t(y,h,d)+tt;let C,E,z;if(v>0){const M=k-a*l;if(M<=0)C=0,E=tt,z=0;else{const U=f*v,Y=u*(1+U);M<=v?(C=1/2*Y*M*M,E=1/2*u*f*M*M,z=Y*M):(C=Y*v*(M-v/2),E=Y*(M-v)+u*U*(M-v/2),z=Y*v)}}else{const M=g-a*l;if(M<=0)C=0,E=tt,z=0;else{const U=-v,Y=f*U,Ct=u*(1+Y);M<=U?(C=-.5*Ct*M*M,E=1/2*u*f*M*M,z=Ct*M):(C=-Ct*U*(M-U/2),E=Ct*M+u*Y*(M-U/2),z=Ct*U)}}t[7]=a*_,t[10]=a*y,t[13]=a*k,t[14]=a*g,t[15]=a*v,t[8]=a*W,t[9]=L,t[11]=a*q,t[12]=j,t[16]=a*C,t[17]=E,t[18]=z}loadDc(t,e,i){const{ns:s,ng:r,nd:o,nb:a}=this;this.eval(t,!0);const l=t[0],u=l*t[7],f=l*t[10],h=l*t[13],d=l*t[14],p=l*t[15],_=l*t[8],y=t[9],k=l*t[11],g=t[12],v=l*t[16],W=t[17],L=t[18];i.stampConductance(a,s,y),i.stampCurrentSource(a,s,l*(_-y*u)),i.stampConductance(a,o,g),i.stampCurrentSource(a,o,l*(k-g*f)),p>0?(i.stampConductance(o,s,W),i.stampTransconductance(o,s,r,s,L),i.stampCurrentSource(o,s,l*(v-W*p-L*h))):(i.stampConductance(o,s,W),i.stampTransconductance(o,s,r,o,L),i.stampCurrentSource(o,s,l*(v-W*p-L*d)))}endDc(t,e){this.eval(t,!1)}}class cs extends O.Dc{static id="OpAmp";static numTerminals=3;static propsSchema={gain:V.number({defaultValue:1e6,range:["real",">",0],title:"gain"}),Vmax:V.number({defaultValue:15,range:["real",">",0],title:"maximum absolute value of output voltage"})};static stateSchema={length:5,ops:[{index:2,name:"Vin",unit:"V"},{index:3,name:"Vout",unit:"V"}]};static linear=!1;np;nn;no;branch;connect(t,[e,i,s]){this.np=e,this.nn=i,this.no=s,this.branch=t.makeBranch(this.no,t.groundNode)}init(t){const e=this.props.getNumber("gain"),i=this.props.getNumber("Vmax");t[0]=e,t[1]=i}loadDc(t,e,i){const{np:s,nn:r,no:o,branch:a}=this,l=t[0],u=t[1],f=s.voltage-r.voltage,h=as*l*f/u,d=u*os*Math.atan(h),p=l/(1+h*h)+tt;t[2]=f,t[3]=d,t[4]=p,i.stampA(o,a,1),i.stampA(a,s,p),i.stampA(a,r,-p),i.stampA(a,o,-1),i.stampB(a,p*f-d)}}class us extends O.Dc{static id="Ammeter";static numTerminals=2;static propsSchema={};static stateSchema={length:1,ops:[{index:0,name:"I",unit:"A"}]};np;nn;branch;connect(t,[e,i]){this.np=e,this.nn=i,this.branch=t.makeBranch(this.np,this.nn)}loadDc(t,e,i){const{np:s,nn:r,branch:o}=this;i.stampVoltageSource(s,r,o,0)}endDc(t,e){const{branch:i}=this;t[0]=i.current}}class hs extends O.Dc{static id="Voltmeter";static numTerminals=2;static propsSchema={};static stateSchema={length:1,ops:[{index:0,name:"V",unit:"V"}]};np;nn;connect(t,[e,i]){this.np=e,this.nn=i}endDc(t,e){const{np:i,nn:s}=this;t[0]=i.voltage-s.voltage}}class Ol extends O.Dc{static id="CCCS";static numTerminals=4;static propsSchema={gain:V.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;ncp;ncn;branch;connect(t,[e,i,s,r]){this.np=e,this.nn=i,this.ncp=s,this.ncn=r,this.branch=t.makeBranch(this.ncp,this.ncn)}init(t){t[0]=this.props.getNumber("gain")}loadDc(t,e,i){const{np:s,nn:r,ncp:o,ncn:a,branch:l}=this,u=t[0];i.stampVoltageSource(o,a,l,0),i.stampA(s,l,u),i.stampA(r,l,-u)}endDc(t,e){const{np:i,nn:s,branch:r}=this,o=t[0],a=r.current*o,l=i.voltage-s.voltage;t[1]=a,t[2]=l}}class Wl extends O.Dc{static id="CCVS";static numTerminals=4;static propsSchema={gain:V.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;ncp;ncn;branch1;branch2;connect(t,[e,i,s,r]){this.np=e,this.nn=i,this.ncp=s,this.ncn=r,this.branch1=t.makeBranch(this.np,this.nn),this.branch2=t.makeBranch(this.ncp,this.ncn)}init(t){t[0]=this.props.getNumber("gain")}loadDc(t,e,i){const{np:s,nn:r,branch1:o,ncp:a,ncn:l,branch2:u}=this,f=t[0];i.stampVoltageSource(s,r,o,0),i.stampVoltageSource(a,l,u,0),i.stampA(o,u,-f)}endDc(t,e){const{np:i,nn:s,branch1:r}=this,o=i.voltage-s.voltage,a=r.current;t[1]=o,t[2]=a}}class zl extends O{static id="Iac";static numTerminals=2;static propsSchema={I:V.number({title:"amplitude"}),f:V.number({title:"frequency"}),phase:V.number({title:"phase",defaultValue:0})};static stateSchema={length:5,ops:[{index:3,name:"I",unit:"A"},{index:4,name:"V",unit:"V"}]};np;nn;connect(t,[e,i]){this.np=e,this.nn=i}init(t){const e=this.props.getNumber("I"),i=this.props.getNumber("f"),s=this.props.getNumber("phase"),r=2*Math.PI*i,o=s/180*Math.PI;t[0]=e,t[1]=r,t[2]=o}endDc(t,e){t[3]=0,t[4]=0}loadTr(t,{time:e,sourceFactor:i},s){const{np:r,nn:o}=this,a=t[0],l=t[1],u=t[2],f=i*a*Math.sin(l*e+u);t[3]=f,s.stampCurrentSource(r,o,f)}endTr(t,e){const{np:i,nn:s}=this;t[4]=i.voltage-s.voltage}loadAc(t,e,i){const{np:s,nn:r}=this,o=t[0],a=t[2],l=o*Math.cos(a),u=o*Math.sin(a);i.stampCurrentSource(s,r,l,u)}}class fs extends O.Dc{static id="I";static numTerminals=2;static propsSchema={I:V.number({title:"current"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;connect(t,[e,i]){this.np=e,this.nn=i}init(t){t[0]=this.props.getNumber("I")}loadDc(t,{sourceFactor:e},i){const{np:s,nn:r}=this,o=t[0],a=e*o;t[1]=a,i.stampCurrentSource(s,r,a)}endDc(t,e){const{np:i,nn:s}=this;t[2]=i.voltage-s.voltage}}class Ul extends O{static id="Vac";static numTerminals=2;static propsSchema={V:V.number({title:"amplitude"}),f:V.number({title:"frequency"}),phase:V.number({title:"phase",defaultValue:0})};static stateSchema={length:5,ops:[{index:3,name:"V",unit:"V"},{index:4,name:"I",unit:"A"}]};np;nn;branch;connect(t,[e,i]){this.np=e,this.nn=i,this.branch=t.makeBranch(this.np,this.nn)}init(t){const e=this.props.getNumber("V"),i=this.props.getNumber("f"),s=this.props.getNumber("phase"),r=2*Math.PI*i,o=s/180*Math.PI;t[0]=e,t[1]=r,t[2]=o}loadDc(t,e,i){const{np:s,nn:r,branch:o}=this;i.stampVoltageSource(s,r,o,0)}endDc(t,e){t[3]=0,t[4]=0}loadTr(t,{time:e,sourceFactor:i},s){const{np:r,nn:o,branch:a}=this,l=t[0],u=t[1],f=t[2],h=i*l*Math.sin(u*e+f);t[3]=h,s.stampVoltageSource(r,o,a,h)}endTr(t,e){const{branch:i}=this,s=i.current;t[4]=s}loadAc(t,e,i){const{np:s,nn:r,branch:o}=this,a=t[0],l=t[2],u=a*Math.cos(l),f=a*Math.sin(l);i.stampVoltageSource(s,r,o,u,f)}}class Rl extends O.Dc{static id="VCCS";static numTerminals=4;static propsSchema={gain:V.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;ncp;ncn;branch;connect(t,[e,i,s,r]){this.np=e,this.nn=i,this.ncp=s,this.ncn=r,this.branch=t.makeBranch(this.np,this.nn)}init(t){t[0]=this.props.getNumber("gain")}loadDc(t,e,i){const{np:s,nn:r,ncp:o,ncn:a,branch:l}=this,u=t[0];i.stampA(s,l,1),i.stampA(r,l,-1),i.stampA(l,o,u),i.stampA(l,a,-u),i.stampA(l,l,-1)}endDc(t,e){const{np:i,nn:s,branch:r}=this;t[1]=r.current,t[2]=i.voltage-s.voltage}}class Bl extends O.Dc{static id="VCVS";static numTerminals=4;static propsSchema={gain:V.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;ncp;ncn;branch;connect(t,[e,i,s,r]){this.np=e,this.nn=i,this.ncp=s,this.ncn=r,this.branch=t.makeBranch(this.np,this.nn)}init(t){t[0]=this.props.getNumber("gain")}loadDc(t,e,i){const{np:s,nn:r,ncp:o,ncn:a,branch:l}=this,u=t[0];i.stampVoltageSource(s,r,l,0),i.stampA(l,o,-u),i.stampA(l,a,u)}endDc(t,e){const{np:i,nn:s,branch:r}=this;t[1]=i.voltage-s.voltage,t[2]=r.current}}class ps extends O.Dc{static id="V";static numTerminals=2;static propsSchema={V:V.number({title:"voltage"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;branch;connect(t,[e,i]){this.np=e,this.nn=i,this.branch=t.makeBranch(this.np,this.nn)}init(t){t[0]=this.props.getNumber("V")}loadDc(t,{sourceFactor:e},i){const{np:s,nn:r,branch:o}=this,a=t[0],l=e*a;t[1]=l,i.stampVoltageSource(s,r,o,l)}endDc(t,e){const{branch:i}=this;t[2]=i.current}}const ds={id:"r",name:"Resistor",category:"Linear",prefix:"R",shapes:[["l",0,-30,0,-20],["l",-8,-20,8,-20],["l",-8,20,8,20],["l",-8,-20,-8,20],["l",8,-20,8,20],["l",0,30,0,20]],pins:[["a",0,-30],["b",0,30]],labels:[15,0,"lm"],device:ts},_s={id:"c",name:"Capacitor",category:"Linear",prefix:"C",shapes:[["l",0,-30,0,-6],["l",-20,-6,20,-6],["l",-20,6,20,6],["l",0,30,0,6]],pins:[["a",0,-30],["b",0,30]],labels:[30,0,"lm"],device:Ji},ms={id:"l",name:"Inductor",category:"Linear",prefix:"L",shapes:[["l",0,-30,0,-22],["a",0,-14,7,-90,90],["a",0,0,7,-90,90],["a",0,14,7,-90,90],["l",0,30,0,22]],pins:[["a",0,-30],["b",0,30]],labels:[15,0,"lm"],device:Qi},Kt={resistor:ds,capacitor:_s,inductor:ms},pe=(n,t,e,i,s=10)=>{const r=Math.atan2(i-t,e-n),o=r-Math.PI/6,a=r+Math.PI/6;return[["l",n,t,e,i],["l",e,i,e-s*Math.cos(o),i-s*Math.sin(o)],["l",e,i,e-s*Math.cos(a),i-s*Math.sin(a)]]},vs={id:"d",name:"Diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-15,-11,15,-11],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:fe},ys={id:"dz",name:"Zener diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-20,-5,-15,-11],["l",-15,-11,15,-11],["l",15,-11,20,-17],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:fe},gs={id:"ds",name:"Schottky diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-9,-17,-15,-17],["l",-15,-17,-15,-11],["l",-15,-11,15,-11],["l",15,-11,15,-5],["l",15,-5,9,-5],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:fe},bs={id:"dv",name:"Varicap diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-17],["l",-15,-17,15,-17],["l",-15,-11,15,-11],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:fe},Vs={id:"npn",name:"NPN bipolar junction transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-20],["l",0,30,0,20],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",-20,-5,0,-20],...pe(-20,5,0,20)],pins:[["c",0,-30],["e",0,30],["b",-30,0]],labels:[10,0,"lm"],device:Bn},ws={id:"pnp",name:"PNP bipolar junction transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-20],["l",0,30,0,20],["l",-30,0,-20,0],["l",-20,-15,-20,15],...pe(0,-20,-20,-5),["l",0,20,-20,5]],pins:[["e",0,-30],["c",0,30],["b",-30,0]],labels:[10,0,"lm"],device:Bn},xs={id:"nfet",name:"N-channel junction field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,10],["l",-30,0,-12,0],["l",0,-10,-12,-10],["l",0,10,-12,10],["l",-12,-15,-12,15],["l",-21,-5,-15,0],["l",-21,5,-15,0]],pins:[["d",0,-30],["s",0,30],["g",-30,0]],labels:[10,0,"lm"],device:Fn},ks={id:"pfet",name:"P-channel junction field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,10],["l",-30,0,-12,0],["l",0,-10,-12,-10],["l",0,10,-12,10],["l",-12,-15,-12,15],["l",-21,0,-15,-5],["l",-21,0,-15,5]],pins:[["s",0,-30],["d",0,30],["g",-30,0]],labels:[10,0,"lm"],device:Fn},Hs={id:"nmos",name:"N-channel MOS field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,0],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",0,-10,-15,-10],["l",-15,-15,-15,-6],["l",0,0,-15,0],["l",-15,-3,-15,3],["l",-13,0,-8,-4],["l",-13,0,-8,4],["l",0,10,-15,10],["l",-15,15,-15,6]],pins:[["d",0,-30],["s",0,30],["g",-30,0]],labels:[10,0,"lm"],device:qn},Cs={id:"pmos",name:"P-channel MOS field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,0],["l",0,30,0,10],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",0,-10,-15,-10],["l",-15,-15,-15,-6],["l",0,0,-15,0],["l",-15,-3,-15,3],["l",-6,-4,-1,0],["l",-6,4,-1,0],["l",0,10,-15,10],["l",-15,15,-15,6]],pins:[["s",0,-30],["d",0,30],["g",-30,0]],labels:[10,0,"lm"],device:qn},Ms={id:"opamp",name:"Operational amplifier",category:"Nonlinear",prefix:"OA",shapes:[["l",-50,-30,-30,-30],["l",-50,30,-30,30],["l",30,0,50,0],["l",-30,-50,30,0],["l",-30,50,30,0],["l",-30,-50,-30,50],["l",-25,-30,-15,-30],["l",-20,-35,-20,-25],["l",-25,30,-15,30]],pins:[["noninv",-50,-30],["inv",-50,30],["out",50,0]],labels:[-30,55,"lt"],device:cs},X={diode:vs,zener:ys,schottky:gs,varicap:bs,npn:Vs,pnp:ws,nfet:xs,pfet:ks,nmos:Hs,pmos:Cs,opamp:Ms},Ss={id:"vmeter",name:"Voltmeter",category:"Probes",prefix:"Pr",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,30,0,20],["t",0,0,"cm","V"],...pe(-25,25,25,-25)],pins:[["a",0,-30],["b",0,30]],labels:[25,0,"lm"],device:hs},As={id:"ameter",name:"Ammeter",category:"Probes",prefix:"Pr",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,30,0,20],["t",0,0,"cm","A"],...pe(-25,25,25,-25)],pins:[["a",0,-30],["b",0,30]],labels:[25,0,"lm"],device:us},$s={vmeter:Ss,ameter:As},Ls={id:"vdc",name:"Ideal DC voltage source",category:"Sources",prefix:"V",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,-15,0,-5],["l",-5,-10,5,-10],["l",-5,10,5,10],["l",0,30,0,20]],pins:[["pos",0,-30],["neg",0,30]],labels:[25,0,"lm"],device:ps},Is={id:"idc",name:"Ideal DC current source",category:"Sources",prefix:"I",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,10,0,-10],["l",0,-11,-5,-3],["l",0,-11,5,-3],["l",0,30,0,20]],pins:[["pos",0,-30],["neg",0,30]],labels:[25,0,"lm"],device:fs},Dt={vdc:Ls,idc:Is};class Ps{#t=new Map;constructor(t){for(const e of t)this.#t.set(e.id,e)}[Symbol.iterator](){return this.#t.values()}get(t){const e=this.#t.get(t);if(e==null)throw new Error(`Unknown symbol [${t}]`);return e}}const jn=new Ps([...Object.values(rt),...Object.values(Kt),...Object.values(X),...Object.values(Dt),...Object.values($s)]);var Ns=Symbol.for("preact-signals");function de(){if(ut>1)ut--;else{for(var n,t=!1;At!==void 0;){var e=At;for(At=void 0,Ce++;e!==void 0;){var i=e.o;if(e.o=void 0,e.f&=-3,!(8&e.f)&&Yn(e))try{e.c()}catch(s){t||(n=s,t=!0)}e=i}}if(Ce=0,ut--,t)throw n}}function Ts(n){if(ut>0)return n();ut++;try{return n()}finally{de()}}var $=void 0,At=void 0,ut=0,Ce=0,ne=0;function Zn(n){if($!==void 0){var t=n.n;if(t===void 0||t.t!==$)return t={i:0,S:n,p:$.s,n:void 0,t:$,e:void 0,x:void 0,r:t},$.s!==void 0&&($.s.n=t),$.s=t,n.n=t,32&$.f&&n.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=$.s,t.n=void 0,$.s.n=t,$.s=t),t}}function F(n){this.v=n,this.i=0,this.n=void 0,this.t=void 0}F.prototype.brand=Ns;F.prototype.h=function(){return!0};F.prototype.S=function(n){this.t!==n&&n.e===void 0&&(n.x=this.t,this.t!==void 0&&(this.t.e=n),this.t=n)};F.prototype.U=function(n){if(this.t!==void 0){var t=n.e,e=n.x;t!==void 0&&(t.x=e,n.e=void 0),e!==void 0&&(e.e=t,n.x=void 0),n===this.t&&(this.t=e)}};F.prototype.subscribe=function(n){var t=this;return Rt(function(){var e=t.value,i=$;$=void 0;try{n(e)}finally{$=i}})};F.prototype.valueOf=function(){return this.value};F.prototype.toString=function(){return this.value+""};F.prototype.toJSON=function(){return this.value};F.prototype.peek=function(){var n=$;$=void 0;try{return this.value}finally{$=n}};Object.defineProperty(F.prototype,"value",{get:function(){var n=Zn(this);return n!==void 0&&(n.i=this.i),this.v},set:function(n){if(n!==this.v){if(Ce>100)throw new Error("Cycle detected");this.v=n,this.i++,ne++,ut++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{de()}}}});function et(n){return new F(n)}function Yn(n){for(var t=n.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Xn(n){for(var t=n.s;t!==void 0;t=t.n){var e=t.S.n;if(e!==void 0&&(t.r=e),t.S.n=t,t.i=-1,t.n===void 0){n.s=t;break}}}function Kn(n){for(var t=n.s,e=void 0;t!==void 0;){var i=t.p;t.i===-1?(t.S.U(t),i!==void 0&&(i.n=t.n),t.n!==void 0&&(t.n.p=i)):e=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=i}n.s=e}function xt(n){F.call(this,void 0),this.x=n,this.s=void 0,this.g=ne-1,this.f=4}(xt.prototype=new F).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===ne))return!0;if(this.g=ne,this.f|=1,this.i>0&&!Yn(this))return this.f&=-2,!0;var n=$;try{Xn(this),$=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return $=n,Kn(this),this.f&=-2,!0};xt.prototype.S=function(n){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}F.prototype.S.call(this,n)};xt.prototype.U=function(n){if(this.t!==void 0&&(F.prototype.U.call(this,n),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};xt.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var n=this.t;n!==void 0;n=n.x)n.t.N()}};Object.defineProperty(xt.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var n=Zn(this);if(this.h(),n!==void 0&&(n.i=this.i),16&this.f)throw this.v;return this.v}});function nn(n){return new xt(n)}function Jn(n){var t=n.u;if(n.u=void 0,typeof t=="function"){ut++;var e=$;$=void 0;try{t()}catch(i){throw n.f&=-2,n.f|=8,Oe(n),i}finally{$=e,de()}}}function Oe(n){for(var t=n.s;t!==void 0;t=t.n)t.S.U(t);n.x=void 0,n.s=void 0,Jn(n)}function Ds(n){if($!==this)throw new Error("Out-of-order effect");Kn(this),$=n,this.f&=-2,8&this.f&&Oe(this),de()}function Ut(n){this.x=n,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Ut.prototype.c=function(){var n=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{n()}};Ut.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,Jn(this),Xn(this),ut++;var n=$;return $=this,Ds.bind(this,n)};Ut.prototype.N=function(){2&this.f||(this.f|=2,this.o=At,At=this)};Ut.prototype.d=function(){this.f|=8,1&this.f||Oe(this)};function Rt(n){var t=new Ut(n);try{t.c()}catch(e){throw t.d(),e}return t.d.bind(t)}var Qn,me,ti=[];Rt(function(){Qn=this.N})();function kt(n,t){x[n]=t.bind(null,x[n]||function(){})}function ie(n){me&&me(),me=n&&n.S()}function ei(n){var t=this,e=n.data,i=Gs(e);i.value=e;var s=he(function(){for(var a=t,l=t.__v;l=l.__;)if(l.__c){l.__c.__$f|=4;break}var u=nn(function(){var p=i.value.value;return p===0?0:p===!0?"":p||""}),f=nn(function(){return!xn(u.value)}),h=Rt(function(){if(this.N=ni,f.value){var p=u.value;a.base&&a.base.nodeType===3&&(a.base.data=p)}}),d=t.__$u.d;return t.__$u.d=function(){h(),d.call(this)},[f,u]},[]),r=s[0],o=s[1];return r.value?o.peek():o.value}ei.displayName="_st";Object.defineProperties(F.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:ei},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});kt("__b",function(n,t){if(typeof t.type=="string"){var e,i=t.props;for(var s in i)if(s!=="children"){var r=i[s];r instanceof F&&(e||(t.__np=e={}),e[s]=r,i[s]=r.peek())}}n(t)});kt("__r",function(n,t){ie();var e,i=t.__c;i&&(i.__$f&=-2,(e=i.__$u)===void 0&&(i.__$u=e=function(s){var r;return Rt(function(){r=this}),r.c=function(){i.__$f|=1,i.setState({})},r}())),ie(e),n(t)});kt("__e",function(n,t,e,i){ie(),n(t,e,i)});kt("diffed",function(n,t){ie();var e;if(typeof t.type=="string"&&(e=t.__e)){var i=t.__np,s=t.props;if(i){var r=e.U;if(r)for(var o in r){var a=r[o];a!==void 0&&!(o in i)&&(a.d(),r[o]=void 0)}else r={},e.U=r;for(var l in i){var u=r[l],f=i[l];u===void 0?(u=Es(e,l,f,s),r[l]=u):u.o(f,s)}}}n(t)});function Es(n,t,e,i){var s=t in n&&n.ownerSVGElement===void 0,r=et(e);return{o:function(o,a){r.value=o,i=a},d:Rt(function(){this.N=ni;var o=r.value.value;i[t]!==o&&(i[t]=o,s?n[t]=o:o?n.setAttribute(t,o):n.removeAttribute(t))})}}kt("unmount",function(n,t){if(typeof t.type=="string"){var e=t.__e;if(e){var i=e.U;if(i){e.U=void 0;for(var s in i){var r=i[s];r&&r.d()}}}}else{var o=t.__c;if(o){var a=o.__$u;a&&(o.__$u=void 0,a.d())}}n(t)});kt("__h",function(n,t,e,i){(i<3||i===9)&&(t.__$f|=2),n(t,e,i)});nt.prototype.shouldComponentUpdate=function(n,t){var e=this.__$u,i=e&&e.s!==void 0;for(var s in t)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var r=2&this.__$f;if(!(i||r||4&this.__$f)||1&this.__$f)return!0}else if(!(i||4&this.__$f)||3&this.__$f)return!0;for(var o in n)if(o!=="__source"&&n[o]!==this.props[o])return!0;for(var a in this.props)if(!(a in n))return!0;return!1};function Gs(n){return he(function(){return et(n)},[])}var Os=function(n){queueMicrotask(function(){queueMicrotask(n)})};function Ws(){Ts(function(){for(var n;n=ti.shift();)Qn.call(n)})}function ni(){ti.push(this)===1&&(x.requestAnimationFrame||Os)(Ws)}const{round:m}=Math,zs=(n,t)=>n.x0<=t.x0&&t.x0<=n.x1&&n.y0<=t.y0&&t.y0<=n.y1||n.x0<=t.x0&&t.x0<=n.x1&&n.y0<=t.y1&&t.y1<=n.y1||n.x0<=t.x1&&t.x1<=n.x1&&n.y0<=t.y0&&t.y0<=n.y1||n.x0<=t.x1&&t.x1<=n.x1&&n.y0<=t.y1&&t.y1<=n.y1,Us=(n,t)=>n.x0<=t.x0&&t.x0<=n.x1&&n.x0<=t.x1&&t.x1<=n.x1&&n.y0<=t.y0&&t.y0<=n.y1&&n.y0<=t.y1&&t.y1<=n.y1,Rs=["input","textarea","select","INPUT","TEXTAREA","SELECT"];function ii(n){return n instanceof Element&&Rs.includes(n.tagName)}function Bs(){const{activeElement:n}=document;ii(n)&&n.blur()}const A={None:0,Shift:1,Alt:2,Control:4,Meta:8,of:n=>{let t=A.None;return n.shiftKey&&(t|=A.Shift),n.altKey&&(t|=A.Alt),n.ctrlKey&&(t|=A.Control),n.metaKey&&(t|=A.Meta),t}};function si(...n){const t=n.map(Fs);return e=>{if(ii(e.target))return!0;const i=A.of(e);for(const s of t)if((s.key==="any"||s.key===e.key||s.key===e.code)&&s.mod===i&&s.handler(e,i)!==!1)return e.preventDefault(),!0;return!1}}function Fs([n,t]){let e="",i=A.None;const s=n.split("+");for(;s.length>0;){const r=s.shift();switch(r){case"Shift":i|=A.Shift;break;case"Alt":i|=A.Alt;break;case"Ctrl":i|=A.Control;break;case"Meta":i|=A.Meta;break;default:e=r;break}}return{key:e,mod:i,handler:t}}const N=4,T=2,D=1,qs=[N|T|D,N|D,N|T,N,0,T,D,T|D],js=[N,N|T,N|D,N|T|D,T|D,D,T,0],Zs=[T,T|D,0,D,N|T,N|D|T,N,N|D],Ys=[D,0,T|D,T,N|D,N,N|T|D,N|T],Xs=(n,t)=>{switch(t){case"rl":return qs[n]??0;case"rr":return js[n]??0;case"mx":return Zs[n]??0;case"my":return Ys[n]??0}return 0},Ks=(n,t)=>{let[e,i,s]=n,r=0;return t&N&&(r=i,i=-s,s=r),t&T&&(i=-i),t&D&&(s=-s),[e,i,s]},ot=n=>n.charAt(0),at=n=>n.charAt(1),Js=(n,t)=>{let e=ot(n),i=at(n);switch(t){case"mx":switch(e){case"l":e="r";break;case"r":e="l";break}break;case"my":switch(i){case"t":i="b";break;case"b":i="t";break}break}return`${e}${i}`},ri=(n,t)=>{if(t&N)switch(n){case"lt":n="rt";break;case"lm":n="ct";break;case"lb":n="lt";break;case"ct":n="rm";break;case"cb":n="lm";break;case"rt":n="rb";break;case"rm":n="cb";break;case"rb":n="lb";break}let e=ot(n),i=at(n);if(t&T)switch(e){case"l":e="r";break;case"r":e="l";break}if(t&D)switch(i){case"t":i="b";break;case"b":i="t";break}return`${e}${i}`},Qs=(n,t)=>{switch(n[0]){case"l":return tr(n,t);case"c":return er(n,t);case"a":return nr(n,t);case"t":return ir(n,t)}return n},tr=(n,t)=>{let[e,i,s,r,o]=n,a=0;return t&N&&(a=i,i=-s,s=a,a=r,r=-o,o=a),t&T&&(i=-i,r=-r),t&D&&(s=-s,o=-o),[e,i,s,r,o]},er=(n,t)=>{let[e,i,s,r]=n,o=0;return t&N&&(o=i,i=-s,s=o),t&T&&(i=-i),t&D&&(s=-s),[e,i,s,r]},nr=(n,t)=>{let[e,i,s,r,o,a]=n,l=0;return t&N&&(l=i,i=-s,s=l,o+=90,a+=90),t&T&&(i=-i,l=o,o=180-a,a=180-l),t&D&&(s=-s,l=o,o=-a,a=-l),[e,i,s,r,o,a]},ir=(n,t)=>{let[e,i,s,r,o]=n;r=ri(r,t);let a=0;return t&N&&(a=i,i=-s,s=a),t&T&&(i=-i),t&D&&(s=-s),[e,i,s,r,o]},sr=(n,t)=>{let[e,i,s]=n;s=ri(s,t);let r=0;return t&N&&(r=e,e=-i,i=r),t&T&&(e=-e),t&D&&(i=-i),[e,i,s]},oi=({shapes:n,pins:t},e,i)=>{const s={x:0,y:0},r={x:0,y:0};for(const o of n)switch(o[0]){case"l":{const[a,l,u,f,h]=o;s.x=Math.min(s.x,l,f),s.y=Math.min(s.y,u,h),r.x=Math.max(r.x,l,f),r.y=Math.max(r.y,u,h);break}case"c":{const[a,l,u,f]=o;s.x=Math.min(s.x,l-f,l+f),s.y=Math.min(s.y,u-f,u+f),r.x=Math.max(r.x,l-f,l+f),r.y=Math.max(r.y,u-f,u+f);break}case"a":{const[a,l,u,f,h,d]=o;s.x=Math.min(s.x,l-f,l+f),s.y=Math.min(s.y,u-f,l+f),r.x=Math.max(r.x,l-f,u+f),r.y=Math.max(r.y,u-f,u+f);break}}for(const[o,a,l]of t)s.x=Math.min(s.x,a),s.y=Math.min(s.y,l),r.x=Math.max(r.x,a),r.y=Math.max(r.y,l);return{x0:e+s.x,y0:i+s.y,x1:e+r.x,y1:i+r.y}};let rr=0;function or(){return rr+=1}class ar{#t=or();get id(){return this.#t}}let We=class extends ar{includes(t,e){const{x0:i,y0:s,x1:r,y1:o}=this.area;return i<=t&&t<=r&&s<=e&&e<=o}};class ai{static anonymous(t){return`${t}?`}#t=new Map;constructor(t){for(const e of t)if(e instanceof lt){const i=this.#n(e.symbol.prefix);i.instances.push(e),i.names.add(e.name)}}getUniqueName(t){const e=this.#n(t);let i=1;for(;;){const s=`${t}${i}`;if(!e.names.has(s))return e.names.add(s),s;i+=1}}rename(t="none"){for(const[e,i]of this.#t.entries()){switch(t){case"none":break;case"horizontal":i.instances.sort((s,r)=>s.x-r.x||s.y-r.y);break;case"vertical":i.instances.sort((s,r)=>s.y-r.y||s.x-r.x);break}i.names.clear();for(const s of i.instances)s.name=this.getUniqueName(e)}}#n(t){let e=this.#t.get(t);return e==null&&this.#t.set(t,e={instances:[],names:new Set}),e}}function li(){const n=()=>{throw new Error("unusable")};return new Proxy(Object.create(null),{apply:n,construct:n,defineProperty:n,deleteProperty:n,get:n,getOwnPropertyDescriptor:n,getPrototypeOf:n,has:n,isExtensible:n,ownKeys:n,preventExtensions:n,set:n,setPrototypeOf:n})}class Et{static create({device:t}){const e=new Et;return e.#t=new V(t?.propsSchema??{}),e}#t=sn;constructor(){}setValue(t,e){return this.#t.set(t,e),this.#n()}import(t){return this.#n()}export(){return{}}#n(){const t=new Et;return t.#t=this.#t,this.#t=sn,t}}const sn=li();class lt extends We{#t;#n;#o;#e;#a;#i;#r=null;#s=null;#f=null;#l=null;constructor(t,e=ai.anonymous(t.prefix),i=Et.create(t),s=0,r=0,o=0){super(),this.#t=t,this.#n=e,this.#o=i,this.#e=s,this.#a=r,this.#i=o}get symbol(){return this.#t}get name(){return this.#n}set name(t){this.#n=t}get props(){return this.#o}set props(t){this.#o=t}get x(){return this.#e}get y(){return this.#a}get transform(){return this.#i}moveTo(t,e){this.#e=t,this.#a=e,this.#l=null}transformBy(t,e,i){const s=this.#e,r=this.#a;switch(t){case"rl":this.#e=e+(r-i),this.#a=i-(s-e);break;case"rr":this.#e=e-(r-i),this.#a=i+(s-e);break;case"mx":this.#e=2*e-s;break;case"my":this.#a=2*i-r;break}this.#i=Xs(this.#i,t),this.#r=null,this.#s=null,this.#f=null,this.#l=null}get area(){return this.#l??=oi(this,this.#e,this.#a)}get shapes(){return this.#r??=this.#t.shapes.map(t=>Qs(t,this.#i))}get pins(){return this.#s??=this.#t.pins.map(t=>Ks(t,this.#i))}get labels(){return this.#f??=sr(this.#t.labels,this.#i)}}const lr=(n,t)=>{switch(t){case"rl":switch(n){case"h":return"v";case"v":return"h"}break;case"rr":switch(n){case"h":return"v";case"v":return"h"}break}return n};class Ht extends We{#t;#n;#o;#e;#a;#i;#r;#s=null;constructor(t,e="lt",i="h",s=0,r=0){super(),this.#t=t.trim(),this.#n=e,this.#o=i,this.#e=s,this.#a=r,this.#i=0,this.#r=0,this.#s=null}get text(){return this.#t}set text(t){this.#t=t.trim(),this.#i=0,this.#r=0,this.#s=null}get align(){return this.#n}set align(t){this.#n=t,this.#s=null}get dir(){return this.#o}set dir(t){this.#o=t,this.#s=null}get x(){return this.#e}get y(){return this.#a}get width(){return this.#i}set width(t){this.#i=t,this.#s=null}get height(){return this.#r}set height(t){this.#r=t,this.#s=null}moveTo(t,e){this.#e=t,this.#a=e,this.#s=null}transformBy(t,e,i){const s=this.#e,r=this.#a;switch(t){case"rl":this.#e=e+(r-i),this.#a=i-(s-e);break;case"rr":this.#e=e-(r-i),this.#a=i+(s-e);break;case"mx":this.#e=2*e-s;break;case"my":this.#a=2*i-r;break}this.#n=Js(this.#n,t),this.#o=lr(this.#o,t),this.#s=null}get area(){return this.#s??=this.#f()}#f(){let t=0,e=0,i=0,s=0;switch(this.#o){case"h":switch(ot(this.#n)){case"l":t=this.#e,i=this.#e+this.#i;break;case"c":t=this.#e-this.#i/2,i=this.#e+this.#i/2;break;case"r":t=this.#e-this.#i,i=this.#e;break}switch(at(this.#n)){case"t":e=this.#a,s=this.#a+this.#r;break;case"m":e=this.#a-this.#r/2,s=this.#a+this.#r/2;break;case"b":e=this.#a-this.#r,s=this.#a;break}break;case"v":switch(ot(this.#n)){case"l":e=this.#a-this.#i,s=this.#a;break;case"c":e=this.#a-this.#i/2,s=this.#a+this.#i/2;break;case"r":e=this.#a,s=this.#a+this.#i;break}switch(at(this.#n)){case"t":t=this.#e,i=this.#e+this.#r;break;case"m":t=this.#e-this.#r/2,i=this.#e+this.#r/2;break;case"b":t=this.#e-this.#r,i=this.#e;break}break}return{x0:t,y0:e,x1:i,y1:s}}}class R extends We{#t;#n;#o;#e;#a;constructor(t,e,i,s){super(),this.#t=t,this.#n=e,this.#o=i,this.#e=s,this.#a=null}get x0(){return this.#t}set x0(t){this.#t=t,this.#a=null}get y0(){return this.#n}set y0(t){this.#n=t,this.#a=null}get x1(){return this.#o}set x1(t){this.#o=t,this.#a=null}get y1(){return this.#e}set y1(t){this.#e=t,this.#a=null}get x(){return this.#t}get y(){return this.#n}moveTo(t,e){const i=this.#t,s=this.#n,r=this.#o,o=this.#e;this.#t=t,this.#n=e,this.#o=t+(r-i),this.#e=e+(o-s),this.#a=null}transformBy(t,e,i){const s=this.#t,r=this.#n,o=this.#o,a=this.#e;switch(t){case"rl":this.#t=e+(r-i),this.#n=i-(s-e),this.#o=e+(a-i),this.#e=i-(o-e);break;case"rr":this.#t=e-(r-i),this.#n=i+(s-e),this.#o=e-(a-i),this.#e=i+(o-e);break;case"mx":this.#t=2*e-s,this.#o=2*e-o;break;case"my":this.#n=2*i-r,this.#e=2*i-a;break}this.#a=null}get area(){return this.#a??={x0:Math.min(this.#t,this.#o),y0:Math.min(this.#n,this.#e),x1:Math.max(this.#t,this.#o),y1:Math.max(this.#n,this.#e)}}includes(t,e){if(this.#n===this.#e){const h=this.#n,d=Math.min(this.#t,this.#o),p=Math.max(this.#t,this.#o);return d<=t&&t<=p&&h-3<=e&&e<=h+3}if(this.#t===this.#o){const h=this.#t,d=Math.min(this.#n,this.#e),p=Math.max(this.#n,this.#e);return d<=e&&e<=p&&h-3<=t&&t<=h+3}const s=Math.abs((this.#e-this.#n)*t-(this.#o-this.#t)*e+this.#o*this.#n-this.#e*this.#t),r=Math.sqrt((this.#e-this.#n)*(this.#e-this.#n)+(this.#o-this.#t)*(this.#o-this.#t)),o=s/r,a=Math.min(this.#t,this.#o),l=Math.min(this.#n,this.#e),u=Math.max(this.#t,this.#o),f=Math.max(this.#n,this.#e);return a<=t&&t<=u&&l<=e&&e<=f&&o<=3}}function ve(n){return n===A.None?"l":n===A.Shift?"r":n===A.Alt?"d":"l"}function cr(n,t,e,i,s){return n===e&&t===i?[]:s==="d"?[new R(n,t,e,i)]:t===i?[new R(n,t,e,i)]:n===e?[new R(n,t,e,i)]:s==="l"?[new R(n,t,e,t),new R(e,t,e,i)]:[new R(n,t,n,i),new R(n,i,e,i)]}function ur(n){const t=new hr,e=new fr;for(const s of n)if(s instanceof R){const{x0:r,y0:o,x1:a,y1:l}=s;if(o===l){t.addWire(o,s);continue}if(r===a){e.addWire(r,s);continue}continue}for(const s of n){if(s instanceof lt){for(const[r,o,a]of s.pins){const l=s.x+o,u=s.y+a;t.split(u,l,n),e.split(l,u,n)}continue}if(s instanceof R){const{x0:r,y0:o,x1:a,y1:l}=s;if(r===a&&o===l)continue;if(o===l){e.split(r,o,n),e.split(a,o,n);continue}if(r===a){t.split(o,r,n),t.split(l,r,n);continue}e.split(r,o,n),e.split(a,l,n),t.split(o,r,n),t.split(l,a,n);continue}}t.merge(),e.merge();let i=0;for(;i<n.length;){const s=n[i];if(s instanceof R){const{x0:r,y0:o,x1:a,y1:l}=s;if(r===a&&o===l){n.splice(i,1);continue}}i+=1}}class hr{lines=new Map;addWire(t,e){const{x0:i,x1:s}=e;e.x0=Math.min(i,s),e.x1=Math.max(i,s),e.y0=t,e.y1=t;let r=this.lines.get(t);r==null&&this.lines.set(t,r={wires:[],breakpoints:[]}),r.wires.push(e)}split(t,e,i){let s=this.lines.get(t);if(s!=null){s.breakpoints.push(e);for(const r of s.wires)if(r.x0<e&&e<r.x1){const o=new R(e,t,r.x1,t);i.push(o),s.wires.push(o),r.x1=e}}}merge(){for(const{wires:t,breakpoints:e}of this.lines.values()){t.sort((s,r)=>s.x0-r.x0);let i=1;for(;i<t.length;){const s=t[i-1],r=t[i],o=e.indexOf(s.x1),a=e.indexOf(r.x0);(o===-1||a===-1||o!==a)&&s.x1>=r.x0&&(r.x0=s.x0,r.x1=Math.max(s.x1,r.x1),s.x1=s.x0),i+=1}}}}class fr{lines=new Map;addWire(t,e){const{y0:i,y1:s}=e;e.y0=Math.min(i,s),e.y1=Math.max(i,s),e.x0=t,e.x1=t;let r=this.lines.get(t);r==null&&this.lines.set(t,r={wires:[],breakpoints:[]}),r.wires.push(e)}split(t,e,i){let s=this.lines.get(t);if(s!=null){s.breakpoints.push(e);for(const r of s.wires)if(r.y0<e&&e<r.y1){const o=new R(t,e,t,r.y1);i.push(o),s.wires.push(o),r.y1=e}}}merge(){for(const{wires:t,breakpoints:e}of this.lines.values()){t.sort((s,r)=>s.y0-r.y0);let i=1;for(;i<t.length;){const s=t[i-1],r=t[i],o=e.indexOf(s.y1),a=e.indexOf(r.y0);(o===-1||a===-1||o!==a)&&s.y1>=r.y0&&(r.y0=s.y0,r.y1=Math.max(s.y1,r.y1),s.y1=s.y0),i+=1}}}}function Gt(n){const t=[];for(const e of n){if(e instanceof lt){const{x:i,y:s,transform:r,symbol:o,name:a,props:l}=e;t.push(["i",i,s,r,o.id,a,l.export()])}if(e instanceof R){const{x0:i,y0:s,x1:r,y1:o}=e;t.push(["w",i,s,r,o])}if(e instanceof Ht){const{x:i,y:s,align:r,dir:o,text:a}=e;t.push(["n",i,s,r,o,a])}}return t}function bt(n){const t=[];for(const e of n)switch(e[0]){case"i":{const[i,s,r,o,a,l,u]=e,f=jn.get(a);t.push(new lt(f,l,Et.create(f).import(u),s,r,o));break}case"w":{const[i,s,r,o,a]=e;t.push(new R(s,r,o,a));break}case"n":{const[i,s,r,o,a,l]=e;t.push(new Ht(l,o,a,s,r));break}}return t}const qt=new class{#t=[];get full(){return this.#t.length>0}take(){return bt(this.#t)}put(t){this.#t=Gt(t)}clear(){this.#t=[]}};function pr(n){const t=[];for(const e of n)e instanceof lt&&t.push(e);return t}function dr(n){const t=[];for(const e of n)e instanceof R&&t.push(e);return t}function _r(n){const t=[];for(const e of n)e instanceof Ht&&t.push(e);return t}const $t={instance:1,note:2,wire:4096,notWire:4095,all:65535};function rn(n,t,e,i=$t.all){for(const s of n)if(i&mr(s)&&s.includes(t,e))return s;return null}function mr(n){switch(!0){case n instanceof lt:return $t.instance;case n instanceof Ht:return $t.note;case n instanceof R:return $t.wire}return 0}class vr{#t;#n;#o;constructor(t,e,i){this.#t=t,this.#n=e,this.#o=i}get name(){return this.#t}get elements(){return this.#n}get pins(){return this.#o}}class yr{#t;#n;#o;#e;constructor(t,e,i,s){this.#t=t,this.#n=e,this.#o=i,this.#e=s}get x(){return this.#t}get y(){return this.#n}get instance(){return this.#o}get name(){return this.#e}}function gr(){const n=[],t=[],e=[];return new class{get pins(){return n}get joins(){return t}get nodes(){return e}getWires(){return null}getPins(){return null}}}function br(n){const t=[],e=[],i=[],s=new Map,r=new wr(s,e,i);for(const o of n){if(o instanceof lt){for(const[a,l,u]of o.pins){const f=o.x+l,h=o.y+u,d=new yr(f,h,o,a);t.push(d),r.addPin(d)}continue}o instanceof R&&r.addWire(o)}return r.connect(),new class{get pins(){return t}get joins(){return e}get nodes(){return i}getWires(o,a){return s.get(Lt(o,a))?.wires??null}getPins(o,a){return s.get(Lt(o,a))?.pins??null}}}const Vr=new Set([Dt.vdc,Dt.idc,X.opamp,X.npn,X.pnp,X.nmos,X.pmos,X.nfet,X.pfet]);class wr{cells;joins;nodes;names;constructor(t,e,i){this.cells=t,this.joins=e,this.nodes=i,this.names=new Set(["ground"])}addPin(t){this.getCell(t.x,t.y).pins.push(t)}addWire(t){this.getCell(t.x0,t.y0).wires.push(t),this.getCell(t.x1,t.y1).wires.push(t)}getCell(t,e){const i=Lt(t,e);let s=this.cells.get(i);return s==null&&this.cells.set(i,s={x:t,y:e,wires:[],pins:[],color:null}),s}connect(){this.connectGrounds(),this.connectPorts(),this.connectWithSuggestedNames();let t=1;for(const e of this.cells.values())e.pins.length>0&&e.color==null&&(this.walk([e],this.getColor(this.getUniqueName(`_n${t}`))),t+=1);for(const e of this.cells.values())e.wires.length+e.pins.length>2&&this.joins.push({x:e.x,y:e.y})}connectGrounds(){const t=this.getColor("ground");for(const e of this.cells.values())for(const i of e.pins)if(i.instance.symbol===rt.ground){if(t.elements.push(i.instance),e.color==null)this.walk([e],t);else if(e.color!==t){this.conflict(t,e);return}}}connectPorts(){const t=new Map;for(const e of this.cells.values())for(const i of e.pins)if(i.instance.symbol===rt.port){const{name:s}=i.instance;this.names.add(s);let r=t.get(s);if(r==null&&t.set(s,r=this.getColor(s)),r.elements.push(i.instance),e.color==null)this.walk([e],r);else if(e.color!==r){this.conflict(r,e);return}}}connectWithSuggestedNames(){for(const t of this.cells.values())for(const e of t.pins)if(Vr.has(e.instance.symbol)&&t.color==null){const i=`_${e.instance.name}_${e.name}`;this.walk([t],this.getColor(this.getUniqueName(i)))}}conflict(t,e){console.warn(`Node naming conflict: [${t.node.name}] and [${e.color.node.name}]`),this.nodes.length=0}walk(t,e){for(;;){const i=t.pop();if(i==null)break;i.color=e;for(const s of i.wires){e.elements.push(s);const r=i.x===s.x1&&i.y===s.y1?Lt(s.x0,s.y0):Lt(s.x1,s.y1),o=this.cells.get(r);o!=null&&o.color==null&&t.push(o)}for(const s of i.pins)e.pins.push(s)}}getColor(t){const e=[],i=[],s=new vr(t,e,i);return this.nodes.push(s),{node:s,elements:e,pins:i}}getUniqueName(t){if(this.names.has(t)){let e=1;for(;;){let i=`${t}_${e}`;if(!this.names.has(i)){t=i;break}e+=1}}return this.names.add(t),t}}function Lt(n,t){return t+32768<<16|n+32768<<0}const on={rewire:n=>{},connect:n=>gr()},an={rewire:ur,connect:br};class K{#t;#n;#o;#e;#a;#i;#r;constructor(t,e=an){this.#t=[...t],this.#n=e,this.#o=null,this.#e=null,this.#a=null,this.#i=null,this.#r=null,this.#n.rewire(this.#t),t instanceof K&&t.#s()}[Symbol.iterator](){return this.#t[Symbol.iterator]()}get instances(){return this.#o??=pr(this.#t)}get notes(){return this.#e??=_r(this.#t)}get wires(){return this.#a??=dr(this.#t)}get network(){return this.#i??=this.#n.connect(this.#t)}get names(){return this.#r??=new ai(this.#t)}append(t){return new K([...this.#t,...t],this.#n)}delete(t){return new K(this.#t.filter(e=>!t.has(e)),this.#n)}unwire(){return new K(this.#t,on)}rewire(){return new K(this.#t,an)}rename(t="none"){const e=new K(this.#t,this.#n);return e.names.rename(t),e}edit(t){switch(t.type){case"set-note-text":{const{note:e,text:i}=t;e.text!==i&&(e.text=i);break}case"set-note-align":{const{note:e,align:i}=t;e.align!==i&&(e.align=i);break}case"set-note-dir":{const{note:e,dir:i}=t;e.dir!==i&&(e.dir=i);break}case"set-instance-prop":{const{instance:e,name:i,value:s}=t;e.props=e.props.setValue(i,s);break}}return new K(this,this.#n)}#s(){this.#t=[],this.#n=on,this.#o=null,this.#e=null,this.#a=null,this.#i=null,this.#r=null}}class se{static create(t){const e=new se;return e.#t=new xr(t),e}#t=ln;constructor(){}push(t,e){return this.#t.push(t,e),this.#n()}get canUndo(){return this.#t.canUndo}undo(){return[this.#t.undo(),this.#n()]}get canRedo(){return this.#t.canRedo}redo(){return[this.#t.redo(),this.#n()]}#n(){const t=new se;return t.#t=this.#t,this.#t=ln,t}}class xr{#t;#n;constructor(t){this.#t=[[Gt(t),"initial"]],this.#n=0}get length(){return this.#t.length}push(t,e){this.#n+=1,this.#t.splice(this.#n),this.#t.push([Gt(t),e])}get canUndo(){return this.#n>0}undo(){this.canUndo&&(this.#n-=1);const[t]=this.#t[this.#n];return new K(bt(t))}get canRedo(){return this.#n<this.#t.length-1}redo(){this.canRedo&&(this.#n+=1);const[t]=this.#t[this.#n];return new K(bt(t))}}const ln=li();class cn{#t;#n;constructor(t){this.#t=[...t],this.#n=[...t].map(e=>({element:e,x:e.x,y:e.y}))}get elements(){return this.#t}moveBy(t,e){for(const{element:i,x:s,y:r}of this.#n)i.moveTo(s+t,r+e)}reset(){for(const{element:t,x:e,y:i}of this.#n)t.moveTo(e,i)}}const Q=10,kr=4,Hr=30;class b{static defaultZoom=new b;#t;#n;#o;#e;static snap(t){return m(t/Q)*Q}static floor(t){return Math.floor(t/Q)*Q}static ceil(t){return Math.ceil(t/Q)*Q}constructor(t=Q,e=0,i=0){t=m(t),e=m(e),i=m(i),t=Math.max(kr,t),t=Math.min(Hr,t),this.#t=t,this.#n=e,this.#o=i,this.#e=t/Q}get gridSize(){return this.#t}get x(){return this.#n}get y(){return this.#o}get scale(){return this.#e}scaleTo(t){return new b(Q*t,this.#n,this.#o)}scaleBy(t){return new b(Q*(this.#e+t),this.#n,this.#o)}zoomTo(t){return new b(t,this.#n,this.#o)}zoomBy(t){return new b(this.#t+t,this.#n,this.#o)}moveTo(t,e){return new b(this.#t,t,e)}moveBy(t,e){return new b(this.#t,this.#n+t,this.#o+e)}toGridX(t){return m((t-this.#n)/this.#e)}toGridY(t){return m((t-this.#o)/this.#e)}toScreenX(t){return m(t*this.#e+this.#n)}toScreenY(t){return m(t*this.#e+this.#o)}snapScreenX(t){return this.toScreenX(b.snap(this.toGridX(t)))}snapScreenY(t){return this.toScreenY(b.snap(this.toGridY(t)))}static center(t,e,i,s=!1){const r=i.x1-i.x0,o=i.y1-i.y0;let a=b.defaultZoom;return s&&r>0&&o>0&&(a=a.scaleTo(Math.min(t/(r+Q*2),e/(o+Q*2)))),a.moveTo(t/2-(r/2+i.x0)*a.scale,e/2-(o/2+i.y0)*a.scale)}}et(new b);const I={symbol:{normal:"#222222",selected:"#0000ff"},pin:{normal:"#222222",selected:"#0000ff"},pinFill:{normal:"#ffffff",selected:"#ffffff"},wire:{normal:"#222222",selected:"#0000ff"},outline:"#22222222",selection:"#0000ff11",gridFine:"#00000066",gridCoarse:"#000000FF",crosshair:"#0000FF66"},w=.5;class ci{#t;#n;constructor(t){this.#t=t,this.#n=t.getContext("2d")}get canvas(){return this.#t}get ctx(){return this.#n}get width(){return this.#t.width}get height(){return this.#t.height}reset(){this.#n.reset()}paintGrid(t){const e=t.scale,i=t.x,s=t.y,r=t.gridSize,o=10,a=i%r,l=i%(r*o),u=s%r,f=s%(r*o);this.#e((h,d,p)=>{if(e>=1){h.strokeStyle=I.gridFine,h.lineWidth=1,h.lineCap="butt",h.setLineDash([1,r-1]);for(let _=u;_<p;_+=r)h.beginPath(),h.moveTo(a,_+w),h.lineTo(d,_+w),h.stroke()}}),this.#e((h,d,p)=>{h.strokeStyle=e>=1?I.gridCoarse:I.gridFine,h.lineWidth=1,h.lineCap="butt",h.setLineDash([1,r-1]);for(let _=f;_<p;_+=r*o)h.beginPath(),h.moveTo(a,_+w),h.lineTo(d,_+w),h.stroke();for(let _=l;_<d;_+=r*o)h.beginPath(),h.moveTo(_+w,u),h.lineTo(_+w,p),h.stroke()}),this.#e((h,d,p)=>{h.strokeStyle=I.gridFine,h.lineWidth=1,h.lineCap="butt",h.beginPath(),h.moveTo(m(i-10*e)+w,m(s)+w),h.lineTo(m(i+10*e)+w,m(s)+w),h.moveTo(m(i)+w,m(s-10*e)+w),h.lineTo(m(i)+w,m(s+10*e)+w),h.stroke()})}paintCrosshair(t,{x:e,y:i},s){this.#e((r,o,a)=>{s?(r.strokeStyle=I.crosshair,r.lineWidth=1,r.lineCap="butt"):(r.strokeStyle=I.outline,r.lineWidth=1,r.lineCap="butt"),r.beginPath(),r.moveTo(0,t.snapScreenY(i)+w),r.lineTo(o,t.snapScreenY(i)+w),r.moveTo(t.snapScreenX(e)+w,0),r.lineTo(t.snapScreenX(e)+w,a),r.stroke()})}paintSelection(t,e,i){this.#e(s=>{s.fillStyle=I.selection,s.fillRect(m(e.x),m(e.y),m(i.x-e.x),m(i.y-e.y))})}paintInstance(t,e,i=!1){const s=t.scale,r=t.x,o=t.y,a=e.x,l=e.y;this.#e(u=>{i?(u.fillStyle=I.symbol.selected,u.strokeStyle=I.symbol.selected,u.lineWidth=3,u.lineCap="square"):(u.fillStyle=I.symbol.normal,u.strokeStyle=I.symbol.normal,u.lineWidth=1,u.lineCap="square");for(const f of e.shapes)switch(f[0]){case"l":{const[h,d,p,_,y]=f;u.beginPath(),u.moveTo(m(r+(a+d)*s)+w,m(o+(l+p)*s)+w),u.lineTo(m(r+(a+_)*s)+w,m(o+(l+y)*s)+w),u.stroke();break}case"c":{const[h,d,p,_]=f;u.beginPath(),u.ellipse(m(r+(a+d)*s)+w,m(o+(l+p)*s)+w,m(_*s),m(_*s),0,0,2*Math.PI),u.stroke();break}case"a":{const[h,d,p,_,y,k]=f;u.beginPath(),u.ellipse(m(r+(a+d)*s)+w,m(o+(l+p)*s)+w,m(_*s),m(_*s),0,y*(Math.PI/180),k*(Math.PI/180)),u.stroke();break}case"t":{const[h,d,p,_,y]=f;this.#o(u,t,_),u.fillText(y,r+(a+d)*s,o+(l+p)*s);break}}})}paintPins(t,e,i=!1){const s=t.scale,r=t.x,o=t.y,a=e.x,l=e.y;this.#e(u=>{i?(u.fillStyle=I.pinFill.selected,u.strokeStyle=I.pin.selected,u.lineWidth=3,u.lineCap="square"):(u.fillStyle=I.pinFill.normal,u.strokeStyle=I.pin.normal,u.lineWidth=1,u.lineCap="square");for(const f of e.pins){const[h,d,p]=f;u.beginPath(),u.ellipse(m(r+(a+d)*s)+w,m(o+(l+p)*s)+w,m(3*s),m(3*s),0,0,2*Math.PI),u.fill(),u.stroke()}})}paintLabels(t,e,i=!1){const s=t.scale,r=t.x,o=t.y,a=e.x,l=e.y;this.#e(u=>{i?u.fillStyle=I.symbol.selected:u.fillStyle=I.symbol.normal;const[f,h,d]=e.labels;this.#o(u,t,d),u.fillText(e.name,r+(a+f)*s,o+(l+h)*s)})}paintWire(t,e,i=!1){const s=t.scale,r=t.x,o=t.y;this.#e(a=>{i?(a.strokeStyle=I.wire.selected,a.lineWidth=3,a.lineCap="square"):(a.strokeStyle=I.wire.normal,a.lineWidth=1,a.lineCap="square");const{x0:l,y0:u,x1:f,y1:h}=e;a.beginPath(),a.moveTo(m(r+l*s)+w,m(o+u*s)+w),a.lineTo(m(r+f*s)+w,m(o+h*s)+w),a.stroke()})}paintJoins(t,e){const i=t.scale,s=t.x,r=t.y;this.#e(o=>{o.fillStyle=I.wire.normal;for(const{x:a,y:l}of e)o.beginPath(),o.ellipse(m(s+a*i)+w,m(r+l*i)+w,m(3*i),m(3*i),0,0,2*Math.PI),o.fill()})}paintOrigin(t,{x:e,y:i},s){const r=t.scale,o=t.x,a=t.y;this.#e(l=>{s?(l.strokeStyle=I.symbol.selected,l.lineWidth=1,l.lineCap="butt"):(l.strokeStyle=I.outline,l.lineWidth=1,l.lineCap="butt"),l.beginPath(),l.moveTo(m(o+(e-10)*r)+w,m(a+i*r)+w),l.lineTo(m(o+(e+10)*r)+w,m(a+i*r)+w),l.moveTo(m(o+e*r)+w,m(a+(i-10)*r)+w),l.lineTo(m(o+e*r)+w,m(a+(i+10)*r)+w),l.stroke()})}paintArea(t,{x0:e,y0:i,x1:s,y1:r},o){const a=t.scale,l=t.x,u=t.y;this.#e(f=>{o?(f.strokeStyle=I.symbol.selected,f.lineWidth=1,f.lineCap="square"):(f.strokeStyle=I.outline,f.lineWidth=1,f.lineCap="square"),f.strokeRect(m(l+e*a)+w,m(u+i*a)+w,m((s-e)*a),m((r-i)*a))})}paintSymbolIcon(t,e,i){const s=oi(t,0,0),r=b.center(e,i,s,!0);this.paintInstance(r,{x:0,y:0,shapes:t.shapes})}#o(t,e,i){switch(t.font=`${20*e.scale}px serif`,ot(i)){case"l":t.textAlign="left";break;case"c":t.textAlign="center";break;case"r":t.textAlign="right";break}switch(at(i)){case"t":t.textBaseline="top";break;case"m":t.textBaseline="middle";break;case"b":t.textBaseline="bottom";break}}#e=t=>{const e=this.#n;e.save(),t(e,this.#t.width,this.#t.height),e.restore()}}class B{#t;constructor(t=[]){this.#t=new Set;for(const{id:e}of t)this.#t.add(e)}[Symbol.iterator](){return this.#t[Symbol.iterator]()}get size(){return this.#t.size}get full(){return this.#t.size>0}has({id:t}){return this.#t.has(t)}filter(t){return[...t].filter(({id:e})=>this.#t.has(e))}select(t){return new B(t)}add(t){const e=new B;for(const i of this.#t)e.#t.add(i);for(const{id:i}of t)e.#t.add(i);return e}delete(t){const e=new B;for(const i of this.#t)e.#t.add(i);for(const{id:i}of t)e.#t.delete(i);return e}clear(){return new B}}function re(n,t){const e={x:1/0,y:1/0},i={x:-1/0,y:-1/0};for(const s of n)t||s instanceof R?(e.x=Math.min(e.x,s.area.x0),e.y=Math.min(e.y,s.area.y0),i.x=Math.max(i.x,s.area.x1),i.y=Math.max(i.y,s.area.y1)):(e.x=Math.min(e.x,s.x),e.y=Math.min(e.y,s.y),i.x=Math.max(i.x,s.x),i.y=Math.max(i.y,s.y));return e.x<=i.x&&e.y<=i.y?{x0:e.x,y0:e.y,x1:i.x,y1:i.y}:{x0:0,y0:0,x1:0,y1:0}}function Cr(n,t){const e=re(n,!1);let i=0,s=0;switch(ot(t)){case"l":i=e.x0;break;case"c":i=b.snap((e.x0+e.x1)/2);break;case"r":i=e.x1;break}switch(at(t)){case"t":s=e.y0;break;case"m":s=b.snap((e.y0+e.y1)/2);break;case"b":s=e.y1;break}for(const r of n)r.moveTo(r.x-i,r.y-s)}function Mr(n,t){const e=re(n,!1),i=b.snap((e.x0+e.x1)/2),s=b.snap((e.y0+e.y1)/2);for(const r of n)r.transformBy(t,i,s)}class Sr{#t={current:null};#n;#o;#e;#a;#i;#r;#s;#f;#l;constructor(t,e){this.#n=t,this.#o=et({showGrid:!0,showCrosshair:!0}),this.#e=et(e),this.#a=et(se.create(e)),this.#i=et(new b),this.#r=et(new B),this.#s=et({type:"idle",cursor:{x:100,y:100},hovered:null});const i=o=>()=>{this.#i.value=this.#i.value.zoomBy(o)},s=(o,a)=>()=>{this.#i.value=this.#i.value.moveBy(o,a)},r=o=>()=>{this.pasteInstance(o)};this.#f=si(["Digit0",()=>{this.zoomTo("0")}],["Equal",i(1)],["Minus",i(-1)],["Home",()=>{this.zoomTo("1")}],["Space",()=>{this.zoomTo("all")}],["ArrowLeft",s(-10,0)],["Shift+ArrowLeft",s(-100,0)],["ArrowRight",s(10,0)],["Shift+ArrowRight",s(100,0)],["ArrowUp",s(0,-10)],["Shift+ArrowUp",s(0,-100)],["ArrowDown",s(0,10)],["Shift+ArrowDown",s(0,100)],["Ctrl+a",()=>{this.select("all")}],["Ctrl+x",()=>{this.selectionCut()}],["Ctrl+c",()=>{this.selectionCopy()}],["Ctrl+v",()=>{this.selectionPaste()}],["Delete",()=>{this.selectionDelete()}],["Ctrl+z",()=>{this.undo()}],["Ctrl+y",()=>{this.redo()}],["Alt+l",()=>{if(!this.transformSelection("rl"))return!1}],["Alt+r",()=>{if(!this.transformSelection("rr"))return!1}],["Alt+h",()=>{if(!this.transformSelection("mx"))return!1}],["Alt+v",()=>{if(!this.transformSelection("my"))return!1}],["Escape",()=>{if(!this.#u()){if(this.#r.value.full){this.#r.value=this.#r.value.clear();return}return!1}}],["w",()=>{if(this.#u(),!this.#x())return!1}],["g",r(rt.ground)],["o",r(rt.port)],["v",r(Dt.vdc)],["i",r(Dt.idc)],["r",r(Kt.resistor)],["c",r(Kt.capacitor)],["l",r(Kt.inductor)],["d",r(X.diode)],["n",r(X.npn)],["p",r(X.pnp)],["Shift+N",r(X.nmos)],["Shift+P",r(X.pmos)],["a",r(X.opamp)],["t",()=>{this.pasteNote("")}])}get focusRef(){return this.#t}get library(){return this.#n}get settings(){return this.#o.value}get schematic(){return this.#e.value}get history(){return this.#a.value}get zoom(){return this.#i.value}get selection(){return this.#r.value}get mouseAction(){return this.#s.value}attach(t){this.#l=new ci(t),this.#i.value=this.#y(!1)}handleFocus=t=>{this.#c()};handleBlur=t=>{this.#u(),this.#c()};handleKeyDown=t=>{this.#f(t)||this.#g(t)};handleKeyUp=t=>{this.#g(t)};#g(t){const{key:e}=t,i=A.of(t);if(e==="Shift"&&this.#H(e,i)){t.preventDefault();return}if(e==="Alt"&&this.#H(e,i)){t.preventDefault();return}if(e==="Shift"&&this.#C(e,i)){t.preventDefault();return}}handleMouseDown=t=>{Bs();const e=t.button,i=A.of(t),s=this.#d(t);e===0&&i===A.None&&(this.#v(s,i)||this.#w(s,i)||this.#b(s))||e===0&&i===A.Shift&&(this.#v(s,i)||this.#w(s,i)||this.#b(s))||e===0&&i===A.Alt&&this.#v(s,i)||e===1&&i===A.None&&this.#O(s)};handleMouseMove=t=>{const e=A.of(t),i=this.#d(t);this.#T(i)||this.#k(i,e)||this.#A(i)||this.#I(i)||this.#V(i,e)||this.#W(i)||this.#s.value.type==="idle"&&this.#_(i)&&this.#c(i)};handleMouseUp=t=>{const e=this.#d(t);this.#E(e)||this.#$(e)||this.#P(e)||this.#M(e)||this.#c(e)};handleWheel=t=>{t.preventDefault();const e=A.of(t);if(this.#s.value.type==="idle"&&e===A.None){this.#i.value=this.#i.value.zoomBy(-Math.sign(t.deltaY));return}};handleContextMenu=t=>{t.preventDefault()};#d(t){return{x:t.offsetX,y:t.offsetY}}#_(t){const e=this.#i.value.toGridX(t.x),i=this.#i.value.toGridY(t.y),s=this.#i.value.toGridX(this.#s.value.cursor.x),r=this.#i.value.toGridY(this.#s.value.cursor.y);return b.snap(e)!==b.snap(s)||b.snap(i)!==b.snap(r)}#c(t=this.#s.value.cursor){const e=b.snap(this.#i.value.toGridX(t.x)),i=b.snap(this.#i.value.toGridY(t.y)),s=rn(this.#e.value,e,i,$t.notWire);this.#s.value={type:"idle",cursor:t,hovered:s}}#b(t){return this.#s.value.type==="idle"?(this.#r.value=this.#r.value.clear(),this.#s.value={type:"select",cursor:{...t},origin:{...t}},!0):!1}#V(t,e){if(this.#s.value.type==="select"){const{origin:i}=this.#s.value,s={x0:this.#i.value.toGridX(Math.min(i.x,t.x)),y0:this.#i.value.toGridY(Math.min(i.y,t.y)),x1:this.#i.value.toGridX(Math.max(i.x,t.x)),y1:this.#i.value.toGridY(Math.max(i.y,t.y))};for(const r of this.#e.value)(e===A.Shift?zs(s,r.area):Us(s,r.area))?this.#r.value=this.#r.value.add([r]):this.#r.value=this.#r.value.delete([r]);return this.#s.value={type:"select",cursor:t,origin:i},!0}return!1}#C(t,e){return this.#s.value.type==="select"?this.#V(this.#s.value.cursor,e):!1}#M(t){if(this.#s.value.type==="select"){const{origin:e}=this.#s.value;return t.x===e.x&&t.y===e.y&&(this.#r.value=this.#r.value.clear()),this.#c(t),!0}return!1}#S(){return this.#s.value.type==="select"?(this.#r.value=new B,this.#c(),!0):!1}#w(t,e){if(this.#s.value.type==="idle"){const i=rn(this.#e.value,this.#i.value.toGridX(t.x),this.#i.value.toGridY(t.y));if(i!=null){this.#r.value.has(i)||(this.#r.value=e===A.Shift?this.#r.value.add([i]):this.#r.value.select([i]));const s=Gt(this.#e.value),r=new cn(this.#r.value.filter(this.#e.value));return this.#e.value=this.#e.value.unwire(),this.#s.value={type:"move",cursor:{...t},origin:{...t},undo:s,mover:r},!0}}return!1}#A(t){if(this.#s.value.type==="move"){if(this.#_(t)){const{origin:e,undo:i,mover:s}=this.#s.value,r=b.snap(this.#i.value.toGridX(e.x)),o=b.snap(this.#i.value.toGridY(e.y)),a=b.snap(this.#i.value.toGridX(t.x)),l=b.snap(this.#i.value.toGridY(t.y));s.moveBy(a-r,l-o),this.#e.value=this.#e.value.unwire(),this.#s.value={type:"move",cursor:t,origin:e,undo:i,mover:s}}return!0}return!1}#$(t){if(this.#s.value.type==="move"){const{origin:e,mover:i}=this.#s.value,s=b.snap(this.#i.value.toGridX(e.x)),r=b.snap(this.#i.value.toGridY(e.y)),o=b.snap(this.#i.value.toGridX(t.x)),a=b.snap(this.#i.value.toGridY(t.y));return i.moveBy(o-s,a-r),this.#e.value=this.#e.value.rewire(),(s!==o||r!==a)&&this.#h("move selection"),this.#c(t),!0}return!1}#L(){if(this.#s.value.type==="move"){const{undo:t}=this.#s.value;return this.#e.value=new K(bt(t)),this.#r.value=new B,this.#c(),!0}return!1}#m(t){if(this.#s.value.type==="idle"){const{cursor:e}=this.#s.value;Cr(t,"cm");const i=Gt(this.#e.value),s=new cn(t),r=b.snap(this.#i.value.toGridX(e.x)),o=b.snap(this.#i.value.toGridY(e.y));return s.moveBy(r,o),this.#e.value=this.#e.value.unwire().append(t).rename(),this.#r.value=new B(t),this.#s.value={type:"paste",cursor:e,undo:i,mover:s},!0}return!1}#I(t){if(this.#s.value.type==="paste"){if(this.#_(t)){const{undo:e,mover:i}=this.#s.value,s=b.snap(this.#i.value.toGridX(t.x)),r=b.snap(this.#i.value.toGridY(t.y));i.moveBy(s,r),this.#e.value=this.#e.value.unwire(),this.#s.value={type:"paste",cursor:t,undo:e,mover:i}}return!0}return!1}#P(t){if(this.#s.value.type==="paste"){const{mover:e}=this.#s.value,i=b.snap(this.#i.value.toGridX(t.x)),s=b.snap(this.#i.value.toGridY(t.y));return e.moveBy(i,s),this.#e.value=this.#e.value.rewire(),this.#h("paste"),this.#c(t),!0}return!1}#N(){if(this.#s.value.type==="paste"){const{undo:t}=this.#s.value;return this.#e.value=new K(bt(t)),this.#r.value=new B,this.#c(),!0}return!1}#x(){if(this.#s.value.type==="idle"){this.#r.value=this.#r.value.clear();const{cursor:t}=this.#s.value;return this.#s.value={type:"wire-start",cursor:t},!0}return!1}#T(t){return this.#s.value.type==="wire-start"?(this.#s.value={type:"wire-start",cursor:t},!0):!1}#D(){return this.#s.value.type==="wire-start"?(this.#c(),!0):!1}#v(t,e){return this.#s.value.type==="idle"&&this.#z(t)?(this.#r.value=this.#r.value.clear(),this.#s.value={type:"wire",cursor:{...t},origin:{...t},wires:[],shape:ve(e)},!0):this.#s.value.type==="wire-start"?(this.#s.value={type:"wire",cursor:{...t},origin:{...t},wires:[],shape:ve(e)},!0):!1}#k(t,e){if(this.#s.value.type==="wire"){const{origin:i}=this.#s.value,s=b.snap(this.#i.value.toGridX(i.x)),r=b.snap(this.#i.value.toGridY(i.y)),o=b.snap(this.#i.value.toGridX(t.x)),a=b.snap(this.#i.value.toGridY(t.y)),l=ve(e),u=cr(s,r,o,a,l);return this.#s.value={type:"wire",cursor:t,origin:i,wires:u,shape:l},!0}return!1}#H(t,e){return this.#s.value.type==="wire"?this.#k(this.#s.value.cursor,e):!1}#E(t){return this.#s.value.type==="wire"?(this.#e.value=this.#e.value.append(this.#s.value.wires),this.#h("draw wires"),this.#c(t),!0):!1}#G(){return this.#s.value.type==="wire"?(this.#c(),!0):!1}#O(t){return this.#s.value.type==="idle"?(this.#s.value={type:"scroll",cursor:{...t},origin:{...t},offset:{x:this.#i.value.x,y:this.#i.value.y}},!0):!1}#W(t){if(this.#s.value.type==="scroll"){const{origin:e,offset:i}=this.#s.value;return this.#i.value=this.#i.value.moveTo(i.x+(t.x-e.x),i.y+(t.y-e.y)),this.#s.value={type:"scroll",cursor:t,origin:e,offset:i},!0}return!1}#u(){return!!(this.#D()||this.#G()||this.#L()||this.#N()||this.#S())}#z(t){const{network:e}=this.#e.value,i=this.#i.value.toGridX(t.x),s=this.#i.value.toGridY(t.y),r=b.snap(i),o=b.snap(s);return r-5<=i&&i<=r+5&&o-5<=s&&s<=o+5&&(e.getWires(r,o)!=null||e.getPins(r,o)!=null)}#y(t){return b.center(this.#l.width,this.#l.height,re(this.#e.peek(),!0),t)}#h(t){this.#a.value=this.#a.value.push(this.#e.value,t)}edit(t){this.#e.value=this.#e.value.edit(t)}transformSelection(t){if(this.#r.value.full){const e=this.#r.value.filter(this.#e.value);switch(Mr(e,t),this.#e.value=new K(this.#e.value),t){case"rl":this.#h("rotate counter-clockwise");break;case"rr":this.#h("rotate clockwise");break;case"mx":this.#h("flip from left to right");break;case"my":this.#h("flip from top to bottom");break}return!0}return!1}pasteInstance(t){this.focus(),this.#u(),t===rt.wire?this.#x():this.#m([new lt(t)])}pasteNote(t){this.focus(),this.#u(),this.#m([new Ht(t)])}undo(){if(this.#a.value.canUndo){this.#u();const[t,e]=this.#a.value.undo();this.#e.value=t,this.#a.value=e,this.#r.value=new B}}redo(){if(this.#a.value.canRedo){this.#u();const[t,e]=this.#a.value.redo();this.#e.value=t,this.#a.value=e,this.#r.value=new B}}select(t){switch(this.#u(),t){case"all":this.#r.value=new B(this.#e.value);break;case"none":this.#r.value=new B;break;case"invert":this.#r.value=new B([...this.#e.value].filter(e=>!this.#r.value.has(e)));break;default:this.#r.value=new B(t);break}}selectionCut(){this.#u(),this.#r.value.size>0&&(qt.put(this.#r.value.filter(this.#e.value)),this.#e.value=this.#e.value.delete(this.#r.value),this.#r.value=new B,this.#h("cut"))}selectionCopy(){this.#u(),this.#r.value.size>0&&qt.put(this.#r.value.filter(this.#e.value))}selectionPaste(){qt.full&&(this.#u(),this.#m(qt.take()))}selectionDelete(){this.#u(),this.#r.value.size>0&&(this.#e.value=this.#e.value.delete(this.#r.value),this.#r.value=new B,this.#h("delete"))}zoomTo(t){switch(t){case"+":this.#i.value=this.#i.value.zoomBy(1);break;case"-":this.#i.value=this.#i.value.zoomBy(-1);break;case"0":this.#i.value=new b().moveTo(20,20);break;case"1":this.#i.value=this.#y(!1);break;case"all":this.#i.value=this.#y(!0);break}}updateSettings(t){this.#o.value={...this.#o.value,...t}}focus(){this.#t.current?.focus()}blur(){this.#t.current?.blur()}get focused(){return this.#t.current?.focused??!1}paint(){const t=this.#o.peek(),e=this.#i.peek(),i=this.#s.peek();switch(this.#l.reset(),t.showGrid&&this.#l.paintGrid(e),i.type){case"idle":this.#p(!1,i.hovered,!1),this.focused&&t.showCrosshair&&this.#l.paintCrosshair(e,i.cursor,!1);break;case"scroll":this.#p(!1,null,!1);break;case"select":this.#p(!1,null,!1),this.#l.paintSelection(e,i.origin,i.cursor);break;case"wire-start":this.#p(!0,null,!1),this.#l.paintCrosshair(e,i.cursor,!0);break;case"wire":this.#l.paintCrosshair(e,i.cursor,!0),this.#p(!0,null,!1);for(const a of i.wires)this.#l.paintWire(e,a,!0);break;case"move":case"paste":this.#p(!0,null,!0);const s=re(i.mover.elements,!1),r=e.toScreenX(b.snap((s.x0+s.x1)/2)),o=e.toScreenY(b.snap((s.y0+s.y1)/2));this.#l.paintCrosshair(e,{x:r,y:o},!0);break}}#p(t,e,i){const s=this.#e.peek(),r=this.#i.peek(),o=this.#r.peek();for(const a of s.instances)this.#l.paintInstance(r,a,o.has(a)),a.symbol!==rt.ground&&this.#l.paintLabels(r,a,o.has(a)),(a===e||i)&&(this.#l.paintArea(r,a.area,!1),this.#l.paintOrigin(r,a,!1));for(const a of s.notes)o.has(a)?(this.#l.paintArea(r,a.area,!0),this.#l.paintOrigin(r,a,!0)):(a===e||i)&&(this.#l.paintArea(r,a.area,!1),this.#l.paintOrigin(r,a,!1));for(const a of s.wires)this.#l.paintWire(r,a,o.has(a));for(const a of s.instances)(t||a===e)&&this.#l.paintPins(r,a,o.has(a));this.#l.paintJoins(r,s.network.joins)}}const ui=Pe(null);function it(){return Tn(ui)}function hi(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(t=0;t<s;t++)n[t]&&(e=hi(n[t]))&&(i&&(i+=" "),i+=e)}else for(e in n)n[e]&&(i&&(i+=" "),i+=e);return i}function Ar(){for(var n,t,e=0,i="",s=arguments.length;e<s;e++)(n=arguments[e])&&(t=hi(n))&&(i&&(i+=" "),i+=t);return i}const $r="_root_1813r_1",Lr="_item_1813r_9",Ir="_selected_1813r_22";function Pr(){const n=it(),{schematic:t,selection:e}=n;return c("ul",{class:$r,children:t.instances.filter(({symbol:i})=>i!==rt.ground&&i!==rt.port).map(i=>c("li",{class:Ar(Lr,e.has(i)&&Ir),onClick:()=>{n.select([i]),n.focus()},children:[i.symbol.id,":",i.name," (#",i.id,")"]},i.id))})}function fi({canvas:n,style:t,...e}){return c("canvas",{...e,ref:n,style:{display:"block",inlineSize:"100%",blockSize:"100%",...t}})}const pi=n=>{const t=n.getContext("2d"),e=devicePixelRatio,{width:i,height:s}=n.getBoundingClientRect(),r=Math.max(1,i*e),o=Math.max(1,s*e);return(n.width!==r||n.height!==o)&&(n.width=r,n.height=o,t.scale(e,e)),{width:r,height:o}},Nr="_root_1ar66_1",Tr="_category_1ar66_5",Dr="_title_1ar66_10",Er="_list_1ar66_15",Gr="_symbol_1ar66_24";function Or(){const{library:n}=it(),t=Object.groupBy(n,({category:e})=>e);return c("div",{class:Nr,children:Object.entries(t).map(([e,i])=>c(Wr,{name:e,symbols:i},e))})}function Wr({name:n,symbols:t}){return c("div",{class:Tr,children:[c("div",{class:Dr,children:n}),c("div",{class:Er,children:t.map(e=>c(zr,{symbol:e},e.id))})]})}function zr({symbol:n}){const t=it(),e=gt(null);return ue(()=>{const{width:i,height:s}=pi(e.current);new ci(e.current).paintSymbolIcon(n,i,s)},[n]),c("div",{class:Gr,title:n.name,onClick:()=>{t.pasteInstance(n)},children:c(fi,{canvas:e})})}const Ur="_root_k0zzy_1",Rr="_item_k0zzy_9";function Br(){const n=it(),{schematic:t}=n;return c("ul",{class:Ur,children:t.network.nodes.map(e=>c("li",{class:Rr,onClick:()=>{n.select(e.elements),n.focus()},children:e.name},e.name))})}function di({inputRef:n={current:null},type:t="text",value:e,onFocus:i,onBlur:s,onChange:r,...o}){const a=gt(null);Nn(n,()=>({focus(){a.current.focus()},blur(){a.current.blur()},get focused(){return document.activeElement===a.current},select(){a.current.select()}}));const[l,u]=ce(e);return t==="textarea"?c("textarea",{...o,ref:a,value:l,onInput:f=>{u(f.currentTarget.value)},onFocus:f=>{i?.(f)},onBlur:f=>{r(l),s?.(f)},onKeyDown:f=>{f.key==="Enter"&&A.of(f)===A.Control&&(f.preventDefault(),r(l))}}):c("input",{...o,ref:a,type:t,value:l,onInput:f=>{u(f.currentTarget.value)},onFocus:f=>{i?.(f)},onBlur:f=>{r(l),s?.(f)},onKeyDown:f=>{f.key==="Enter"&&A.of(f)===A.None&&(f.preventDefault(),r(l))}})}const Fr="_root_hzlci_1",un="_title_hzlci_8",qr="_table_hzlci_13",jr="_propName_hzlci_19",Zr="_propValue_hzlci_26",Yr="_propTitle_hzlci_33",Xr="_input_hzlci_41";function Kr({instance:n}){const t=it(),{device:e}=n.symbol;return c("div",{class:Fr,children:[c("div",{class:un,children:n.symbol.name}),c("div",{class:un,children:["name: ",n.name]}),e!=null&&c("table",{class:qr,children:c("tbody",{children:Object.entries(e.propsSchema).map(([i,s])=>c("tr",{children:[c("td",{class:jr,children:i}),c("td",{class:Zr,children:c(di,{class:Xr,type:"text",value:String(s.defaultValue||"0"),onChange:r=>{t.edit({type:"set-instance-prop",instance:n,name:i,value:r})}})}),c("td",{class:Yr,children:s.title})]}))})})]})}var Jr="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z",Qr="M11 2H13V7H21V10H13V14H18V17H13V22H11V17H6V14H11V10H3V7H11V2Z",to="M4 22H2V2H4V22M22 7H6V10H22V7M16 14H6V17H16V14Z",eo="M20 2H22V22H20V2M2 10H18V7H2V10M8 17H18V14H8V17Z",no="M22 22H2V20H22V22M10 2H7V18H10V2M17 8H14V18H17V8Z",io="M22 11H17V6H14V11H10V3H7V11H1.8V13H7V21H10V13H14V18H17V13H22V11Z",so="M22 2V4H2V2H22M7 22H10V6H7V22M14 16H17V6H14V16Z",ro="M7,2H17A2,2 0 0,1 19,4V20A2,2 0 0,1 17,22H7A2,2 0 0,1 5,20V4A2,2 0 0,1 7,2M7,4V8H17V4H7M7,10V12H9V10H7M11,10V12H13V10H11M15,10V12H17V10H15M7,14V16H9V14H7M11,14V16H13V14H11M15,14V16H17V14H15M7,18V20H9V18H7M11,18V20H13V18H11M15,18V20H17V18H15Z",oo="M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M12 20C7.59 20 4 16.41 4 12S7.59 4 12 4 20 7.59 20 12 16.41 20 12 20M16.59 7.58L10 14.17L7.41 11.59L6 13L10 17L18 9L16.59 7.58Z",ao="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",lo="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z",co="M19,3L13,9L15,11L22,4V3M12,12.5A0.5,0.5 0 0,1 11.5,12A0.5,0.5 0 0,1 12,11.5A0.5,0.5 0 0,1 12.5,12A0.5,0.5 0 0,1 12,12.5M6,20A2,2 0 0,1 4,18C4,16.89 4.9,16 6,16A2,2 0 0,1 8,18C8,19.11 7.1,20 6,20M6,8A2,2 0 0,1 4,6C4,4.89 4.9,4 6,4A2,2 0 0,1 8,6C8,7.11 7.1,8 6,8M9.64,7.64C9.87,7.14 10,6.59 10,6A4,4 0 0,0 6,2A4,4 0 0,0 2,6A4,4 0 0,0 6,10C6.59,10 7.14,9.87 7.64,9.64L10,12L7.64,14.36C7.14,14.13 6.59,14 6,14A4,4 0 0,0 2,18A4,4 0 0,0 6,22A4,4 0 0,0 10,18C10,17.41 9.87,16.86 9.64,16.36L12,14L19,21H22V20L9.64,7.64Z",uo="M19,20H5V4H7V7H17V4H19M12,2A1,1 0 0,1 13,3A1,1 0 0,1 12,4A1,1 0 0,1 11,3A1,1 0 0,1 12,2M19,2H14.82C14.4,0.84 13.3,0 12,0C10.7,0 9.6,0.84 9.18,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V4A2,2 0 0,0 19,2Z",ho="M3.05,13H1V11H3.05C3.5,6.83 6.83,3.5 11,3.05V1H13V3.05C17.17,3.5 20.5,6.83 20.95,11H23V13H20.95C20.5,17.17 17.17,20.5 13,20.95V23H11V20.95C6.83,20.5 3.5,17.17 3.05,13M12,5A7,7 0 0,0 5,12A7,7 0 0,0 12,19A7,7 0 0,0 19,12A7,7 0 0,0 12,5Z",fo="M20.94 11C20.5 6.83 17.17 3.5 13 3.06V1H11V3.06C9.87 3.18 8.81 3.5 7.84 4.03L9.34 5.53C10.16 5.19 11.06 5 12 5C15.87 5 19 8.13 19 12C19 12.94 18.81 13.84 18.5 14.65L20 16.15C20.5 15.19 20.82 14.13 20.95 13H23V11H20.94M3 4.27L5.04 6.31C3.97 7.62 3.25 9.23 3.06 11H1V13H3.06C3.5 17.17 6.83 20.5 11 20.94V23H13V20.94C14.77 20.74 16.38 20.03 17.69 18.96L19.73 21L21 19.73L4.27 3L3 4.27M16.27 17.54C15.09 18.45 13.61 19 12 19C8.13 19 5 15.87 5 12C5 10.39 5.55 8.91 6.46 7.73L16.27 17.54Z",po="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z",_o="M15 21H17V19H15M19 9H21V7H19M3 5V19C3 20.1 3.9 21 5 21H9V19H5V5H9V3H5C3.9 3 3 3.9 3 5M19 3V5H21C21 3.9 20.1 3 19 3M11 23H13V1H11M19 17H21V15H19M15 5H17V3H15M19 13H21V11H19M19 21C20.1 21 21 20.1 21 19H19Z",mo="M3 15V17H5V15M15 19V21H17V19M19 3H5C3.9 3 3 3.9 3 5V9H5V5H19V9H21V5C21 3.9 20.1 3 19 3M21 19H19V21C20.1 21 21 20.1 21 19M1 11V13H23V11M7 19V21H9V19M19 15V17H21V15M11 19V21H13V19M3 19C3 20.1 3.9 21 5 21V19Z",vo="M20 18H4V8H20M20 6H12L10 4H4A2 2 0 0 0 2 6V18A2 2 0 0 0 4 20H20A2 2 0 0 0 22 18V8A2 2 0 0 0 20 6M14 9H16V13H19L15 17L11 13H14Z",yo="M13 19C13 19.34 13.04 19.67 13.09 20H4C2.9 20 2 19.11 2 18V6C2 4.89 2.89 4 4 4H10L12 6H20C21.1 6 22 6.89 22 8V13.81C21.39 13.46 20.72 13.22 20 13.09V8H4V18H13.09C13.04 18.33 13 18.66 13 19M20 18V15H18V18H15V20H18V23H20V20H23V18H20Z",go="M20 18H4V8H20M20 6H12L10 4H4A2 2 0 0 0 2 6V18A2 2 0 0 0 4 20H20A2 2 0 0 0 22 18V8A2 2 0 0 0 20 6M16 17H14V13H11L15 9L19 13H16Z",bo="M20.5,18L17.5,21V19H5V17H17.5V15L20.5,18M10.13,10H13.88L12,4.97L10.13,10M12.75,3L17.5,14H15.42L14.5,11.81H9.5L8.58,14H6.5L11.25,3H12.75Z",Vo="M3 12V13.5L14 18.25V16.15L11.8 15.25V10.25L14 9.35V7.25L3 12M10 14.62L5 12.75L10 10.88V14.62M18 4.25L15 7.25H17V19.75H19V7.25H21L18 4.25Z",wo="M10,4V8H14V4H10M16,4V8H20V4H16M16,10V14H20V10H16M16,16V20H20V16H16M14,20V16H10V20H14M8,20V16H4V20H8M8,14V10H4V14H8M8,8V4H4V8H8M10,14H14V10H10V14M4,2H20A2,2 0 0,1 22,4V20A2,2 0 0,1 20,22H4C2.92,22 2,21.1 2,20V4A2,2 0 0,1 4,2Z",xo="M0,2.77L1.28,1.5L22.5,22.72L21.23,24L19.23,22H4C2.92,22 2,21.1 2,20V4.77L0,2.77M10,4V7.68L8,5.68V4H6.32L4.32,2H20A2,2 0 0,1 22,4V19.7L20,17.7V16H18.32L16.32,14H20V10H16V13.68L14,11.68V10H12.32L10.32,8H14V4H10M16,4V8H20V4H16M16,20H17.23L16,18.77V20M4,8H5.23L4,6.77V8M10,14H11.23L10,12.77V14M14,20V16.77L13.23,16H10V20H14M8,20V16H4V20H8M8,14V10.77L7.23,10H4V14H8Z",ko="M10,19H13V22H10V19M12,2C17.35,2.22 19.68,7.62 16.5,11.67C15.67,12.67 14.33,13.33 13.67,14.17C13,15 13,16 13,17H10C10,15.33 10,13.92 10.67,12.92C11.33,11.92 12.67,11.33 13.5,10.67C15.92,8.43 15.32,5.26 12,5A3,3 0 0,0 9,8H6A6,6 0 0,1 12,2Z",Ho="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",Co="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z",Mo="M18 16H17.42L16.61 15.19C17.5 14 18 12.5 18 11C18 7.13 14.87 4 11 4C9.5 4 8 4.5 6.79 5.4C3.7 7.72 3.07 12.11 5.39 15.2C7.71 18.29 12.1 18.92 15.19 16.6L16 17.41V18L21 23L23 21L18 16M11 16C8.24 16 6 13.76 6 11S8.24 6 11 6 16 8.24 16 11 13.76 16 11 16M3 6L1 8V1H8L6 3H3V6M21 1V8L19 6V3H16L14 1H21M6 19L8 21H1V14L3 16V19H6Z",So="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z",Ao="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z",$o="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z",Lo="M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z",Io="M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10L15.55,5.55Z",Po="M9,9H15V15H9M7,17H17V7H7M15,5H17V3H15M15,21H17V19H15M19,17H21V15H19M19,9H21V7H19M19,21A2,2 0 0,0 21,19H19M19,13H21V11H19M11,21H13V19H11M9,3H7V5H9M3,17H5V15H3M5,21V19H3A2,2 0 0,0 5,21M19,3V5H21A2,2 0 0,0 19,3M13,3H11V5H13M3,9H5V7H3M7,21H9V19H7M3,13H5V11H3M3,5H5V3A2,2 0 0,0 3,5Z",No="M5,3H7V5H9V3H11V5H13V3H15V5H17V3H19V5H21V7H19V9H21V11H19V13H21V15H19V17H21V19H19V21H17V19H15V21H13V19H11V21H9V19H7V21H5V19H3V17H5V15H3V13H5V11H3V9H5V7H3V5H5V3Z",To="M1,4.27L2.28,3L21,21.72L19.73,23L17,20.27V21H15V19H15.73L5,8.27V9H3V7H3.73L1,4.27M20,3A1,1 0 0,1 21,4V5H19V3H20M15,5V3H17V5H15M11,5V3H13V5H11M7,5V3H9V5H7M11,21V19H13V21H11M7,21V19H9V21H7M4,21A1,1 0 0,1 3,20V19H5V21H4M3,15H5V17H3V15M21,15V17H19V15H21M3,11H5V13H3V11M21,11V13H19V11H21M21,7V9H19V7H21Z",Do="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z",Eo="M16.59,5.41L15.17,4L12,7.17L8.83,4L7.41,5.41L12,10M7.41,18.59L8.83,20L12,16.83L15.17,20L16.58,18.59L12,14L7.41,18.59Z",Go="M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z";const Oo="_root_1pl8d_1";function H({class:n=Oo,shape:t,viewBox:e="0 0 24 24",size:i="2rem",...s}){return c("svg",{class:n,viewBox:e,width:i,height:i,...s,children:c("path",{d:t})})}const Wo="_root_12ddp_1";function S({autoFocus:n,checked:t,class:e=Wo,disabled:i,icon:s,tabIndex:r,title:o,...a}){return c("button",{class:e,disabled:i,tabIndex:r,autoFocus:n,"aria-checked":t,title:o,...a,children:s})}const zo="_root_1oe1v_1",Uo="_separator_1oe1v_6";function J({children:n,class:t=zo}){return c("div",{class:t,children:n})}function Ro(){return c("span",{class:Uo})}J.Separator=Ro;const Bo="_root_1dace_1",Fo="_title_1dace_8",qo="_toolbar_1dace_13",jo="_text_1dace_22";function Zo({note:n}){const t=it(),e=ot(n.align),i=at(n.align),s=n.dir;return c("div",{class:Bo,children:[c("div",{class:Fo,children:"Note"}),c(J,{class:qo,children:[c(S,{icon:c(H,{shape:to,size:"24px"}),checked:e==="l",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`l${i}`})}}),c(S,{icon:c(H,{shape:Qr,size:"24px"}),checked:e==="c",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`c${i}`})}}),c(S,{icon:c(H,{shape:eo,size:"24px"}),checked:e==="r",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`r${i}`})}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:so,size:"24px"}),checked:i==="t",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`${e}t`})}}),c(S,{icon:c(H,{shape:io,size:"24px"}),checked:i==="m",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`${e}m`})}}),c(S,{icon:c(H,{shape:no,size:"24px"}),checked:i==="b",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`${e}b`})}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:bo,size:"24px"}),checked:s==="h",onClick:()=>{t.edit({type:"set-note-dir",note:n,dir:"h"})}}),c(S,{icon:c(H,{shape:Vo,size:"24px"}),checked:s==="v",onClick:()=>{t.edit({type:"set-note-dir",note:n,dir:"v"})}})]}),c(di,{class:jo,type:"textarea",value:n.text,placeholder:"note...",onChange:r=>{t.edit({type:"set-note-text",note:n,text:r})}})]})}const _i="_root_d1mui_1",Yo="_empty_d1mui_7",Xo="_title_d1mui_11";function Ko(){const n=it(),{schematic:t,selection:e}=n,i=e.filter(t);if(i.length===1){const[s]=i;if(s instanceof lt)return c(Kr,{instance:s},s.id);if(s instanceof Ht)return c(Zo,{note:s},s.id);if(s instanceof R)return c(Jo,{wire:s},s.id)}return c("div",{class:_i,children:c("div",{class:Yo,children:"-"})})}function Jo({wire:n}){return c("div",{class:_i,children:c("div",{class:Xo,children:"Wire"})})}function Qo(n){const[t,e]=ce(new DOMRect);return ue(()=>{const{current:i}=n;if(i==null)return;const s=new ResizeObserver(()=>{e(i.getBoundingClientRect())});return s.observe(i),()=>{s.disconnect()}},[n]),t}function ta(n,t){for(var e in t)n[e]=t[e];return n}function Me(n,t){for(var e in n)if(e!=="__source"&&!(e in t))return!0;for(var i in t)if(i!=="__source"&&n[i]!==t[i])return!0;return!1}function hn(n,t){this.props=n,this.context=t}function ea(n,t){function e(s){var r=this.props.ref,o=r==s.ref;return!o&&r&&(r.call?r(null):r.current=null),t?!t(this.props,s)||!o:Me(this.props,s)}function i(s){return this.shouldComponentUpdate=e,Jt(n,s)}return i.displayName="Memo("+(n.displayName||n.name)+")",i.prototype.isReactComponent=!0,i.__f=!0,i}(hn.prototype=new nt).isPureReactComponent=!0,hn.prototype.shouldComponentUpdate=function(n,t){return Me(this.props,n)||Me(this.state,t)};var fn=x.__b;x.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),fn&&fn(n)};var na=x.__e;x.__e=function(n,t,e,i){if(n.then){for(var s,r=t;r=r.__;)if((s=r.__c)&&s.__c)return t.__e==null&&(t.__e=e.__e,t.__k=e.__k),s.__c(n,t)}na(n,t,e,i)};var pn=x.unmount;function mi(n,t,e){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),n.__c.__H=null),(n=ta({},n)).__c!=null&&(n.__c.__P===e&&(n.__c.__P=t),n.__c=null),n.__k=n.__k&&n.__k.map(function(i){return mi(i,t,e)})),n}function vi(n,t,e){return n&&e&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(i){return vi(i,t,e)}),n.__c&&n.__c.__P===t&&(n.__e&&e.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=e)),n}function ye(){this.__u=0,this.o=null,this.__b=null}function yi(n){var t=n.__.__c;return t&&t.__a&&t.__a(n)}function jt(){this.i=null,this.l=null}x.unmount=function(n){var t=n.__c;t&&t.__R&&t.__R(),t&&32&n.__u&&(n.type=null),pn&&pn(n)},(ye.prototype=new nt).__c=function(n,t){var e=t.__c,i=this;i.o==null&&(i.o=[]),i.o.push(e);var s=yi(i.__v),r=!1,o=function(){r||(r=!0,e.__R=null,s?s(a):a())};e.__R=o;var a=function(){if(!--i.__u){if(i.state.__a){var l=i.state.__a;i.__v.__k[0]=vi(l,l.__c.__P,l.__c.__O)}var u;for(i.setState({__a:i.__b=null});u=i.o.pop();)u.forceUpdate()}};i.__u++||32&t.__u||i.setState({__a:i.__b=i.__v.__k[0]}),n.then(o,o)},ye.prototype.componentWillUnmount=function(){this.o=[]},ye.prototype.render=function(n,t){if(this.__b){if(this.__v.__k){var e=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=mi(this.__b,e,i.__O=i.__P)}this.__b=null}var s=t.__a&&Jt(ft,null,n.fallback);return s&&(s.__u&=-33),[Jt(ft,null,t.__a?null:n.children),s]};var dn=function(n,t,e){if(++e[1]===e[0]&&n.l.delete(t),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.l.size))for(e=n.i;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;n.i=e=e[2]}};(jt.prototype=new nt).__a=function(n){var t=this,e=yi(t.__v),i=t.l.get(n);return i[0]++,function(s){var r=function(){t.props.revealOrder?(i.push(s),dn(t,n,i)):s()};e?e(r):r()}},jt.prototype.render=function(n){this.i=null,this.l=new Map;var t=te(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&t.reverse();for(var e=t.length;e--;)this.l.set(t[e],this.i=[1,0,this.i]);return n.children},jt.prototype.componentDidUpdate=jt.prototype.componentDidMount=function(){var n=this;this.l.forEach(function(t,e){dn(n,e,t)})};var ia=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,sa=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ra=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,oa=/[A-Z0-9]/g,aa=typeof document<"u",la=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(n)};nt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(nt.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(t){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:t})}})});var _n=x.event;function ca(){}function ua(){return this.cancelBubble}function ha(){return this.defaultPrevented}x.event=function(n){return _n&&(n=_n(n)),n.persist=ca,n.isPropagationStopped=ua,n.isDefaultPrevented=ha,n.nativeEvent=n};var fa={enumerable:!1,configurable:!0,get:function(){return this.class}},mn=x.vnode;x.vnode=function(n){typeof n.type=="string"&&function(t){var e=t.props,i=t.type,s={},r=i.indexOf("-")===-1;for(var o in e){var a=e[o];if(!(o==="value"&&"defaultValue"in e&&a==null||aa&&o==="children"&&i==="noscript"||o==="class"||o==="className")){var l=o.toLowerCase();o==="defaultValue"&&"value"in e&&e.value==null?o="value":o==="download"&&a===!0?a="":l==="translate"&&a==="no"?a=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?o="ondblclick":l!=="onchange"||i!=="input"&&i!=="textarea"||la(e.type)?l==="onfocus"?o="onfocusin":l==="onblur"?o="onfocusout":ra.test(o)&&(o=l):l=o="oninput":r&&sa.test(o)?o=o.replace(oa,"-$&").toLowerCase():a===null&&(a=void 0),l==="oninput"&&s[o=l]&&(o="oninputCapture"),s[o]=a}}i=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=te(e.children).forEach(function(u){u.props.selected=s.value.indexOf(u.props.value)!=-1})),i=="select"&&s.defaultValue!=null&&(s.value=te(e.children).forEach(function(u){u.props.selected=s.multiple?s.defaultValue.indexOf(u.props.value)!=-1:s.defaultValue==u.props.value})),e.class&&!e.className?(s.class=e.class,Object.defineProperty(s,"className",fa)):(e.className&&!e.class||e.class&&e.className)&&(s.class=s.className=e.className),t.props=s}(n),n.$$typeof=ia,mn&&mn(n)};var vn=x.__r;x.__r=function(n){vn&&vn(n),n.__c};var yn=x.diffed;x.diffed=function(n){yn&&yn(n);var t=n.props,e=n.__e;e!=null&&n.type==="textarea"&&"value"in t&&t.value!==e.value&&(e.value=t.value==null?"":t.value)};const pa={open:/\$/y,close:/\$/y},da={open:/\\\(/y,close:/\\\)/y},_a={open:/\$\$/y,close:/\$\$/y},ma={open:/\\\[/y,close:/\\\]/y},gn=/\s+|\\\{|\\\}|\\\\/y;function va(n){let t=oe(n,"$","$"),e=oe(n,"\\(","\\)");if(t!==-1&&e!==-1)return Math.min(t,e);if(t!==-1)return t;if(e!==-1)return e}function ya(n,t){return ae(n,pa,t)||ae(n,da,t)}function ga(n){let t=oe(n,"$$","$$"),e=oe(n,"\\[","\\]");if(t!==-1&&e!==-1)return Math.min(t,e);if(t!==-1)return t;if(e!==-1)return e}function ba(n,t){return ae(n,_a,t)||ae(n,ma,t)}function oe(n,t,e){let i=n.indexOf(t);return i!==-1&&n.indexOf(e,i+t.length+1)===-1&&(i=-1),i}function ae(n,t,e){if(ge(n,t.open,0)){let i=t.open.lastIndex;for(;i<n.length;)if(ge(n,gn,i))i=gn.lastIndex;else{if(ge(n,t.close,i))return e.raw=n.substring(0,t.close.lastIndex),e.text=n.substring(t.open.lastIndex,i).trim(),!0;i+=1}}return!1}function ge(n,t,e){return t.lastIndex=e,t.test(n)}function Va(n){return{extensions:[wa(n),xa(n)]}}function wa(n){const t={raw:"",text:""};return{name:"blockKatex",level:"block",start(e){return ga(e)},tokenizer(e){if(ba(e,t))return{type:"blockKatex",raw:t.raw,text:t.text}},renderer({text:e}){return Vn(e,{...n,displayMode:!0})+`
`}}}function xa(n){const t={raw:"",text:""};return{name:"inlineKatex",level:"inline",start(e){return va(e)},tokenizer(e){if(ya(e,t))return{type:"inlineKatex",raw:t.raw,text:t.text}},renderer({text:e}){return Vn(e,{...n,displayMode:!1})}}}const ka=new wi(Va({output:"mathml",throwOnError:!1}));function Ha(n){return ka.parse(n,{async:!1,silent:!0,gfm:!1,pedantic:!1})}const Ca="_root_2mcg2_1",Ma=ea(Sa);function Sa({note:n,text:t,align:e,dir:i,x:s,y:r,width:o,height:a}){const l=gt(null);Tt(()=>{l.current.setHTMLUnsafe(Ha(t||"note..."))},[t]),Tt(()=>{n.width=l.current.offsetWidth,n.height=l.current.offsetHeight});const u=Aa(s,r,e,i);return c("div",{ref:l,class:Ca,style:u,"data-align":e,"data-h-align":ot(e),"data-v-align":at(e),"data-dir":i})}function Aa(n,t,e,i){let s=0,r=0;switch(ot(e)){case"l":s=0;break;case"c":s=-50;break;case"r":s=-100;break}switch(at(e)){case"t":r=0;break;case"m":r=-50;break;case"b":r=-100;break}let o=0;switch(i){case"v":o=-90;break;case"h":o=0;break}return{position:"absolute",left:n,top:t,transformOrigin:`${-s}% ${-r}%`,translate:`${s}% ${r}%`,rotate:`${o}deg`}}const $a="_root_1nll4_1";function La(){const{schematic:n,zoom:t}=it();return c("div",{class:$a,style:{transformOrigin:"0px 0px",translate:`${t.x}px ${t.y}px`,scale:`${t.scale}`},children:n.notes.map(e=>c(Ma,{note:e,text:e.text,align:e.align,dir:e.dir,x:e.x,y:e.y,width:e.width,height:e.height},e.id))})}const Ia="_root_1hx45_1";function Pa(){const n=it(),t=gt(null),e=gt(null),{width:i,height:s}=Qo(e);return Nn(n.focusRef,()=>({focus:()=>{t.current?.focus()},blur:()=>{t.current?.blur()},get focused(){return t.current===document.activeElement}})),Tt(()=>{i>0&&s>0&&(pi(e.current),n.attach(e.current))},[n,i,s]),Tt(()=>{if(i>0&&s>0){const r=requestAnimationFrame(()=>{n.paint()});return()=>{cancelAnimationFrame(r)}}},[n,i,s,n.settings,n.schematic,n.zoom,n.selection,n.mouseAction]),c("div",{ref:t,class:Ia,tabIndex:0,autofocus:!0,onFocus:n.handleFocus,onBlur:n.handleBlur,onKeyDown:n.handleKeyDown,onKeyUp:n.handleKeyUp,style:Na(n),children:[c(fi,{canvas:e,onMouseDown:n.handleMouseDown,onMouseMove:n.handleMouseMove,onMouseUp:n.handleMouseUp,onWheel:n.handleWheel,onContextMenu:n.handleContextMenu}),c(La,{})]})}function Na(n){switch(n.mouseAction.type){case"scroll":return{cursor:"all-scroll"};case"wire-start":case"wire":return{cursor:"crosshair"};case"move":case"paste":return{cursor:"move"}}return{cursor:"default"}}const Ta=Pe(null),Da="_root_3m5pl_1 _fadeIn_kq333_1";let Ea=0;class Ga{constructor(t,e){this.message=t,this.options=e}#t=Ea+=1;get key(){return this.#t}}const Vt=et([]);function Oa(n){Vt.value=[...Vt.value,n]}function Wa(n){Vt.value=Vt.value.filter(t=>t!==n)}function za({message:n}){const t=gt(null);return ue(()=>{n.options.modal?t.current?.showModal():t.current?.show()},[n]),c("dialog",{ref:t,class:Da,onClose:()=>{Wa(n),n.options.onClose()},children:c(Ta.Provider,{value:{close:()=>{t.current?.close()}},children:n.message})},n.key)}const Ua="_root_5uo3x_1";function Ra(){return c("div",{class:Ua,hidden:Vt.value.length===0,children:Vt.value.map(n=>c(za,{message:n}))})}function bn(n,{modal:t=!0,onClose:e=()=>{}}={}){Oa(new Ga(n,{modal:t,onClose:e}))}const Ba="_alert_ppbdc_1 _fadeIn_kq333_1",Fa="_message_ppbdc_17";class qa{#t=new Set;get pending(){return this.#t.size}delayed(t,e){let i=!1,s=!1;const r=()=>{s||(s=!0,this.#t.delete(o),clearTimeout(a))},o=new class{cancel(){r()}get fired(){return i}get cancelled(){return s}};this.#t.add(o);const a=setTimeout(()=>{s||(this.#t.delete(o),i=!0,e())},t);return o}repeated(t,e){let i=!1,s=!1;const r=()=>{s||(s=!0,this.#t.delete(o),clearInterval(a))},o=new class{cancel(){r()}get fired(){return i}get cancelled(){return s}};this.#t.add(o);const a=setInterval(()=>{s||(i=!0,e())},t);return o}cancelAll(){for(const t of this.#t)t.cancel();return this}}const ja=new qa;let Za=0;class Ya{constructor(t,e){this.message=t,this.options=e}#t=Za+=1;#n=null;get key(){return this.#t}delayed(t,e){this.clearDelayed(),this.#n=ja.delayed(e,t)}clearDelayed(){this.#n!=null&&(this.#n.cancel(),this.#n=null)}}const wt=et([]);function Xa(n){wt.value=[...wt.value,n],gi(n)}function Se(n){wt.value=wt.value.filter(t=>t!==n)}function Ka(n,t){t?n.clearDelayed():gi(n)}function gi(n){n.options.autoClose&&n.delayed(()=>{Se(n)},n.options.autoClose)}const bi=Pe(null);function Ja({toast:n,children:t}){return c(bi.Provider,{value:{close:()=>{Se(n)},hover:e=>{n.options.autoClose&&n.options.pauseOnHover&&Ka(n,e)},click:()=>{n.options.closeOnClick&&Se(n)}},children:t})}function ze(){return Tn(bi)}function Vi(n){return{onMouseEnter:()=>{n.hover(!0)},onMouseLeave:()=>{n.hover(!1)},onClick:()=>{n.click()}}}function Qa({children:n}){return Ai(n,{...n.props,...Vi(ze())})}function tl(){const n=ze();return c(H,{shape:ao,onClick:()=>{n.close()}})}function el({severity:n}){switch(n){case"info":return c(nl,{});case"success":return c(il,{});case"error":return c(sl,{});default:return null}}function nl(){return c(H,{shape:Ho})}function il(){return c(H,{shape:oo})}function sl(){return c(H,{shape:Jr})}function rl({children:n,severity:t=null,closeButton:e=!0}){const i=ze();return c("div",{class:Ba,...Vi(i),popover:!0,children:[t&&c(el,{severity:t}),c("div",{class:Fa,children:n}),e&&c(tl,{})]})}const ol="_root_1k080_1";function al(){return c("div",{class:ol,hidden:wt.value.length===0,children:[...wt.value].reverse().map(n=>c(Ja,{toast:n,children:c(Qa,{children:n.message})},n.key))})}function ll(n,{autoClose:t=3e3,pauseOnHover:e=!0,closeOnClick:i=!0}={}){Xa(new Ya(n,{autoClose:t,pauseOnHover:e,closeOnClick:i}))}function It({error:n}){return c(rl,{severity:"error",children:n instanceof AggregateError?n.errors.map((t,e)=>c("p",{children:String(t)},e)):c("p",{children:String(n)})})}function cl(n,{autoClose:t=3e3,pauseOnHover:e=!0,closeOnClick:i=!1}={}){ll(c(It,{error:n}),{autoClose:t,pauseOnHover:e,closeOnClick:i})}It.report=cl;const ul="_root_yio74_1",hl="_header_yio74_9",fl="_headerText_yio74_14",pl="_headerButton_yio74_25",dl="_content_yio74_29",_l="_resize_yio74_36";function Zt({title:n,children:t,style:e}){const[i,s]=ce(!0);return c("div",{class:ul,style:e,children:[c("div",{class:hl,children:[c("span",{class:fl,children:n}),c("span",{class:pl,onClick:()=>{s(!i)},children:c(H,{shape:i?Eo:Go})})]}),i&&c(ft,{children:[c("div",{class:dl,children:t}),c(ml,{})]})]})}function ml(){return c("svg",{class:_l,viewBox:"0 0 24 24",children:c("path",{d:"M22,22H20V20H22V22M22,18H20V16H22V18M18,22H16V20H18V22M18,18H16V16H18V18M14,22H12V20H14V22M22,14H20V12H22V14Z"})})}const vl="_root_948vb_1",yl="_toolbar_948vb_8",gl="_schematic_948vb_17";function bl(){return new K(bt([["i",50,50,0,"vdc","V1",{}],["i",150,50,0,"r","R1",{}],["i",50,120,0,"g","G1",{}],["w",50,0,150,0],["w",50,100,150,100],["w",50,0,50,20],["w",50,80,50,100],["w",50,100,50,120],["w",150,0,150,20],["w",150,80,150,100],["n",250,0,"lt","h",`# Ohm's law

*Ohm's law* states that the electric current $I$ through a conductor between two points is directly proportional to the voltage $V$ across the two points.

$$I = \\frac{V}{R}$$

The law was named after the German physicist *Georg Ohm*.`],["n",700,0,"lm","h","\\[ \\int_{a}^{b} x^2 \\, dx \\]"],["n",700,50,"lm","h","\\[ \\iint_V \\mu(u,v) \\, du \\, dv \\]"],["n",700,100,"lm","h","\\[ \\oint_V f(s) \\, ds \\]"],["n",700,150,"lm","h","\\[ \\sum_{n=1}^{\\infty} 2^{-n} = 1 \\]"],["n",700,200,"lm","h","\\[ \\prod_{i=a}^{b} f(i) \\]"],["n",700,250,"lm","h","\\[ \\lim_{x\\to\\infty} f(x) \\]"],["n",700,300,"lm","h","\\[ \\begin{pmatrix} 1 & 2 & 3 \\\\ a & b & c \\end{pmatrix} \\]"]]))}const Vl="_root_1bk49_1",wl="_select_1bk49_8",xl="_content_1bk49_13";function kl(){return c("p",{children:"Capacitive reactance"})}function Hl(){return c("p",{children:"Inductive reactance"})}function Cl(){return c("p",{children:"Resistive voltage divider"})}function Ml(){return c("p",{children:"LC resonance"})}function Sl(){return c("p",{children:"Wavelength and frequency"})}const Yt=[{name:"Resistive voltage divider",component:Cl},{name:"Capacitive reactance",component:kl},{name:"Inductive reactance",component:Hl},{name:"LC resonance",component:Ml},{name:"Wavelength and frequency",component:Sl}];function Al(){const[n,t]=ce(Yt[0]),{component:e}=n;return c("section",{class:Vl,children:[c("select",{class:wl,value:n.name,onInput:({target:i})=>{const{value:s}=i;t(Yt.find(({name:r})=>r===s)??Yt[0])},children:Yt.map(({name:i})=>c("option",{value:i,children:i}))}),c("div",{class:xl,children:c(e,{})})]})}const $l="_root_8tr57_1";function Ll(){return c("section",{class:$l,children:[c("p",{children:["To draw a wire, click and start moving the pointer from a device pin, a wire end, or a wire junction. To draw a wire from any location on the grid, press ",c("kbd",{children:"W"}),". To change a wire's angle, press ",c("kbd",{children:"Shift"}),". To draw a diagonal wire, press ",c("kbd",{children:"Alt"}),"."]}),c("p",{children:"Shortcuts:"}),c("ul",{children:[c("li",{children:[c("kbd",{children:"W"})," Start drawing a wire from any point on the grid"]}),c("li",{children:[c("kbd",{children:"Shift"})," While drawing a wire, changes the angle of the wire"]}),c("li",{children:[c("kbd",{children:"Alt"})," While drawing a wire, draws a diagonal wire"]}),c("li",{children:[c("kbd",{children:"G"})," Place a ground symbol"]}),c("li",{children:[c("kbd",{children:"O"})," Place a port symbol"]}),c("li",{children:[c("kbd",{children:"V"})," Place a voltage source"]}),c("li",{children:[c("kbd",{children:"I"})," Place a current source"]}),c("li",{children:[c("kbd",{children:"R"})," Place a resistor"]}),c("li",{children:[c("kbd",{children:"C"})," Place a capacitor"]}),c("li",{children:[c("kbd",{children:"L"})," Place an inductor"]}),c("li",{children:[c("kbd",{children:"D"})," Place a diode"]}),c("li",{children:[c("kbd",{children:"N"})," Place an NPN transistor"]}),c("li",{children:[c("kbd",{children:"P"})," Place a PNP transistor"]}),c("li",{children:[c("kbd",{children:"Shift+N"})," Place an N-channel MOSFET"]}),c("li",{children:[c("kbd",{children:"Shift+P"})," Place a P-channel MOSFET"]}),c("li",{children:[c("kbd",{children:"A"})," Place an operational amplifier"]}),c("li",{children:[c("kbd",{children:"Home"})," Zoom to 100%"]}),c("li",{children:[c("kbd",{children:"Space"})," Expand or shrink to cover the whole screen"]}),c("li",{children:[c("kbd",{children:"Ctrl+X"})," Cut selected item(s) to clipboard"]}),c("li",{children:[c("kbd",{children:"Ctrl+C"})," Copy selected item(s) to clipboard"]}),c("li",{children:[c("kbd",{children:"Ctrl+V"})," Paste item(s) from clipboard"]}),c("li",{children:[c("kbd",{children:"Ctrl+A"})," Select all"]}),c("li",{children:[c("kbd",{children:"Delete"})," Delete selected item(s)"]}),c("li",{children:[c("kbd",{children:"Alt+L"})," Rotate selected item(s) to the left"]}),c("li",{children:[c("kbd",{children:"Alt+R"})," Rotate selected item(s) to the right"]}),c("li",{children:[c("kbd",{children:"Alt+H"})," Flip selected item(s) from left to right"]}),c("li",{children:[c("kbd",{children:"Alt+V"})," Flip selected item(s) from top to bottom"]}),c("li",{children:[c("kbd",{children:"Ctrl+Z"})," Undo"]}),c("li",{children:[c("kbd",{children:"Ctrl+Y"})," Redo"]})]})]})}const Il="_root_1qxgy_1";function Pl(){const n=it(),{settings:t}=n;return c(J,{class:Il,children:[c(S,{icon:c(H,{shape:vo}),title:"Open schematic",onClick:()=>{It.report("Not implemented")}}),c(S,{icon:c(H,{shape:go}),title:"Save schematic",onClick:()=>{It.report("Not implemented")}}),c(S,{icon:c(H,{shape:yo}),title:"New schematic",onClick:()=>{It.report("Not implemented")}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:Po}),title:"Select all",onClick:()=>{n.select("all"),n.focus()}}),c(S,{icon:c(H,{shape:No}),title:"Invert selection",onClick:()=>{n.select("invert"),n.focus()}}),c(S,{icon:c(H,{shape:To}),title:"Clear selection",onClick:()=>{n.select("none"),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:co}),title:"Cut selected item(s) to clipboard",onClick:()=>{n.selectionCut(),n.focus()}}),c(S,{icon:c(H,{shape:lo}),title:"Copy selected item(s) to clipboard",onClick:()=>{n.selectionCopy(),n.focus()}}),c(S,{icon:c(H,{shape:uo}),title:"Paste item(s) from clipboard",onClick:()=>{n.selectionPaste(),n.focus()}}),c(S,{icon:c(H,{shape:po}),title:"Delete selected item(s)",onClick:()=>{n.selectionDelete(),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:Lo}),title:"Rotate selected item(s) to the left",disabled:!n.selection.full,onClick:()=>{n.transformSelection("rl"),n.focus()}}),c(S,{icon:c(H,{shape:Io}),title:"Rotate selected item(s) to the right",disabled:!n.selection.full,onClick:()=>{n.transformSelection("rr"),n.focus()}}),c(S,{icon:c(H,{shape:_o}),title:"Flip selected item(s) from left to right",disabled:!n.selection.full,onClick:()=>{n.transformSelection("mx"),n.focus()}}),c(S,{icon:c(H,{shape:mo}),title:"Flip selected item(s) from top to bottom",disabled:!n.selection.full,onClick:()=>{n.transformSelection("my"),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:Do}),title:"Undo",disabled:!n.history.canUndo,onClick:()=>{n.undo(),n.focus()}}),c(S,{icon:c(H,{shape:$o}),title:"Redo",disabled:!n.history.canRedo,onClick:()=>{n.redo(),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:Co}),title:"Zoom 100%",onClick:()=>{n.zoomTo("1"),n.focus()}}),c(S,{icon:c(H,{shape:Ao}),title:"Zoom in",onClick:()=>{n.zoomTo("+"),n.focus()}}),c(S,{icon:c(H,{shape:So}),title:"Zoom out",onClick:()=>{n.zoomTo("-"),n.focus()}}),c(S,{icon:c(H,{shape:Mo}),title:"View all",onClick:()=>{n.zoomTo("all"),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:t.showGrid?xo:wo}),title:t.showGrid?"Hide grid":"Show grid",onClick:()=>{n.updateSettings({showGrid:!t.showGrid}),n.focus()}}),c(S,{icon:c(H,{shape:t.showCrosshair?fo:ho}),title:t.showCrosshair?"Hide crosshair":"Show crosshair",onClick:()=>{n.updateSettings({showCrosshair:!t.showCrosshair}),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:ro}),title:"Calculator",onClick:()=>{bn(c(Al,{}),{modal:!0,onClose:()=>{n.focus()}})}}),c(J.Separator,{}),c(S,{icon:c(H,{shape:ko}),title:"Help",onClick:()=>{bn(c(Ll,{}),{modal:!0,onClose:()=>{n.focus()}})}})]})}function Nl(){const n=he(()=>new Sr(jn,bl()),[]);return ue(()=>{const t=si(["Alt+v",()=>{}],["Alt+h",()=>{}],["Alt+r",()=>{}],["Alt+l",()=>{}],["Ctrl+a",()=>{}],["Ctrl+s",()=>{}],["Ctrl+o",()=>{}],["Ctrl+n",()=>{}],["Ctrl+r",()=>{}]);return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[n]),c(ui.Provider,{value:n,children:[c("main",{class:vl,children:[c("div",{class:yl,children:c(Pl,{})}),c("div",{class:gl,children:c(Pa,{})}),c(Zt,{title:"Instances",style:{insetInlineEnd:"38rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:c(Pr,{})}),c(Zt,{title:"Nodes",style:{insetInlineEnd:"20rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:c(Br,{})}),c(Zt,{title:"Library",style:{insetInlineEnd:"2rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:c(Or,{})}),c(Zt,{title:"Properties",style:{insetInlineStart:"2rem",insetBlockStart:"4rem"},children:c(Ko,{})})]}),c(Ra,{}),c(al,{})]})}Si(c(Nl,{}),document.querySelector("#app"));
