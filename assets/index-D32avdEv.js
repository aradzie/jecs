import{r as On}from"./katex-tJs74nH5.js";import{M as Fs}from"./marked-6_4nRR25.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();var Qt,x,qn,zn,gt,rn,Bn,Un,Wn,We,Ee,De,Rn,jt={},Fn=[],js=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Me=Array.isArray;function at(n,t){for(var e in t)n[e]=t[e];return n}function Re(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function de(n,t,e){var s,i,r,o={};for(r in t)r=="key"?s=t[r]:r=="ref"?i=t[r]:o[r]=t[r];if(arguments.length>2&&(o.children=arguments.length>3?Qt.call(arguments,2):e),typeof n=="function"&&n.defaultProps!=null)for(r in n.defaultProps)o[r]===void 0&&(o[r]=n.defaultProps[r]);return Bt(n,o,s,i,null)}function Bt(n,t,e,s,i){var r={type:n,props:t,key:e,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++qn,__i:-1,__u:0};return i==null&&x.vnode!=null&&x.vnode(r),r}function xt(n){return n.children}function st(n,t){this.props=n,this.context=t}function It(n,t){if(t==null)return n.__?It(n.__,n.__i+1):null;for(var e;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null)return e.__e;return typeof n.type=="function"?It(n):null}function jn(n){var t,e;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,t=0;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null){n.__e=n.__c.base=e.__e;break}return jn(n)}}function Ge(n){(!n.__d&&(n.__d=!0)&&gt.push(n)&&!pe.__r++||rn!==x.debounceRendering)&&((rn=x.debounceRendering)||Bn)(pe)}function pe(){for(var n,t,e,s,i,r,o,a=1;gt.length;)gt.length>a&&gt.sort(Un),n=gt.shift(),a=gt.length,n.__d&&(e=void 0,i=(s=(t=n).__v).__e,r=[],o=[],t.__P&&((e=at({},s)).__v=s.__v+1,x.vnode&&x.vnode(e),Fe(t.__P,e,s,t.__n,t.__P.namespaceURI,32&s.__u?[i]:null,r,i??It(s),!!(32&s.__u),o),e.__v=s.__v,e.__.__k[e.__i]=e,Yn(r,e,o),e.__e!=i&&jn(e)));pe.__r=0}function Zn(n,t,e,s,i,r,o,a,l,u,f){var h,p,d,m,v,k,b=s&&s.__k||Fn,y=t.length;for(l=Zs(e,t,b,l,y),h=0;h<y;h++)(d=e.__k[h])!=null&&(p=d.__i===-1?jt:b[d.__i]||jt,d.__i=h,k=Fe(n,d,p,i,r,o,a,l,u,f),m=d.__e,d.ref&&p.ref!=d.ref&&(p.ref&&je(p.ref,null,d),f.push(d.ref,d.__c||m,d)),v==null&&m!=null&&(v=m),4&d.__u||p.__k===d.__k?l=Xn(d,l,n):typeof d.type=="function"&&k!==void 0?l=k:m&&(l=m.nextSibling),d.__u&=-7);return e.__e=v,l}function Zs(n,t,e,s,i){var r,o,a,l,u,f=e.length,h=f,p=0;for(n.__k=new Array(i),r=0;r<i;r++)(o=t[r])!=null&&typeof o!="boolean"&&typeof o!="function"?(l=r+p,(o=n.__k[r]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Bt(null,o,null,null,null):Me(o)?Bt(xt,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?Bt(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,a=null,(u=o.__i=Xs(o,e,l,h))!==-1&&(h--,(a=e[u])&&(a.__u|=2)),a==null||a.__v===null?(u==-1&&p--,typeof o.type!="function"&&(o.__u|=4)):u!=l&&(u==l-1?p--:u==l+1?p++:(u>l?p--:p++,o.__u|=4))):n.__k[r]=null;if(h)for(r=0;r<f;r++)(a=e[r])!=null&&!(2&a.__u)&&(a.__e==s&&(s=It(a)),Kn(a,a));return s}function Xn(n,t,e){var s,i;if(typeof n.type=="function"){for(s=n.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=n,t=Xn(s[i],t,e));return t}n.__e!=t&&(t&&n.type&&!e.contains(t)&&(t=It(n)),e.insertBefore(n.__e,t||null),t=n.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function me(n,t){return t=t||[],n==null||typeof n=="boolean"||(Me(n)?n.some(function(e){me(e,t)}):t.push(n)),t}function Xs(n,t,e,s){var i,r,o=n.key,a=n.type,l=t[e];if(l===null||l&&o==l.key&&a===l.type&&!(2&l.__u))return e;if(s>(l!=null&&!(2&l.__u)?1:0))for(i=e-1,r=e+1;i>=0||r<t.length;){if(i>=0){if((l=t[i])&&!(2&l.__u)&&o==l.key&&a===l.type)return i;i--}if(r<t.length){if((l=t[r])&&!(2&l.__u)&&o==l.key&&a===l.type)return r;r++}}return-1}function on(n,t,e){t[0]=="-"?n.setProperty(t,e??""):n[t]=e==null?"":typeof e!="number"||js.test(t)?e:e+"px"}function re(n,t,e,s,i){var r;t:if(t=="style")if(typeof e=="string")n.style.cssText=e;else{if(typeof s=="string"&&(n.style.cssText=s=""),s)for(t in s)e&&t in e||on(n.style,t,"");if(e)for(t in e)s&&e[t]===s[t]||on(n.style,t,e[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(Wn,"$1")),t=t.toLowerCase()in n||t=="onFocusOut"||t=="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),n.l||(n.l={}),n.l[t+r]=e,e?s?e.t=s.t:(e.t=We,n.addEventListener(t,r?De:Ee,r)):n.removeEventListener(t,r?De:Ee,r);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in n)try{n[t]=e??"";break t}catch{}typeof e=="function"||(e==null||e===!1&&t[4]!="-"?n.removeAttribute(t):n.setAttribute(t,t=="popover"&&e==1?"":e))}}function an(n){return function(t){if(this.l){var e=this.l[t.type+n];if(t.u==null)t.u=We++;else if(t.u<e.t)return;return e(x.event?x.event(t):t)}}}function Fe(n,t,e,s,i,r,o,a,l,u){var f,h,p,d,m,v,k,b,y,z,N,Z,X,C,G,B,H,U=t.type;if(t.constructor!==void 0)return null;128&e.__u&&(l=!!(32&e.__u),r=[a=t.__e=e.__e]),(f=x.__b)&&f(t);t:if(typeof U=="function")try{if(b=t.props,y="prototype"in U&&U.prototype.render,z=(f=U.contextType)&&s[f.__c],N=f?z?z.props.value:f.__:s,e.__c?k=(h=t.__c=e.__c).__=h.__E:(y?t.__c=h=new U(b,N):(t.__c=h=new st(b,N),h.constructor=U,h.render=Ks),z&&z.sub(h),h.props=b,h.state||(h.state={}),h.context=N,h.__n=s,p=h.__d=!0,h.__h=[],h._sb=[]),y&&h.__s==null&&(h.__s=h.state),y&&U.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=at({},h.__s)),at(h.__s,U.getDerivedStateFromProps(b,h.__s))),d=h.props,m=h.state,h.__v=t,p)y&&U.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),y&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(y&&U.getDerivedStateFromProps==null&&b!==d&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(b,N),!h.__e&&(h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(b,h.__s,N)===!1||t.__v==e.__v)){for(t.__v!=e.__v&&(h.props=b,h.state=h.__s,h.__d=!1),t.__e=e.__e,t.__k=e.__k,t.__k.some(function(Y){Y&&(Y.__=t)}),Z=0;Z<h._sb.length;Z++)h.__h.push(h._sb[Z]);h._sb=[],h.__h.length&&o.push(h);break t}h.componentWillUpdate!=null&&h.componentWillUpdate(b,h.__s,N),y&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(d,m,v)})}if(h.context=N,h.props=b,h.__P=n,h.__e=!1,X=x.__r,C=0,y){for(h.state=h.__s,h.__d=!1,X&&X(t),f=h.render(h.props,h.state,h.context),G=0;G<h._sb.length;G++)h.__h.push(h._sb[G]);h._sb=[]}else do h.__d=!1,X&&X(t),f=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++C<25);h.state=h.__s,h.getChildContext!=null&&(s=at(at({},s),h.getChildContext())),y&&!p&&h.getSnapshotBeforeUpdate!=null&&(v=h.getSnapshotBeforeUpdate(d,m)),a=Zn(n,Me(B=f!=null&&f.type===xt&&f.key==null?f.props.children:f)?B:[B],t,e,s,i,r,o,a,l,u),h.base=t.__e,t.__u&=-161,h.__h.length&&o.push(h),k&&(h.__E=h.__=null)}catch(Y){if(t.__v=null,l||r!=null)if(Y.then){for(t.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,t.__e=a}else for(H=r.length;H--;)Re(r[H]);else t.__e=e.__e,t.__k=e.__k;x.__e(Y,t,e)}else r==null&&t.__v==e.__v?(t.__k=e.__k,t.__e=e.__e):a=t.__e=Ys(e.__e,t,e,s,i,r,o,l,u);return(f=x.diffed)&&f(t),128&t.__u?void 0:a}function Yn(n,t,e){for(var s=0;s<e.length;s++)je(e[s],e[++s],e[++s]);x.__c&&x.__c(t,n),n.some(function(i){try{n=i.__h,i.__h=[],n.some(function(r){r.call(i)})}catch(r){x.__e(r,i.__v)}})}function Ys(n,t,e,s,i,r,o,a,l){var u,f,h,p,d,m,v,k=e.props,b=t.props,y=t.type;if(y=="svg"?i="http://www.w3.org/2000/svg":y=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((d=r[u])&&"setAttribute"in d==!!y&&(y?d.localName==y:d.nodeType==3)){n=d,r[u]=null;break}}if(n==null){if(y==null)return document.createTextNode(b);n=document.createElementNS(i,y,b.is&&b),a&&(x.__m&&x.__m(t,r),a=!1),r=null}if(y===null)k===b||a&&n.data===b||(n.data=b);else{if(r=r&&Qt.call(n.childNodes),k=e.props||jt,!a&&r!=null)for(k={},u=0;u<n.attributes.length;u++)k[(d=n.attributes[u]).name]=d.value;for(u in k)if(d=k[u],u!="children"){if(u=="dangerouslySetInnerHTML")h=d;else if(!(u in b)){if(u=="value"&&"defaultValue"in b||u=="checked"&&"defaultChecked"in b)continue;re(n,u,null,d,i)}}for(u in b)d=b[u],u=="children"?p=d:u=="dangerouslySetInnerHTML"?f=d:u=="value"?m=d:u=="checked"?v=d:a&&typeof d!="function"||k[u]===d||re(n,u,d,k[u],i);if(f)a||h&&(f.__html===h.__html||f.__html===n.innerHTML)||(n.innerHTML=f.__html),t.__k=[];else if(h&&(n.innerHTML=""),Zn(t.type==="template"?n.content:n,Me(p)?p:[p],t,e,s,y=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,o,r?r[0]:e.__k&&It(e,0),a,l),r!=null)for(u=r.length;u--;)Re(r[u]);a||(u="value",y=="progress"&&m==null?n.removeAttribute("value"):m!==void 0&&(m!==n[u]||y=="progress"&&!m||y=="option"&&m!==k[u])&&re(n,u,m,k[u],i),u="checked",v!==void 0&&v!==n[u]&&re(n,u,v,k[u],i))}return n}function je(n,t,e){try{if(typeof n=="function"){var s=typeof n.__u=="function";s&&n.__u(),s&&t==null||(n.__u=n(t))}else n.current=t}catch(i){x.__e(i,e)}}function Kn(n,t,e){var s,i;if(x.unmount&&x.unmount(n),(s=n.ref)&&(s.current&&s.current!==n.__e||je(s,null,t)),(s=n.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(r){x.__e(r,t)}s.base=s.__P=null}if(s=n.__k)for(i=0;i<s.length;i++)s[i]&&Kn(s[i],t,e||typeof n.type!="function");e||Re(n.__e),n.__c=n.__=n.__e=void 0}function Ks(n,t,e){return this.constructor(n,e)}function Js(n,t,e){var s,i,r,o;t==document&&(t=document.documentElement),x.__&&x.__(n,t),i=(s=!1)?null:t.__k,r=[],o=[],Fe(t,n=t.__k=de(xt,null,[n]),i||jt,jt,t.namespaceURI,i?null:t.firstChild?Qt.call(t.childNodes):null,r,i?i.__e:t.firstChild,s,o),Yn(r,n,o)}function Qs(n,t,e){var s,i,r,o,a=at({},n.props);for(r in n.type&&n.type.defaultProps&&(o=n.type.defaultProps),t)r=="key"?s=t[r]:r=="ref"?i=t[r]:a[r]=t[r]===void 0&&o!==void 0?o[r]:t[r];return arguments.length>2&&(a.children=arguments.length>3?Qt.call(arguments,2):e),Bt(n.type,a,s||n.key,i||n.ref,null)}function Ze(n){function t(e){var s,i;return this.getChildContext||(s=new Set,(i={})[t.__c]=this,this.getChildContext=function(){return i},this.componentWillUnmount=function(){s=null},this.shouldComponentUpdate=function(r){this.props.value!==r.value&&s.forEach(function(o){o.__e=!0,Ge(o)})},this.sub=function(r){s.add(r);var o=r.componentWillUnmount;r.componentWillUnmount=function(){s&&s.delete(r),o&&o.call(r)}}),e.children}return t.__c="__cC"+Rn++,t.__=n,t.Provider=t.__l=(t.Consumer=function(e,s){return e.children(s)}).contextType=t,t}Qt=Fn.slice,x={__e:function(n,t,e,s){for(var i,r,o;t=t.__;)if((i=t.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(n)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,s||{}),o=i.__d),o)return i.__E=i}catch(a){n=a}throw n}},qn=0,zn=function(n){return n!=null&&n.constructor==null},st.prototype.setState=function(n,t){var e;e=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=at({},this.state),typeof n=="function"&&(n=n(at({},e),this.props)),n&&at(e,n),n!=null&&this.__v&&(t&&this._sb.push(t),Ge(this))},st.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),Ge(this))},st.prototype.render=xt,gt=[],Bn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Un=function(n,t){return n.__v.__b-t.__v.__b},pe.__r=0,Wn=/(PointerCapture)$|Capture$/i,We=0,Ee=an(!1),De=an(!0),Rn=0;var ti=0;function c(n,t,e,s,i,r){t||(t={});var o,a,l=t;if("ref"in l)for(a in l={},t)a=="ref"?o=t[a]:l[a]=t[a];var u={type:n,props:l,key:e,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ti,__i:-1,__u:0,__source:i,__self:r};if(typeof n=="function"&&(o=n.defaultProps))for(a in o)l[a]===void 0&&(l[a]=o[a]);return x.vnode&&x.vnode(u),u}var kt,L,Ie,ln,Zt=0,Jn=[],O=x,cn=O.__b,un=O.__r,hn=O.diffed,fn=O.__c,dn=O.unmount,pn=O.__;function te(n,t){O.__h&&O.__h(L,n,Zt||t),Zt=0;var e=L.__H||(L.__H={__:[],__h:[]});return n>=e.__.length&&e.__.push({}),e.__[n]}function Ce(n){return Zt=1,ei(es,n)}function ei(n,t,e){var s=te(kt++,2);if(s.t=n,!s.__c&&(s.__=[e?e(t):es(void 0,t),function(a){var l=s.__N?s.__N[0]:s.__[0],u=s.t(l,a);l!==u&&(s.__N=[u,s.__[1]],s.__c.setState({}))}],s.__c=L,!L.__f)){var i=function(a,l,u){if(!s.__c.__H)return!0;var f=s.__c.__H.__.filter(function(p){return!!p.__c});if(f.every(function(p){return!p.__N}))return!r||r.call(this,a,l,u);var h=s.__c.props!==a;return f.forEach(function(p){if(p.__N){var d=p.__[0];p.__=p.__N,p.__N=void 0,d!==p.__[0]&&(h=!0)}}),r&&r.call(this,a,l,u)||h};L.__f=!0;var r=L.shouldComponentUpdate,o=L.componentWillUpdate;L.componentWillUpdate=function(a,l,u){if(this.__e){var f=r;r=void 0,i(a,l,u),r=f}o&&o.call(this,a,l,u)},L.shouldComponentUpdate=i}return s.__N||s.__}function He(n,t){var e=te(kt++,3);!O.__s&&Xe(e.__H,t)&&(e.__=n,e.u=t,L.__H.__h.push(e))}function Xt(n,t){var e=te(kt++,4);!O.__s&&Xe(e.__H,t)&&(e.__=n,e.u=t,L.__h.push(e))}function Nt(n){return Zt=5,Se(function(){return{current:n}},[])}function Qn(n,t,e){Zt=6,Xt(function(){if(typeof n=="function"){var s=n(t());return function(){n(null),s&&typeof s=="function"&&s()}}if(n)return n.current=t(),function(){return n.current=null}},e==null?e:e.concat(n))}function Se(n,t){var e=te(kt++,7);return Xe(e.__H,t)&&(e.__=n(),e.__H=t,e.__h=n),e.__}function ts(n){var t=L.context[n.__c],e=te(kt++,9);return e.c=n,t?(e.__==null&&(e.__=!0,t.sub(L)),t.props.value):n.__}function ni(){for(var n;n=Jn.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(he),n.__H.__h.forEach(Oe),n.__H.__h=[]}catch(t){n.__H.__h=[],O.__e(t,n.__v)}}O.__b=function(n){L=null,cn&&cn(n)},O.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),pn&&pn(n,t)},O.__r=function(n){un&&un(n),kt=0;var t=(L=n.__c).__H;t&&(Ie===L?(t.__h=[],L.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(he),t.__h.forEach(Oe),t.__h=[],kt=0)),Ie=L},O.diffed=function(n){hn&&hn(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(Jn.push(t)!==1&&ln===O.requestAnimationFrame||((ln=O.requestAnimationFrame)||si)(ni)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),Ie=L=null},O.__c=function(n,t){t.some(function(e){try{e.__h.forEach(he),e.__h=e.__h.filter(function(s){return!s.__||Oe(s)})}catch(s){t.some(function(i){i.__h&&(i.__h=[])}),t=[],O.__e(s,e.__v)}}),fn&&fn(n,t)},O.unmount=function(n){dn&&dn(n);var t,e=n.__c;e&&e.__H&&(e.__H.__.forEach(function(s){try{he(s)}catch(i){t=i}}),e.__H=void 0,t&&O.__e(t,e.__v))};var mn=typeof requestAnimationFrame=="function";function si(n){var t,e=function(){clearTimeout(s),mn&&cancelAnimationFrame(t),setTimeout(n)},s=setTimeout(e,100);mn&&(t=requestAnimationFrame(e))}function he(n){var t=L,e=n.__c;typeof e=="function"&&(n.__c=void 0,e()),L=t}function Oe(n){var t=L;n.__c=n.__(),L=t}function Xe(n,t){return!n||n.length!==t.length||t.some(function(e,s){return e!==n[s]})}function es(n,t){return typeof t=="function"?t(n):t}const ii={id:"wire",name:"Wire",category:"Conductors",prefix:"W",shapes:[["l",-15,15,15,-15]],pins:[["a",-15,15],["a",15,-15]],labels:[0,0,"cm"],device:null},ri={id:"g",name:"Ground",category:"Conductors",prefix:"G",shapes:[["l",0,0,0,15],["l",-20,15,20,15],["l",-10,20,10,20],["l",-5,25,5,25]],pins:[["a",0,0]],labels:[0,30,"ct"],device:null},oi={id:"p",name:"Port",category:"Conductors",prefix:"P",shapes:[["l",0,-15,0,0],["c",0,-25,10]],pins:[["a",0,0]],labels:[0,-40,"cb"],device:null},lt={wire:ii,ground:ri,port:oi};let _=class ns{static number(t){return{type:"number",...t}}static string(t){return{type:"string",...t}}static temp=ns.number({defaultValue:26.85,range:["real",">",-273.15],title:"device temperature in degrees Celsius"});schema=new Map;values=new Map;constructor(t){for(const[e,s]of Object.entries(t))this.schema.set(e,s)}names(){return[...this.schema.keys()]}prop(t){const e=this.schema.get(t);if(e==null){const s=this.names();throw new TypeError(`Unknown property [${t}]. Expected one of ${s.map(i=>`[${i}]`).join(", ")}.`)}return e}from(t){for(const[e,s]of t.values.entries())this.set(e,s)}hasAll(){for(const[t,e]of this.schema.entries())if(!this.values.has(t)&&e.defaultValue==null)return!1;return!0}has(t){return this.prop(t),this.values.has(t)}set(t,e){const s=this.prop(t);switch(s.type){case"number":{ai(s,t,e);break}case"string":{li(s,t,e);break}}return this.values.set(t,e),this}getNumber(t,e=null){const s=this.prop(t);if(s.type!=="number")throw new TypeError(`Property [${t}] is not a number.`);const i=this.values.get(t)??e??s.defaultValue;if(i==null)throw new TypeError(`Property [${t}] has no value.`);return i}getString(t,e=null){const s=this.prop(t);if(s.type!=="string")throw new TypeError(`Property [${t}] is not a string.`);const i=this.values.get(t)??e??s.defaultValue;if(i==null)throw new TypeError(`Property [${t}] has no value.`);return i}};function ai(n,t,e){if(typeof e!="number")throw new TypeError(`Invalid value for property [${t}]. Expected a number, got ${dt(e)}.`);const{range:s=["real"]}=n,[i,...r]=s;switch(i){case"real":if(!Number.isFinite(e))throw new TypeError(`Invalid value for property [${t}]. Not a finite value.`);break;case"integer":if(!Number.isInteger(e))throw new TypeError(`Invalid value for property [${t}]. Not an integer value.`);break}let o=0;for(;o<r.length;){const a=r[o++],l=r[o++];switch(a){case">":if(e<=l)throw new TypeError(`Invalid value for property [${t}]. Expected a value larger than ${l}, got ${dt(e)}.`);break;case">=":if(e<l)throw new TypeError(`Invalid value for property [${t}]. Expected a value larger than or equal to ${l}, got ${dt(e)}.`);break;case"<":if(e>=l)throw new TypeError(`Invalid value for property [${t}]. Expected a value less than ${l}, got ${dt(e)}.`);break;case"<=":if(e>l)throw new TypeError(`Invalid value for property [${t}]. Expected a value less than or equal to ${l}, got ${dt(e)}.`);break;case"<>":if(e===l)throw new TypeError(`Invalid value for property [${t}]. Expected a value not equal to ${l}.`);break}}}function li(n,t,e){if(typeof e!="string")throw new TypeError(`Invalid value for property [${t}]. Expected a string, got ${dt(e)}.`);const{range:s=[]}=n;if(s.length>0&&!s.includes(e))throw new TypeError(`Invalid value for property [${t}]. Expected one of ${s.map(i=>dt(i)).join(", ")}, got ${dt(e)}.`)}function dt(n){switch(typeof n){case"string":return`"${n}"`;case"number":return String(n)}return`[${n}]`}class ci{numSimulations=0;numIterations=0;reset(){this.numSimulations=0,this.numIterations=0}simulationStarted(){this.numSimulations+=1}simulationEnded(){}iterationStarted(){this.numIterations+=1}iterationEnded(){}toString(){return JSON.stringify(this,null,2)}toJSON(){const{numSimulations:t,numIterations:e}=this;return{numSimulations:t,numIterations:e}}}const et=new ci;function ui(n){return typeof n=="string"?n:n.symbol}function ee(n){return n+273.15}const hi=(n,t="")=>{if(!Number.isFinite(n)){if(n!==n)return"NaN";if(n===1/0)return"+Infinity";if(n===-1/0)return"-Infinity";throw new TypeError}const e=r=>String(Math.round(r*1e3)/1e3),s=ui(t),i=Math.abs(n);return i<1e-15?`0${s}`:i<1e-9?`${e(n*1e12)}p${s}`:i<1e-6?`${e(n*1e9)}n${s}`:i<.001?`${e(n*1e6)}μ${s}`:i<1?`${e(n*1e3)}m${s}`:i<1e3?`${e(n)}${s}`:i<1e6?`${e(n*.001)}k${s}`:i<1e9?`${e(n*1e-6)}M${s}`:`${e(n*1e-9)}G${s}`},fi=n=>{const t=[],e=[];let s={title:null,rows:[]};for(const i of n)t.push({probe:i,index:t.length});return new class{group(i){s.rows.length>0&&e.push(s),s={title:i,rows:[]}}capture(){const i=new Float64Array(t.length);for(const{index:r,probe:o}of t)i[r]=o.measure();s.rows.push(i)}build(){return s.rows.length>0&&e.push(s),s={title:null,rows:[]},{columns:t.map(({probe:{name:i,unit:r},index:o})=>({name:i,unit:r,index:o})),rowGroups:e}}}};class di{#t=new Map;on(t,e){let s=this.#t.get(t);return s==null&&this.#t.set(t,s=new Set),s.add(e),this}off(t,e){if(e!=null){let s=this.#t.get(t);s?.delete(e)}else this.#t.delete(t);return this}emit(t,e){const s=this.#t.get(t);if(s!=null)for(const i of s)i(e);return this}}const pi=Symbol(),mi=Symbol(),_i=Symbol();class ss extends di{props;sweeps;constructor(t){super(),this.props=new _(t),this.sweeps=[]}run(t){et.reset(),this.emit(pi,this);const e=fi(this.getProbes(t));let s=null;try{this.runImpl(t,e)}catch(i){s=i}if(s!=null)throw this.emit(_i,s),s;{const i=e.build();return this.emit(mi,i),i}}}class is extends Error{name="MathError";constructor(t,e){super(t,e)}}class St extends is{name="NumericOverflowError";constructor(t){super("Numeric overflow.",t)}}class Ye extends is{name="SingularMatrixError";constructor(t){super("Singular matrix.",t)}}function vi(n){const t=new Array(n);for(let e=0;e<n;e++)t[e]=pt(n);return t}function gi(n,t=0){for(const e of n)e.fill(t)}function pt(n){return new Float64Array(n)}function ft(n,t=0){n.fill(t)}function yt(n,t){t.set(n)}function yi(n){const t=new Int32Array(n);return rs(t),t}function rs(n){for(let t=0;t<n.length;t++)n[t]=t}function os(n,t,e){return bi(n,t,e,e)}function bi(n,t,e,s){let i=e,r=Math.abs(n[e][s]);for(e++;e<t;){const o=Math.abs(n[e][s]);o>r&&(i=e,r=o),e++}return i}function _e(n,t,e){const s=n[t];n[t]=n[e],n[e]=s}function wi(n){const{size:t,A:e,x:s,b:i}=n;for(let r=0;r<t-1;r++){n.findPivot(r);const o=e[r][r];if(o===0)throw new Ye;for(let a=r+1;a<t;a++){const l=e[a][r]/o;for(let u=r;u<t;u++)e[a][u]-=e[r][u]*l;i[a]-=i[r]*l}}for(let r=t-1;r>=0;r--){i[r]/=e[r][r];for(let o=r-1;o>=0;o--)i[o]-=e[o][r]*i[r]}yt(i,s)}function Vi(n){const{size:t,A:e,x:s,b:i}=n;for(let r=0;r<t;r++){n.findPivot(r);const o=e[r][r];if(o===0)throw new Ye;for(let a=r;a<t;a++)e[r][a]/=o;i[r]/=o;for(let a=0;a<t;a++)if(a!==r){const l=e[a][r];for(let u=r;u<t;u++)e[a][u]-=e[r][u]*l;i[a]-=i[r]*l}}yt(i,s)}function xi(n){const{size:t,A:e,perm:s}=n;for(let i=0;i<t;i++){Mi(e,s,t,i);const r=e[i][i];if(r===0)throw new Ye;for(let o=i+1;o<t;o++)e[i][o]/=r;for(let o=i+1;o<t;o++)for(let a=i+1;a<t;a++)e[o][a]-=e[o][i]*e[i][a]}}function ki(n){const{size:t,A:e,x:s,b:i,perm:r}=n;for(let o=0;o<t;o++){let a=0;for(let l=0;l<o;l++)a+=e[o][l]*s[l];s[o]=(i[r[o]]-a)/e[o][o]}for(let o=t-1;o>=0;o--){let a=0;for(let l=o+1;l<t;l++)a+=e[o][l]*i[l];i[o]=s[o]-a}yt(i,s)}function Mi(n,t,e,s){const i=os(n,e,s);i!==s&&(_e(n,s,i),_e(t,s,i))}var mt;(function(n){n.Gauss="gauss",n.GaussJordan="gauss-jordan",n.LU="lu"})(mt||(mt={}));class Ke{size;A;x;b;perm;constructor(t){this.size=t,this.A=vi(t),this.x=pt(t),this.b=pt(t),this.perm=yi(t)}clear(){gi(this.A),ft(this.x),ft(this.b),rs(this.perm)}solve(t){switch(t){case mt.Gauss:wi(this);break;case mt.GaussJordan:Vi(this);break;case mt.LU:xi(this),ki(this);break}}findPivot(t){const{size:e,A:s,b:i}=this,r=os(s,e,t);r!==t&&(_e(s,t,r),_e(i,t,r))}}class qt extends Error{name="CircuitError";constructor(t,e){super(t,e)}}class Ci{}class wt extends Ci{value;constructor(t){super(),this.value=t}eval(){return this.value}isConstant(){return!0}toString(){return String(this.value)}}class Hi{#t=new Map;constructor(){this.set("pi",new wt(Math.PI)),this.set("e",new wt(Math.E))}has(t){return this.#t.has(t)}get(t){const e=this.#t.get(t);if(e==null)throw new qt(`Unknown variable [${t}].`);return e}set(t,e){this.#t.set(t,e)}[Symbol.iterator](){return this.#t.keys()}}class Si{#t;#n;constructor(t){this.#t=t,this.#n=[]}setProps(){for(const t of this.#n)t.setProp(this.#t)}add(t){this.#n.push(t)}[Symbol.iterator](){return this.#n[Symbol.iterator]()}}let as=class{type="node";index;id;voltage=0;phase=0;constructor(t,e){this.index=t,this.id=e}toString(){return`Node[${this.id}]`}};class Ai{type="branch";index;a;b;current=0;phase=0;constructor(t,e,s){this.index=t,this.a=e,this.b=s}toString(){return`${this.a}~${this.b}`}}const Vt=new as(-1,"gnd");class ls{static propsSchema={temp:_.number({defaultValue:26.85,range:["real",">",-273.15],title:"default device temperature in degrees Celsius"})};#t=[];#n=new Map;#s=[];#e=new Map;#o=new Hi;#r=new Si(this.#o);temp;time;frequency;sourceFactor;constructor(){this.temp=0,this.time=0,this.frequency=0,this.sourceFactor=1}get groundNode(){return Vt}get nodes(){return this.#t}get devices(){return this.#s}get equations(){return this.#o}get bindings(){return this.#r}reset(){this.#o.set("temp",new wt(this.temp)),this.#o.set("time",new wt(this.time)),this.#o.set("frequency",new wt(this.frequency)),this.#r.setProps();for(const t of this.#t)switch(t.type){case"node":t.voltage=0,t.phase=0;break;case"branch":t.current=0,t.phase=0;break}for(const t of this.#s)t.state.fill(0),t.init(t.props,t.state)}makeNode(t){if(this.#n.has(t))throw new qt(`Duplicate node [${t}]`);const e=new as(this.#t.length,t);return this.#n.set(e.id,e),this.#t.push(e),e}makeBranch(t,e){const s=new Ai(this.#t.length,t,e);return this.#t.push(s),s}connect(t,e){const{id:s}=t;if(this.#e.has(s))throw new qt(`Duplicate device instance [${s}]`);this.#s.push(t),this.#e.set(t.id,t),t.connect(this,e)}getNode(t){const e=this.#n.get(t);if(e==null)throw new qt(`Unknown node [${t}]`);return e}getDevice(t){const e=this.#e.get(t);if(e==null)throw new qt(`Unknown device instance [${t}]`);return e}initDc(){for(const t of this.#s)t.initDc(t.props,t.state,this)}loadDc(t){for(const e of this.#s)e.loadDc(e.state,this,t)}endDc(){for(const t of this.#s)t.endDc(t.state,this)}initTr(){for(const t of this.#s)t.initTr(t.props,t.state,this)}loadTr(t){for(const e of this.#s)e.loadTr(e.state,this,t)}endTr(){for(const t of this.#s)t.endTr(t.state,this)}initAc(){for(const t of this.#s)t.initAc(t.props,t.state)}loadAc(t){for(const e of this.#s)e.loadAc(e.state,this.frequency,t)}endAc(){for(const t of this.#s)t.endAc(t.state)}}class q{static dummy=new class extends q{static id="DUMMY";static numTerminals=0;static propsSchema={};static stateSchema={length:0,ops:[]};constructor(){super("DUMMY")}};static id;static numTerminals;static propsSchema;static stateSchema;static linear=!0;static Dc=class extends q{initTr(e,s,i){this.initDc(e,s,i)}loadTr(e,s,i){this.loadDc(e,s,i)}endTr(e,s){this.endDc(e,s)}};id;props;state;diffs=[];constructor(t){this.id=t;const{propsSchema:e,stateSchema:s}=this.deviceClass;this.props=new _(e),this.state=new Float64Array(s.length)}get deviceClass(){return this.constructor}connect(t,e){}init(t,e){}initDc(t,e,s){}loadDc(t,e,s){}endDc(t,e){}initTr(t,e,s){}loadTr(t,e,s){}endTr(t,e){}initAc(t,e){}loadAc(t,e,s){}endAc(t){}}const _n=new Map([]);class W{name;reqArgs;optArgs;varArgs;fn;static add({name:t,reqArgs:e=1,optArgs:s=0,varArgs:i=!1,fn:r}){_n.set(t,new W(t,e,s,i,r))}static get(t){const e=_n.get(t);if(e==null)throw new TypeError(`Unknown function [${t}]`);return e}constructor(t,e,s,i,r){this.name=t,this.reqArgs=e,this.optArgs=s,this.varArgs=i,this.fn=r}call(t){const{name:e,reqArgs:s,optArgs:i,varArgs:r,fn:o}=this;if(s>t.length)throw new TypeError(`Too few arguments to function [${e}]`);if(!r&&s+i<t.length)throw new TypeError(`Too many arguments to function [${e}]`);return o(...t)}}W.add({name:"abs",fn:Math.abs});W.add({name:"sin",fn:Math.sin});W.add({name:"asin",fn:Math.asin});W.add({name:"cos",fn:Math.cos});W.add({name:"acos",fn:Math.acos});W.add({name:"tan",fn:Math.tan});W.add({name:"atan",fn:Math.atan});W.add({name:"exp",fn:Math.exp});W.add({name:"log",fn:Math.log});W.add({name:"log10",fn:Math.log10});W.add({name:"sqrt",fn:Math.sqrt});W.add({name:"pow",fn:Math.pow});W.add({name:"round",fn:Math.round});W.add({name:"floor",fn:Math.floor});W.add({name:"ceil",fn:Math.ceil});W.add({name:"min",reqArgs:2,varArgs:!0,fn:Math.min});W.add({name:"max",reqArgs:2,varArgs:!0,fn:Math.max});W.add({name:"dB",fn:n=>10*Math.log10(n)});class $i{A;b;constructor(t,e){this.A=t,this.b=e}stampA(t,e,s){if(!Number.isFinite(s))throw new St;t!==Vt&&e!==Vt&&(this.A[t.index][e.index]+=s)}stampB(t,e){if(!Number.isFinite(e))throw new St;t!==Vt&&(this.b[t.index]+=e)}stampConductance(t,e,s){this.stampA(t,t,s),this.stampA(t,e,-s),this.stampA(e,t,-s),this.stampA(e,e,s)}stampTransconductance(t,e,s,i,r){this.stampA(t,s,r),this.stampA(t,i,-r),this.stampA(e,s,-r),this.stampA(e,i,r)}stampVoltageSource(t,e,s,i){this.stampA(t,s,1),this.stampA(e,s,-1),this.stampA(s,t,1),this.stampA(s,e,-1),this.stampB(s,i)}stampCurrentSource(t,e,s){this.stampB(t,-s),this.stampB(e,s)}}class Ii{A;b;constructor(t,e){this.A=t,this.b=e}stampA(t,e,s,i){if(!Number.isFinite(s))throw new St;if(!Number.isFinite(i))throw new St;if(t!==Vt&&e!==Vt){const r=t.index*2,o=e.index*2;this.A[r][o]+=s,this.A[r][o+1]-=i,this.A[r+1][o]+=i,this.A[r+1][o+1]+=s}}stampB(t,e,s){if(!Number.isFinite(e))throw new St;if(!Number.isFinite(s))throw new St;if(t!==Vt){const i=t.index*2;this.b[i]+=e,this.b[i+1]+=s}}stampConductance(t,e,s,i){this.stampA(t,t,s,i),this.stampA(t,e,-s,-i),this.stampA(e,t,-s,-i),this.stampA(e,e,s,i)}stampTransconductance(t,e,s,i,r,o){this.stampA(t,s,r,o),this.stampA(t,i,-r,-o),this.stampA(e,s,-r,-o),this.stampA(e,i,r,o)}stampVoltageSource(t,e,s,i,r){this.stampA(t,s,1,0),this.stampA(e,s,-1,0),this.stampA(s,t,1,0),this.stampA(s,e,-1,0),this.stampB(s,i,r)}stampCurrentSource(t,e,s,i){this.stampB(t,-s,-i),this.stampB(e,s,i)}}class rt{modelId;deviceClass;props;constructor(t,e,s={}){this.modelId=t,this.deviceClass=e,this.props=new _(e.propsSchema);for(const[i,r]of Object.entries(s))this.props.set(i,r)}}const Ni=n=>new class{name="time";unit="s";measure(){return n.time}},Ti=n=>new class{name="frequency";unit="Hz";measure(){return n.frequency}},Li=n=>new class{name=`#${n.id}:V`;unit="V";measure(){return n.voltage}},Pi=n=>new class{name=`#${n.id}:phase`;unit="angle";measure(){return n.phase}},Ei=(n,t)=>new class{name=`${n.id}:${t.name}`;unit=t.unit;measure(){return n.state[t.index]}},cs=(n,t=!1)=>{const e=[];for(const s of n.nodes)switch(s.type){case"node":e.push(Li(s)),t&&e.push(Pi(s));break}return e},Di=n=>{const t=[];for(const e of n.devices)for(const s of e.deviceClass.stateSchema.ops)t.push(Ei(e,s));return t},Gi=n=>{const{length:t}=n,e=n[t-1];for(let s=t-1;s>0;s--)n[s]=n[s-1];n[0]=e};var $;(function(n){n.Euler="euler",n.Trapezoidal="trapezoidal",n.Gear="gear"})($||($={}));const qe=Symbol("tran"),zt=Symbol("index");class us{[qe];[zt];V=0;C=0;I=0;Geq=0;Ieq=0;diff(t,e){this[qe].diff(this,t,e)}}const hs=1,bt=6,Oi=(()=>{const n=new Array;for(let t=0;t<=bt+1;t++)n.push(new Ke(t));return n})();class qi{#t=[];#n=[];#s;#e;#o;#r;#a;#i;constructor(t=[]){for(let e=0;e<bt+1;e++)this.#n.push({time:0,delta:0,states:[]});this.#s=new Float64Array(bt+1),this.#e=0,this.setMethod($.Gear,bt);for(const{diffs:e}of t)this.register(e)}register(t){for(const e of t){e[qe]=this,e[zt]=this.#t.length,this.#t.push(e);for(const s of this.#n)s.states.push({V:0,C:0,I:0})}}setMethod(t,e){switch(t){case $.Euler:this.#o=$.Euler,this.#r=1;break;case $.Trapezoidal:this.#o=$.Trapezoidal,this.#r=2;break;case $.Gear:switch(e=Math.max(hs,Math.min(bt,e)),e){case 1:this.#o=$.Euler,this.#r=1;break;default:this.#o=$.Gear,this.#r=e;break}break}}nextStep(t,e){Gi(this.#n),this.#e+=1,this.#u(),this.#l(t,e)}#u(){switch(this.#o){case $.Euler:this.#a=$.Euler,this.#i=1;break;case $.Trapezoidal:this.#e<2?(this.#a=$.Euler,this.#i=1):(this.#a=$.Trapezoidal,this.#i=2);break;case $.Gear:this.#e<2?(this.#a=$.Euler,this.#i=1):(this.#a=$.Gear,this.#i=Math.min(this.#e,this.#r));break}}#l(t,e){switch(this.#n[0].time=t,this.#n[0].delta=e,this.#a){case $.Euler:{this.#s[0]=1/e,this.#s[1]=-1/e;break}case $.Trapezoidal:{this.#s[0]=2/e,this.#s[1]=-2/e;break}case $.Gear:{const s=Oi[this.#i+1],{A:i,x:r,b:o}=s;s.clear();for(let l=0;l<this.#i+1;l++)i[0][l]=1;let a=0;for(let l=0;l<this.#i;l++){a+=this.#n[l].delta;let u=1;for(let f=0;f<this.#i;f++)u*=a/this.#n[0].delta,i[f+1][l+1]=u}o[1]=-1/this.#n[0].delta,s.solve(mt.Gauss),this.#s.set(r);break}}}diff(t,e,s){switch(this.#a){case $.Euler:this.#d(t,e,s);break;case $.Trapezoidal:this.#f(t,e,s);break;case $.Gear:this.#p(t,e,s);break}}#d(t,e,s){const i=t[zt],o=this.#n[0].states[i],l=this.#n[1].states[i],u=this.#s[0]*s,f=this.#s[1]*l.V*l.C,h=this.#s[0]*s*e+f;t.V=o.V=e,t.C=o.C=s,t.I=o.I=h,t.Geq=u,t.Ieq=f}#f(t,e,s){const i=t[zt],o=this.#n[0].states[i],l=this.#n[1].states[i],u=this.#s[0]*s,f=this.#s[1]*l.V*l.C-l.I,h=this.#s[0]*s*e+f;t.V=o.V=e,t.C=o.C=s,t.I=o.I=h,t.Geq=u,t.Ieq=f}#p(t,e,s){const i=t[zt],o=this.#n[0].states[i],a=this.#s[0]*s;let l=0;for(let f=1;f<this.#i+1;f++){const p=this.#n[f].states[i];l+=this.#s[f]*p.V*p.C}const u=this.#s[0]*s*e+l;t.V=o.V=e,t.C=o.C=s,t.I=o.I=u,t.Geq=a,t.Ieq=l}}class zi{#t;#n;#s;constructor(t){this.#t=t,this.#n=new Ke(t.nodes.length*2),this.#s=new Ii(this.#n.A,this.#n.b)}solve(){et.simulationStarted(),this.#t.initAc(),et.iterationStarted(),this.#n.clear(),this.#t.loadAc(this.#s),this.#n.solve(mt.Gauss),this.#e(),et.iterationEnded(),this.#t.endAc(),et.simulationEnded()}#e(){for(const t of this.#t.nodes){const{index:e}=t,s=this.#n.x[e*2],i=this.#n.x[e*2+1];switch(t.type){case"node":t.voltage=vn(s,i),t.phase=gn(s,i);break;case"branch":t.current=vn(s,i),t.phase=gn(s,i);break}}}}function vn(n,t){return Math.sqrt(n*n+t*t)}function gn(n,t){return 180/Math.PI*Math.atan2(t,n)}class ot{id;static propsSchema={type:_.string({range:["lin","log"],title:"parameter sweep type"}),start:_.number({range:["real"],title:"parameter start value"}),stop:_.number({range:["real"],title:"parameter stop value"}),points:_.number({range:["integer",">",1],title:"number of points"})};static from(t,e){const s=new ot(t);return s.props.from(e),s}props=new _(ot.propsSchema);constructor(t){this.id=t}*[Symbol.iterator](){const{props:t}=this;yield*ot.iter(t)}static iter(t){const e=t.getString("type"),s=t.getNumber("start"),i=t.getNumber("stop"),r=t.getNumber("points");switch(e){case"lin":return ot.linIter(s,i,r);case"log":return ot.logIter(s,i,r);default:throw new TypeError}}static*linIter(t,e,s){const i=(e-t)/(s-1);for(let r=0;r<s;r++)yield t+r*i}static*logIter(t,e,s){const i=(Math.log(Math.abs(e))-Math.log(Math.abs(t)))/(s-1);for(let r=0;r<s;r++)yield t*Math.exp(r*i)}static walk(t,e){const{length:s}=t,i=[],r=o=>{if(o<s){const a=t[o];e.enter(a,o,i);for(const l of a)i.push({sweep:a,value:l}),e.set(a,l),r(o+1),i.pop();e.leave(a,o,i)}else e.end(i)};r(0)}}const fs=n=>{const t=({sweep:{id:e},value:s})=>`${e}=${hi(s)}`;return`"${n.map(t).join(", ")}"`};class ds extends ss{static propsSchema={...ls.propsSchema,type:_.string({range:["lin","log"],title:"frequency sweep type"}),start:_.number({range:["real",">",0],title:"start frequency"}),stop:_.number({range:["real",">",0],title:"stop frequency"}),points:_.number({range:["integer",">",1],title:"number of frequency points"})};constructor(){super(ds.propsSchema)}getProbes(t){return[Ti(t),...cs(t,!0)]}runImpl(t,e){const{props:s}=this,i=s.getNumber("temp"),r=ot.from("frequency",s),o=new zi(t);ot.walk(this.sweeps,{enter:(a,l,u)=>{},set:({id:a},l)=>{t.equations.set(a,new wt(l))},end:a=>{a.length>0&&e.group(fs(a));for(const l of r)t.temp=i,t.time=NaN,t.frequency=l,t.reset(),o.solve(),e.capture()},leave:(a,l,u)=>{}})}}class Bi extends Error{name="SimulationError";constructor(t,e){super(t,e)}}class Ui extends Bi{name="ConvergenceError";constructor(t,e){super(t,e)}}const Wi=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1],Ri=[.001,1e-4,1e-5,1e-6,1e-7,1e-8,1e-9,0];class yn{static propsSchema={abstol:_.number({defaultValue:1e-12,range:["real",">",0],title:"absolute current error tolerance in amperes"}),vntol:_.number({defaultValue:1e-6,range:["real",">",0],title:"absolute voltage error tolerance in volts"}),reltol:_.number({defaultValue:.001,range:["real",">",0],title:"relative error tolerance"}),maxIter:_.number({defaultValue:150,range:["integer",">",1],title:"maximum number of iterations"})};#t;#n;#s;#e;#o;#r;#a;#i;#u;#l;#d;#f;constructor(t,e){this.#t=t,this.#n=Fi(e),this.#s=new Ke(t.nodes.length),this.#e=pt(this.#s.size),this.#o=pt(this.#s.size),this.#r=pt(this.#s.size),this.#a=pt(this.#s.size),this.#i=pt(this.#s.size),this.#u=new $i(this.#s.A,this.#s.b),this.#l=0,this.#d=1,this.#f=0}solveDc(){this.#p=this.#w,this.#c=this.#S,this.#_=this.#A,et.simulationStarted(),this.#x(),et.simulationEnded()}solveTr(){this.#p=this.#$,this.#c=this.#V,this.#_=this.#I,et.simulationStarted(),this.#x(),et.simulationEnded()}#p;#c;#_;#w=()=>{this.#t.initDc()};#S=t=>{this.#t.loadDc(t)};#A=()=>{this.#t.endDc()};#$=()=>{this.#t.initTr()};#V=t=>{this.#t.loadTr(t)};#I=()=>{this.#t.endTr()};#x(){if(this.#C(),ft(this.#r),ft(this.#i),!this.#N()&&(this.#H(),ft(this.#r),ft(this.#i),!this.#g()&&(this.#H(),ft(this.#r),ft(this.#i),!this.#T())))throw new Ui("Simulation did not converge.")}#N(){return this.#l=0,this.#d=1,this.#f=0,this.#y(this.#n.maxIter)}#g(){for(const t of Wi)if(this.#l=1,this.#d=t,this.#f=0,!this.#y(this.#n.maxIter))return!1;return!0}#T(){for(const t of Ri)if(this.#l=2,this.#d=1,this.#f=t,!this.#y(this.#n.maxIter))return!1;return!0}#y(t){this.#t.sourceFactor=this.#d,this.#L();let e=0;for(;e<t;){this.#k();const s=e>0&&this.#b();if(yt(this.#o,this.#r),yt(this.#a,this.#i),s)return this.#P(),!0;e+=1}return!1}#L(){this.#p()}#k(){et.iterationStarted(),this.#s.clear(),this.#c(this.#u),this.#l===2&&this.#E(),yt(this.#s.b,this.#a),this.#s.solve(mt.Gauss),yt(this.#s.x,this.#o),this.#M(),et.iterationEnded()}#P(){this.#_()}#E(){for(let t=0;t<this.#s.size;t++)this.#s.A[t][t]+=this.#f}#b(){const{abstol:t,vntol:e,reltol:s}=this.#n;for(const i of this.#t.nodes){const{index:r}=i;switch(i.type){case"node":{const o=this.#r[r],a=this.#o[r];if(Math.abs(a-o)>=s*Math.abs(a)+e)return!1;const l=this.#i[r],u=this.#a[r];if(Math.abs(u-l)>=s*Math.abs(u)+t)return!1;break}case"branch":{const o=this.#r[r],a=this.#o[r];if(Math.abs(a-o)>=s*Math.abs(a)+t)return!1;const l=this.#i[r],u=this.#a[r];if(Math.abs(u-l)>=s*Math.abs(u)+e)return!1;break}}}return!0}#M(){for(const t of this.#t.nodes){const{index:e}=t;switch(t.type){case"node":t.voltage=this.#o[e];break;case"branch":t.current=this.#o[e];break}}}#C(){for(const t of this.#t.nodes){const{index:e}=t;switch(t.type){case"node":this.#e[e]=t.voltage;break;case"branch":this.#e[e]=t.current;break}}}#H(){for(const t of this.#t.nodes){const{index:e}=t;switch(t.type){case"node":t.voltage=this.#e[e];break;case"branch":t.current=this.#e[e];break}}}}function Fi(n){return{abstol:n.getNumber("abstol"),vntol:n.getNumber("vntol"),reltol:n.getNumber("reltol"),maxIter:n.getNumber("maxIter")}}class ps extends ss{static propsSchema={startTime:_.number({defaultValue:0,range:["real",">=",0],title:"simulation start time"}),stopTime:_.number({range:["real",">",0],title:"simulation stop time"}),timeStep:_.number({range:["real",">",0],title:"simulation time step"}),method:_.string({defaultValue:$.Gear,range:[$.Euler,$.Trapezoidal,$.Gear],title:"integration method"}),order:_.number({defaultValue:bt,range:["integer",">=",hs,"<=",bt],title:"integration order"}),dc:_.string({defaultValue:"yes",range:["yes","no"],title:"start with DC analysis"}),...ls.propsSchema,...yn.propsSchema};constructor(){super(ps.propsSchema)}getProbes(t){return[Ni(t),...cs(t),...Di(t)]}runImpl(t,e){const{props:s}=this,i=s.getNumber("startTime"),r=s.getNumber("stopTime"),o=s.getNumber("timeStep"),a=s.getString("method"),l=s.getNumber("order"),u=s.getString("dc"),f=s.getNumber("temp"),h=new yn(t,s);ot.walk(this.sweeps,{enter:(p,d,m)=>{},set:({id:p},d)=>{t.equations.set(p,new wt(d))},end:p=>{p.length>0&&e.group(fs(p)),t.temp=f,t.time=NaN,t.frequency=NaN,t.reset(),u==="yes"&&h.solveDc();const d=new qi(t.devices);d.setMethod(a,l);let m=0,v=0;for(;v<=r;)t.temp=f,t.time=v,t.frequency=NaN,d.nextStep(v,o),h.solveTr(),v>=i&&e.capture(),m+=1,v=o*m},leave:(p,d,m)=>{}})}}class ji extends q{static id="C";static numTerminals=2;static propsSchema={C:_.number({title:"capacitance",range:["real",">",0]}),V0:_.number({title:"initial voltage",defaultValue:0})};static stateSchema={length:4,ops:[{index:2,name:"V",unit:"V"},{index:3,name:"I",unit:"A"}]};diff=new us;na;nb;constructor(t){super(t),this.diffs.push(this.diff)}connect(t,[e,s]){this.na=e,this.nb=s}init(t,e){e[0]=t.getNumber("C"),e[1]=t.getNumber("V0")}endDc(t,e){const{na:s,nb:i}=this;t[2]=s.voltage-i.voltage,t[3]=0}loadTr(t,{time:e},s){const{diff:i,na:r,nb:o}=this,a=t[0],l=e>0?r.voltage-o.voltage:t[1];i.diff(l,a),t[2]=i.V,t[3]=i.I,s.stampConductance(r,o,i.Geq),s.stampCurrentSource(r,o,i.Ieq)}loadAc(t,e,s){const{na:i,nb:r}=this,o=t[0],a=2*Math.PI*e*o;s.stampConductance(i,r,0,a)}}class Zi extends q{static id="L";static numTerminals=2;static propsSchema={L:_.number({title:"inductance",range:["real",">",0]}),I0:_.number({title:"initial current",defaultValue:0})};static stateSchema={length:4,ops:[{index:2,name:"V",unit:"V"},{index:3,name:"I",unit:"A"}]};diff=new us;na;nb;branch;constructor(t){super(t),this.diffs.push(this.diff)}connect(t,[e,s]){this.na=e,this.nb=s,this.branch=t.makeBranch(this.na,this.nb)}init(t,e){e[0]=t.getNumber("L"),e[1]=t.getNumber("I0")}loadDc(t,e,s){const{na:i,nb:r,branch:o}=this;s.stampVoltageSource(i,r,o,0)}endDc(t,e){const{branch:s}=this;t[2]=0,t[3]=s.current}loadTr(t,{time:e},s){const{diff:i,na:r,nb:o,branch:a}=this,l=t[0],u=e>0?a.current:t[1];i.diff(u,l),t[2]=i.I,t[3]=i.V,s.stampA(a,a,-i.Geq),s.stampVoltageSource(r,o,a,i.Ieq)}loadAc(t,e,s){const{na:i,nb:r}=this,o=t[0],a=-1/(2*Math.PI*e*o);s.stampConductance(i,r,0,a)}}class Xi extends q.Dc{static id="R";static numTerminals=2;static propsSchema={R:_.number({title:"resistance",range:["real","<>",0]})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};na;nb;connect(t,[e,s]){this.na=e,this.nb=s}init(t,e){const s=t.getNumber("R");e[0]=1/s}loadDc(t,e,s){const{na:i,nb:r}=this,o=t[0];s.stampConductance(i,r,o)}endDc(t,e){const{na:s,nb:i}=this,r=t[0],o=s.voltage-i.voltage,a=o*r;t[1]=o,t[2]=a}loadAc(t,e,s){const{na:i,nb:r}=this,o=t[0];s.stampConductance(i,r,o,0)}}const Yi=ee(26.85),Ki=1602176634e-28,Ji=1380649e-29,Qi=3,tr=1.11,er=2/Math.PI,nr=Math.PI/2,tt=1e-12,ms="npn",_s="pnp",Je="nfet",Qe="pfet";function sr(n){switch(n){case ms:return 1;case _s:return-1}}function vs(n){switch(n){case Je:return 1;case Qe:return-1}}function $t(n,t,e){const s=n/Yi,i=e*n*(Ji/Ki),r=t*Math.pow(s,Qi/e)*Math.exp((s-1)*(tr/i)),o=i*Math.log(i/Math.sqrt(2)/r);return[i,r,o]}function Mt(n,t,e){if(n>=0){const s=1/e;return t*(Math.exp(s*n)-1)}else return 0}function Ct(n,t,e){if(n>=0){const s=1/e;return s*t*Math.exp(s*n)}else return 0}function Ht(n,t,e,s){if(n>=0&&n>s&&Math.abs(n-t)>2*e)if(t>0){const i=(n-t)/e;i>0?n=t+e*(2+Math.log(i-2)):n=t-e*(2+Math.log(2-i))}else n=s;return n}function oe(n,t){return Math.abs(n-t)>.5?n>t?t+.5:t-.5:n}class ve extends q.Dc{static id="BJT";static numTerminals=3;static propsSchema={polarity:_.string({range:[ms,_s],title:"transistor polarity"}),Bf:_.number({defaultValue:100,range:["real",">",0],title:"forward beta"}),Br:_.number({defaultValue:1,range:["real",">",0],title:"reverse beta"}),Is:_.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),Nf:_.number({defaultValue:1,range:["real",">",0],title:"forward emission coefficient"}),Nr:_.number({defaultValue:1,range:["real",">",0],title:"reverse emission coefficient"}),Vaf:_.number({defaultValue:10,range:["real",">=",0],title:"forward Early voltage"}),Var:_.number({defaultValue:0,range:["real",">=",0],title:"reverse Early voltage"}),temp:_.temp};static stateSchema={length:16,ops:[{index:8,name:"Vbe",unit:"V"},{index:9,name:"Vbc",unit:"V"},{index:10,name:"Vce",unit:"V"},{index:11,name:"Ie",unit:"A"},{index:12,name:"Ic",unit:"A"},{index:13,name:"Ib",unit:"A"}]};static linear=!1;ne;nb;nc;connect(t,[e,s,i]){this.ne=e,this.nb=s,this.nc=i}initDc(t,e,s){const i=t.getString("polarity"),r=t.getNumber("Bf"),o=t.getNumber("Br"),a=t.getNumber("Is"),l=t.getNumber("Nf"),u=t.getNumber("Nr"),f=ee(t.getNumber("temp",s.temp)),h=sr(i),p=r/(r+1),d=o/(o+1),[m,,v]=$t(f,a,l),[k,,b]=$t(f,a,u),[,y]=$t(f,a,1);e[0]=h,e[1]=p,e[2]=d,e[3]=y,e[4]=m,e[5]=k,e[6]=v,e[7]=b}eval(t,e){const{ne:s,nb:i,nc:r}=this,o=t[0],a=t[1],l=t[2],u=t[3],f=t[4],h=t[5],p=t[6],d=t[7];let m=o*(i.voltage-s.voltage),v=o*(i.voltage-r.voltage);e&&(m=Ht(m,o*t[8],f,p),v=Ht(v,o*t[9],h,d));const k=Mt(m,u,f),b=Mt(v,u,h),y=l*b-k,z=a*k-b,N=Ct(m,u,f)+tt,Z=Ct(v,u,h)+tt;t[8]=o*m,t[9]=o*v,t[10]=o*(m-v),t[11]=o*y,t[12]=o*z,t[13]=o*-(y+z),t[14]=N,t[15]=Z}loadDc(t,e,s){const{ne:i,nb:r,nc:o}=this;this.eval(t,!0);const a=t[0],l=t[1],u=t[2],f=a*t[8],h=a*t[9],p=a*t[11],d=a*t[12],m=t[14],v=t[15],k=-m,b=-v,y=u*v,z=l*m;s.stampConductance(i,r,-k),s.stampConductance(o,r,-b),s.stampTransconductance(i,r,o,r,-y),s.stampTransconductance(o,r,i,r,-z),s.stampCurrentSource(i,r,a*(p-k*f-y*h)),s.stampCurrentSource(o,r,a*(d-z*f-b*h))}endDc(t,e){this.eval(t,!1)}}class ne extends q.Dc{static id="Diode";static numTerminals=2;static propsSchema={Is:_.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:_.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:_.temp};static stateSchema={length:7,ops:[{index:4,name:"V",unit:"V"},{index:5,name:"I",unit:"A"}]};static linear=!1;na;nc;connect(t,[e,s]){this.na=e,this.nc=s}initDc(t,e,s){const i=t.getNumber("Is"),r=t.getNumber("N"),o=ee(t.getNumber("temp",s.temp)),[a,l,u]=$t(o,i,r);e[0]=l,e[2]=a,e[3]=u}eval(t,e){const{na:s,nc:i}=this,r=t[0],o=t[2],a=t[3];let l=s.voltage-i.voltage;e&&(l=Ht(l,t[4],o,a));const u=Mt(l,r,o),f=Ct(l,r,o)+tt;t[4]=l,t[5]=u,t[6]=f}loadDc(t,e,s){const{na:i,nc:r}=this;this.eval(t,!0);const o=t[4],a=t[5],l=t[6];s.stampConductance(i,r,l),s.stampCurrentSource(i,r,a-l*o)}endDc(t,e){this.eval(t,!1)}}class ge extends q.Dc{static id="JFET";static numTerminals=3;static propsSchema={polarity:_.string({range:[Je,Qe],title:"transistor polarity"}),Vth:_.number({defaultValue:-2,range:["real"],title:"threshold voltage"}),beta:_.number({defaultValue:1e-4,range:["real",">",0],title:"transconductance parameter"}),lambda:_.number({defaultValue:0,range:["real",">=",0],title:"channel-length modulation parameter"}),Is:_.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:_.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:_.temp};static stateSchema={length:17,ops:[{index:7,name:"Vgs",unit:"V"},{index:10,name:"Vgd",unit:"V"},{index:13,name:"Vds",unit:"V"},{index:14,name:"Ids",unit:"A"}]};static linear=!1;ns;ng;nd;connect(t,[e,s,i]){this.ns=e,this.ng=s,this.nd=i}initDc(t,e,s){const i=t.getString("polarity"),r=t.getNumber("Vth"),o=t.getNumber("beta"),a=t.getNumber("lambda"),l=t.getNumber("Is"),u=t.getNumber("N"),f=ee(t.getNumber("temp",s.temp)),h=vs(i),[p,d,m]=$t(f,l,u);e[0]=h,e[1]=r,e[2]=o,e[3]=a,e[4]=d,e[5]=p,e[6]=m}eval(t,e){const{ns:s,ng:i,nd:r}=this,o=t[0],a=t[1],l=t[2],u=t[3],f=t[4],h=t[5],p=t[6];let d=o*(i.voltage-s.voltage),m=o*(i.voltage-r.voltage);e&&(d=Ht(d,o*t[7],h,p),m=Ht(m,o*t[10],h,p));const v=d-m,k=Mt(d,f,h),b=Ct(d,f,h)+tt,y=Mt(m,f,h),z=Ct(m,f,h)+tt;let N,Z,X;if(d>=m){const C=d-a;if(C<=0)N=0,Z=tt,X=0;else{const G=u*v,B=l*(1+G);C<=v?(N=B*C*C,Z=l*u*C*C,X=2*B*C):(N=B*v*(2*C-v),Z=2*B*(C-v)+l*G*(2*C-v),X=2*B*v)}}else{const C=m-a;if(C<=0)N=0,Z=tt,X=0;else{const G=-v,B=u*G,H=l*(1+B);C<=G?(N=-H*C*C,Z=l*u*C*C+2*H*C,X=-2*H*C):(N=-H*G*(2*C-G),Z=2*H*C+l*B*(2*C-G),X=-2*H*G)}}t[7]=o*d,t[10]=o*m,t[13]=o*v,t[8]=o*k,t[9]=b,t[11]=o*y,t[12]=z,t[14]=o*N,t[15]=Z,t[16]=X}loadDc(t,e,s){const{ns:i,ng:r,nd:o}=this;this.eval(t,!0);const a=t[0],l=a*t[7],u=a*t[8],f=t[9],h=a*t[10],p=a*t[11],d=t[15],m=a*t[13],v=a*t[14],k=t[15],b=t[16];s.stampConductance(r,i,f),s.stampCurrentSource(r,i,a*(u-f*l)),s.stampConductance(r,o,d),s.stampCurrentSource(r,o,a*(p-d*h)),s.stampConductance(o,i,k),s.stampTransconductance(o,i,r,i,b),s.stampCurrentSource(o,i,a*(v-k*m-b*l))}endDc(t,e){this.eval(t,!1)}}class At extends q.Dc{static id="MOSFET";static numTerminals=4;static propsSchema={polarity:_.string({range:[Je,Qe],title:"transistor polarity"}),Vth:_.number({range:["real"],title:"threshold voltage"}),beta:_.number({defaultValue:.02,range:["real",">",0],title:"transconductance parameter"}),lambda:_.number({defaultValue:0,range:["real",">=",0],title:"channel-length modulation parameter"}),Is:_.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:_.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:_.temp};static stateSchema={length:19,ops:[{index:13,name:"Vgs",unit:"V"},{index:14,name:"Vgd",unit:"V"},{index:15,name:"Vds",unit:"V"},{index:16,name:"Ids",unit:"A"}]};static linear=!1;ns;ng;nd;nb;connect(t,[e,s,i,r]){this.ns=e,this.ng=s,this.nd=i,this.nb=r}initDc(t,e,s){const i=t.getString("polarity"),r=t.getNumber("Vth"),o=t.getNumber("beta"),a=t.getNumber("lambda"),l=t.getNumber("Is"),u=t.getNumber("N"),f=ee(t.getNumber("temp",s.temp)),h=vs(i),[p,d,m]=$t(f,l,u);e[0]=h,e[1]=r,e[2]=o,e[3]=a,e[4]=d,e[5]=p,e[6]=m}eval(t,e){const{ns:s,ng:i,nd:r,nb:o}=this,a=t[0],l=t[1],u=t[2],f=t[3],h=t[4],p=t[5],d=t[6];let m=a*(o.voltage-s.voltage),v=a*(o.voltage-r.voltage),k=t[13]=a*(i.voltage-s.voltage),b=t[14]=a*(i.voltage-r.voltage),y=k-b;e&&(m=Ht(m,a*t[7],p,d),v=Ht(v,a*t[10],p,d),y>0?(k=oe(k,a*t[13]),y=oe(k-b,a*t[15])):(b=oe(b,a*t[14]),y=oe(k-b,a*t[15])));const z=Mt(m,h,p),N=Ct(m,h,p)+tt,Z=Mt(v,h,p),X=Ct(v,h,p)+tt;let C,G,B;if(y>0){const H=k-a*l;if(H<=0)C=0,G=tt,B=0;else{const U=f*y,Y=u*(1+U);H<=y?(C=1/2*Y*H*H,G=1/2*u*f*H*H,B=Y*H):(C=Y*y*(H-y/2),G=Y*(H-y)+u*U*(H-y/2),B=Y*y)}}else{const H=b-a*l;if(H<=0)C=0,G=tt,B=0;else{const U=-y,Y=f*U,Ot=u*(1+Y);H<=U?(C=-.5*Ot*H*H,G=1/2*u*f*H*H,B=Ot*H):(C=-Ot*U*(H-U/2),G=Ot*H+u*Y*(H-U/2),B=Ot*U)}}t[7]=a*m,t[10]=a*v,t[13]=a*k,t[14]=a*b,t[15]=a*y,t[8]=a*z,t[9]=N,t[11]=a*Z,t[12]=X,t[16]=a*C,t[17]=G,t[18]=B}loadDc(t,e,s){const{ns:i,ng:r,nd:o,nb:a}=this;this.eval(t,!0);const l=t[0],u=l*t[7],f=l*t[10],h=l*t[13],p=l*t[14],d=l*t[15],m=l*t[8],v=t[9],k=l*t[11],b=t[12],y=l*t[16],z=t[17],N=t[18];s.stampConductance(a,i,v),s.stampCurrentSource(a,i,l*(m-v*u)),s.stampConductance(a,o,b),s.stampCurrentSource(a,o,l*(k-b*f)),d>0?(s.stampConductance(o,i,z),s.stampTransconductance(o,i,r,i,N),s.stampCurrentSource(o,i,l*(y-z*d-N*h))):(s.stampConductance(o,i,z),s.stampTransconductance(o,i,r,o,N),s.stampCurrentSource(o,i,l*(y-z*d-N*p)))}endDc(t,e){this.eval(t,!1)}}class ir extends q.Dc{static id="OpAmp";static numTerminals=3;static propsSchema={gain:_.number({defaultValue:1e6,range:["real",">",0],title:"gain"}),Vmax:_.number({defaultValue:15,range:["real",">",0],title:"maximum absolute value of output voltage"})};static stateSchema={length:5,ops:[{index:2,name:"Vin",unit:"V"},{index:3,name:"Vout",unit:"V"}]};static linear=!1;np;nn;no;branch;connect(t,[e,s,i]){this.np=e,this.nn=s,this.no=i,this.branch=t.makeBranch(this.no,t.groundNode)}init(t,e){const s=t.getNumber("gain"),i=t.getNumber("Vmax");e[0]=s,e[1]=i}loadDc(t,e,s){const{np:i,nn:r,no:o,branch:a}=this,l=t[0],u=t[1],f=i.voltage-r.voltage,h=nr*l*f/u,p=u*er*Math.atan(h),d=l/(1+h*h)+tt;t[2]=f,t[3]=p,t[4]=d,s.stampA(o,a,1),s.stampA(a,i,d),s.stampA(a,r,-d),s.stampA(a,o,-1),s.stampB(a,d*f-p)}}class rr extends q.Dc{static id="Ammeter";static numTerminals=2;static propsSchema={};static stateSchema={length:1,ops:[{index:0,name:"I",unit:"A"}]};np;nn;branch;connect(t,[e,s]){this.np=e,this.nn=s,this.branch=t.makeBranch(this.np,this.nn)}loadDc(t,e,s){const{np:i,nn:r,branch:o}=this;s.stampVoltageSource(i,r,o,0)}endDc(t,e){const{branch:s}=this;t[0]=s.current}}class or extends q.Dc{static id="Voltmeter";static numTerminals=2;static propsSchema={};static stateSchema={length:1,ops:[{index:0,name:"V",unit:"V"}]};np;nn;connect(t,[e,s]){this.np=e,this.nn=s}endDc(t,e){const{np:s,nn:i}=this;t[0]=s.voltage-i.voltage}}class Dc extends q.Dc{static id="CCCS";static numTerminals=4;static propsSchema={gain:_.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;ncp;ncn;branch;connect(t,[e,s,i,r]){this.np=e,this.nn=s,this.ncp=i,this.ncn=r,this.branch=t.makeBranch(this.ncp,this.ncn)}init(t,e){e[0]=t.getNumber("gain")}loadDc(t,e,s){const{np:i,nn:r,ncp:o,ncn:a,branch:l}=this,u=t[0];s.stampVoltageSource(o,a,l,0),s.stampA(i,l,u),s.stampA(r,l,-u)}endDc(t,e){const{np:s,nn:i,branch:r}=this,o=t[0],a=r.current*o,l=s.voltage-i.voltage;t[1]=a,t[2]=l}}class Gc extends q.Dc{static id="CCVS";static numTerminals=4;static propsSchema={gain:_.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;ncp;ncn;branch1;branch2;connect(t,[e,s,i,r]){this.np=e,this.nn=s,this.ncp=i,this.ncn=r,this.branch1=t.makeBranch(this.np,this.nn),this.branch2=t.makeBranch(this.ncp,this.ncn)}init(t,e){e[0]=t.getNumber("gain")}loadDc(t,e,s){const{np:i,nn:r,branch1:o,ncp:a,ncn:l,branch2:u}=this,f=t[0];s.stampVoltageSource(i,r,o,0),s.stampVoltageSource(a,l,u,0),s.stampA(o,u,-f)}endDc(t,e){const{np:s,nn:i,branch1:r}=this,o=s.voltage-i.voltage,a=r.current;t[1]=o,t[2]=a}}class Oc extends q{static id="Iac";static numTerminals=2;static propsSchema={I:_.number({title:"amplitude"}),f:_.number({title:"frequency"}),phase:_.number({title:"phase",defaultValue:0})};static stateSchema={length:5,ops:[{index:3,name:"I",unit:"A"},{index:4,name:"V",unit:"V"}]};np;nn;connect(t,[e,s]){this.np=e,this.nn=s}init(t,e){const s=t.getNumber("I"),i=t.getNumber("f"),r=t.getNumber("phase"),o=2*Math.PI*i,a=r/180*Math.PI;e[0]=s,e[1]=o,e[2]=a}endDc(t,e){t[3]=0,t[4]=0}loadTr(t,{time:e,sourceFactor:s},i){const{np:r,nn:o}=this,a=t[0],l=t[1],u=t[2],f=s*a*Math.sin(l*e+u);t[3]=f,i.stampCurrentSource(r,o,f)}endTr(t,e){const{np:s,nn:i}=this;t[4]=s.voltage-i.voltage}loadAc(t,e,s){const{np:i,nn:r}=this,o=t[0],a=t[2],l=o*Math.cos(a),u=o*Math.sin(a);s.stampCurrentSource(i,r,l,u)}}class ar extends q.Dc{static id="I";static numTerminals=2;static propsSchema={I:_.number({title:"current"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;connect(t,[e,s]){this.np=e,this.nn=s}init(t,e){e[0]=t.getNumber("I")}loadDc(t,{sourceFactor:e},s){const{np:i,nn:r}=this,o=t[0],a=e*o;t[1]=a,s.stampCurrentSource(i,r,a)}endDc(t,e){const{np:s,nn:i}=this;t[2]=s.voltage-i.voltage}}class qc extends q{static id="Vac";static numTerminals=2;static propsSchema={V:_.number({title:"amplitude"}),f:_.number({title:"frequency"}),phase:_.number({title:"phase",defaultValue:0})};static stateSchema={length:5,ops:[{index:3,name:"V",unit:"V"},{index:4,name:"I",unit:"A"}]};np;nn;branch;connect(t,[e,s]){this.np=e,this.nn=s,this.branch=t.makeBranch(this.np,this.nn)}init(t,e){const s=t.getNumber("V"),i=t.getNumber("f"),r=t.getNumber("phase"),o=2*Math.PI*i,a=r/180*Math.PI;e[0]=s,e[1]=o,e[2]=a}loadDc(t,e,s){const{np:i,nn:r,branch:o}=this;s.stampVoltageSource(i,r,o,0)}endDc(t,e){t[3]=0,t[4]=0}loadTr(t,{time:e,sourceFactor:s},i){const{np:r,nn:o,branch:a}=this,l=t[0],u=t[1],f=t[2],h=s*l*Math.sin(u*e+f);t[3]=h,i.stampVoltageSource(r,o,a,h)}endTr(t,e){const{branch:s}=this,i=s.current;t[4]=i}loadAc(t,e,s){const{np:i,nn:r,branch:o}=this,a=t[0],l=t[2],u=a*Math.cos(l),f=a*Math.sin(l);s.stampVoltageSource(i,r,o,u,f)}}class zc extends q.Dc{static id="VCCS";static numTerminals=4;static propsSchema={gain:_.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;ncp;ncn;branch;connect(t,[e,s,i,r]){this.np=e,this.nn=s,this.ncp=i,this.ncn=r,this.branch=t.makeBranch(this.np,this.nn)}init(t,e){e[0]=t.getNumber("gain")}loadDc(t,e,s){const{np:i,nn:r,ncp:o,ncn:a,branch:l}=this,u=t[0];s.stampA(i,l,1),s.stampA(r,l,-1),s.stampA(l,o,u),s.stampA(l,a,-u),s.stampA(l,l,-1)}endDc(t,e){const{np:s,nn:i,branch:r}=this;t[1]=r.current,t[2]=s.voltage-i.voltage}}class Bc extends q.Dc{static id="VCVS";static numTerminals=4;static propsSchema={gain:_.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;ncp;ncn;branch;connect(t,[e,s,i,r]){this.np=e,this.nn=s,this.ncp=i,this.ncn=r,this.branch=t.makeBranch(this.np,this.nn)}init(t,e){e[0]=t.getNumber("gain")}loadDc(t,e,s){const{np:i,nn:r,ncp:o,ncn:a,branch:l}=this,u=t[0];s.stampVoltageSource(i,r,l,0),s.stampA(l,o,-u),s.stampA(l,a,u)}endDc(t,e){const{np:s,nn:i,branch:r}=this;t[1]=s.voltage-i.voltage,t[2]=r.current}}class lr extends q.Dc{static id="V";static numTerminals=2;static propsSchema={V:_.number({title:"voltage"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;branch;connect(t,[e,s]){this.np=e,this.nn=s,this.branch=t.makeBranch(this.np,this.nn)}init(t,e){e[0]=t.getNumber("V")}loadDc(t,{sourceFactor:e},s){const{np:i,nn:r,branch:o}=this,a=t[0],l=e*a;t[1]=l,s.stampVoltageSource(i,r,o,l)}endDc(t,e){const{branch:s}=this;t[2]=s.current}}new rt("D",ne,{Is:1e-14,N:1}),new rt("NPN",ve,{polarity:"npn",Bf:100,Br:1,Is:1e-14,Nf:1,Nr:1,Vaf:10,Var:0}),new rt("PNP",ve,{polarity:"pnp",Bf:100,Br:1,Is:1e-14,Nf:1,Nr:1,Vaf:10,Var:0}),new rt("NFET",ge,{polarity:"nfet",Vth:-2,beta:1e-4,lambda:0,Is:1e-14,N:1}),new rt("PFET",ge,{polarity:"pfet",Vth:-2,beta:1e-4,lambda:0,Is:1e-14,N:1}),new rt("NMOS",At,{polarity:"nfet",Vth:2,beta:.02,lambda:0,Is:1e-14,N:1}),new rt("PMOS",At,{polarity:"pfet",Vth:-2,beta:.02,lambda:0,Is:1e-14,N:1}),new rt("DEPNMOS",At,{polarity:"nfet",Vth:-2,beta:.02,lambda:0,Is:1e-14,N:1}),new rt("DEPPMOS",At,{polarity:"pfet",Vth:2,beta:.02,lambda:0,Is:1e-14,N:1});const cr={id:"r",name:"Resistor",category:"Linear",prefix:"R",shapes:[["l",0,-30,0,-20],["l",-8,-20,8,-20],["l",-8,20,8,20],["l",-8,-20,-8,20],["l",8,-20,8,20],["l",0,30,0,20]],pins:[["a",0,-30],["b",0,30]],labels:[15,0,"lm"],device:Xi},ur={id:"c",name:"Capacitor",category:"Linear",prefix:"C",shapes:[["l",0,-30,0,-6],["l",-20,-6,20,-6],["l",-20,6,20,6],["l",0,30,0,6]],pins:[["a",0,-30],["b",0,30]],labels:[30,0,"lm"],device:ji},hr={id:"l",name:"Inductor",category:"Linear",prefix:"L",shapes:[["l",0,-30,0,-22],["a",0,-14,7,-90,90],["a",0,0,7,-90,90],["a",0,14,7,-90,90],["l",0,30,0,22]],pins:[["a",0,-30],["b",0,30]],labels:[15,0,"lm"],device:Zi},fe={resistor:cr,capacitor:ur,inductor:hr},Ae=(n,t,e,s,i=10)=>{const r=Math.atan2(s-t,e-n),o=r-Math.PI/6,a=r+Math.PI/6;return[["l",n,t,e,s],["l",e,s,e-i*Math.cos(o),s-i*Math.sin(o)],["l",e,s,e-i*Math.cos(a),s-i*Math.sin(a)]]},fr={id:"d",name:"Diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-15,-11,15,-11],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:ne},dr={id:"dz",name:"Zener diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-20,-5,-15,-11],["l",-15,-11,15,-11],["l",15,-11,20,-17],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:ne},pr={id:"ds",name:"Schottky diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-9,-17,-15,-17],["l",-15,-17,-15,-11],["l",-15,-11,15,-11],["l",15,-11,15,-5],["l",15,-5,9,-5],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:ne},mr={id:"dv",name:"Varicap diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-17],["l",-15,-17,15,-17],["l",-15,-11,15,-11],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:ne},_r={id:"npn",name:"NPN bipolar junction transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-20],["l",0,30,0,20],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",-20,-5,0,-20],...Ae(-20,5,0,20)],pins:[["c",0,-30],["e",0,30],["b",-30,0]],labels:[10,0,"lm"],device:ve},vr={id:"pnp",name:"PNP bipolar junction transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-20],["l",0,30,0,20],["l",-30,0,-20,0],["l",-20,-15,-20,15],...Ae(0,-20,-20,-5),["l",0,20,-20,5]],pins:[["e",0,-30],["c",0,30],["b",-30,0]],labels:[10,0,"lm"],device:ve},gr={id:"nfet",name:"N-channel junction field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,10],["l",-30,0,-12,0],["l",0,-10,-12,-10],["l",0,10,-12,10],["l",-12,-15,-12,15],["l",-21,-5,-15,0],["l",-21,5,-15,0]],pins:[["d",0,-30],["s",0,30],["g",-30,0]],labels:[10,0,"lm"],device:ge},yr={id:"pfet",name:"P-channel junction field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,10],["l",-30,0,-12,0],["l",0,-10,-12,-10],["l",0,10,-12,10],["l",-12,-15,-12,15],["l",-21,0,-15,-5],["l",-21,0,-15,5]],pins:[["s",0,-30],["d",0,30],["g",-30,0]],labels:[10,0,"lm"],device:ge},br={id:"nmos",name:"N-channel MOS field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,0],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",0,-10,-15,-10],["l",-15,-15,-15,-6],["l",0,0,-15,0],["l",-15,-3,-15,3],["l",-13,0,-8,-4],["l",-13,0,-8,4],["l",0,10,-15,10],["l",-15,15,-15,6]],pins:[["d",0,-30],["s",0,30],["g",-30,0]],labels:[10,0,"lm"],device:At},wr={id:"pmos",name:"P-channel MOS field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,0],["l",0,30,0,10],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",0,-10,-15,-10],["l",-15,-15,-15,-6],["l",0,0,-15,0],["l",-15,-3,-15,3],["l",-6,-4,-1,0],["l",-6,4,-1,0],["l",0,10,-15,10],["l",-15,15,-15,6]],pins:[["s",0,-30],["d",0,30],["g",-30,0]],labels:[10,0,"lm"],device:At},Vr={id:"opamp",name:"Operational amplifier",category:"Nonlinear",prefix:"OA",shapes:[["l",-50,-30,-30,-30],["l",-50,30,-30,30],["l",30,0,50,0],["l",-30,-50,30,0],["l",-30,50,30,0],["l",-30,-50,-30,50],["l",-25,-30,-15,-30],["l",-20,-35,-20,-25],["l",-25,30,-15,30]],pins:[["noninv",-50,-30],["inv",-50,30],["out",50,0]],labels:[-30,55,"lt"],device:ir},K={diode:fr,zener:dr,schottky:pr,varicap:mr,npn:_r,pnp:vr,nfet:gr,pfet:yr,nmos:br,pmos:wr,opamp:Vr},xr={id:"vmeter",name:"Voltmeter",category:"Probes",prefix:"Pr",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,30,0,20],["t",0,0,"cm","V"],...Ae(-25,25,25,-25)],pins:[["a",0,-30],["b",0,30]],labels:[25,0,"lm"],device:or},kr={id:"ameter",name:"Ammeter",category:"Probes",prefix:"Pr",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,30,0,20],["t",0,0,"cm","A"],...Ae(-25,25,25,-25)],pins:[["a",0,-30],["b",0,30]],labels:[25,0,"lm"],device:rr},Mr={vmeter:xr,ameter:kr},Cr={id:"vdc",name:"Ideal DC voltage source",category:"Sources",prefix:"V",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,-15,0,-5],["l",-5,-10,5,-10],["l",-5,10,5,10],["l",0,30,0,20]],pins:[["pos",0,-30],["neg",0,30]],labels:[25,0,"lm"],device:lr},Hr={id:"idc",name:"Ideal DC current source",category:"Sources",prefix:"I",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,10,0,-10],["l",0,-11,-5,-3],["l",0,-11,5,-3],["l",0,30,0,20]],pins:[["pos",0,-30],["neg",0,30]],labels:[25,0,"lm"],device:ar},Yt={vdc:Cr,idc:Hr};class Sr{#t=new Map;constructor(t){for(const e of t)this.#t.set(e.id,e)}[Symbol.iterator](){return this.#t.values()}get(t){const e=this.#t.get(t);if(e==null)throw new Error(`Unknown symbol [${t}]`);return e}}const gs=new Sr([...Object.values(lt),...Object.values(fe),...Object.values(K),...Object.values(Yt),...Object.values(Mr)]);var Ar=Symbol.for("preact-signals");function $e(){if(_t>1)_t--;else{for(var n,t=!1;Ut!==void 0;){var e=Ut;for(Ut=void 0,ze++;e!==void 0;){var s=e.o;if(e.o=void 0,e.f&=-3,!(8&e.f)&&bs(e))try{e.c()}catch(i){t||(n=i,t=!0)}e=s}}if(ze=0,_t--,t)throw n}}function $r(n){if(_t>0)return n();_t++;try{return n()}finally{$e()}}var I=void 0,Ut=void 0,_t=0,ze=0,ye=0;function ys(n){if(I!==void 0){var t=n.n;if(t===void 0||t.t!==I)return t={i:0,S:n,p:I.s,n:void 0,t:I,e:void 0,x:void 0,r:t},I.s!==void 0&&(I.s.n=t),I.s=t,n.n=t,32&I.f&&n.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=I.s,t.n=void 0,I.s.n=t,I.s=t),t}}function j(n){this.v=n,this.i=0,this.n=void 0,this.t=void 0}j.prototype.brand=Ar;j.prototype.h=function(){return!0};j.prototype.S=function(n){this.t!==n&&n.e===void 0&&(n.x=this.t,this.t!==void 0&&(this.t.e=n),this.t=n)};j.prototype.U=function(n){if(this.t!==void 0){var t=n.e,e=n.x;t!==void 0&&(t.x=e,n.e=void 0),e!==void 0&&(e.e=t,n.x=void 0),n===this.t&&(this.t=e)}};j.prototype.subscribe=function(n){var t=this;return ie(function(){var e=t.value,s=I;I=void 0;try{n(e)}finally{I=s}})};j.prototype.valueOf=function(){return this.value};j.prototype.toString=function(){return this.value+""};j.prototype.toJSON=function(){return this.value};j.prototype.peek=function(){var n=I;I=void 0;try{return this.value}finally{I=n}};Object.defineProperty(j.prototype,"value",{get:function(){var n=ys(this);return n!==void 0&&(n.i=this.i),this.v},set:function(n){if(n!==this.v){if(ze>100)throw new Error("Cycle detected");this.v=n,this.i++,ye++,_t++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{$e()}}}});function nt(n){return new j(n)}function bs(n){for(var t=n.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function ws(n){for(var t=n.s;t!==void 0;t=t.n){var e=t.S.n;if(e!==void 0&&(t.r=e),t.S.n=t,t.i=-1,t.n===void 0){n.s=t;break}}}function Vs(n){for(var t=n.s,e=void 0;t!==void 0;){var s=t.p;t.i===-1?(t.S.U(t),s!==void 0&&(s.n=t.n),t.n!==void 0&&(t.n.p=s)):e=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=s}n.s=e}function Et(n){j.call(this,void 0),this.x=n,this.s=void 0,this.g=ye-1,this.f=4}(Et.prototype=new j).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===ye))return!0;if(this.g=ye,this.f|=1,this.i>0&&!bs(this))return this.f&=-2,!0;var n=I;try{ws(this),I=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return I=n,Vs(this),this.f&=-2,!0};Et.prototype.S=function(n){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}j.prototype.S.call(this,n)};Et.prototype.U=function(n){if(this.t!==void 0&&(j.prototype.U.call(this,n),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};Et.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var n=this.t;n!==void 0;n=n.x)n.t.N()}};Object.defineProperty(Et.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var n=ys(this);if(this.h(),n!==void 0&&(n.i=this.i),16&this.f)throw this.v;return this.v}});function bn(n){return new Et(n)}function xs(n){var t=n.u;if(n.u=void 0,typeof t=="function"){_t++;var e=I;I=void 0;try{t()}catch(s){throw n.f&=-2,n.f|=8,tn(n),s}finally{I=e,$e()}}}function tn(n){for(var t=n.s;t!==void 0;t=t.n)t.S.U(t);n.x=void 0,n.s=void 0,xs(n)}function Ir(n){if(I!==this)throw new Error("Out-of-order effect");Vs(this),I=n,this.f&=-2,8&this.f&&tn(this),$e()}function se(n){this.x=n,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}se.prototype.c=function(){var n=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{n()}};se.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,xs(this),ws(this),_t++;var n=I;return I=this,Ir.bind(this,n)};se.prototype.N=function(){2&this.f||(this.f|=2,this.o=Ut,Ut=this)};se.prototype.d=function(){this.f|=8,1&this.f||tn(this)};function ie(n){var t=new se(n);try{t.c()}catch(e){throw t.d(),e}return t.d.bind(t)}var ks,Ne,Ms=[];ie(function(){ks=this.N})();function Dt(n,t){x[n]=t.bind(null,x[n]||function(){})}function be(n){Ne&&Ne(),Ne=n&&n.S()}function Cs(n){var t=this,e=n.data,s=Tr(e);s.value=e;var i=Se(function(){for(var a=t,l=t.__v;l=l.__;)if(l.__c){l.__c.__$f|=4;break}var u=bn(function(){var d=s.value.value;return d===0?0:d===!0?"":d||""}),f=bn(function(){return!zn(u.value)}),h=ie(function(){if(this.N=Hs,f.value){var d=u.value;a.base&&a.base.nodeType===3&&(a.base.data=d)}}),p=t.__$u.d;return t.__$u.d=function(){h(),p.call(this)},[f,u]},[]),r=i[0],o=i[1];return r.value?o.peek():o.value}Cs.displayName="_st";Object.defineProperties(j.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Cs},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});Dt("__b",function(n,t){if(typeof t.type=="string"){var e,s=t.props;for(var i in s)if(i!=="children"){var r=s[i];r instanceof j&&(e||(t.__np=e={}),e[i]=r,s[i]=r.peek())}}n(t)});Dt("__r",function(n,t){be();var e,s=t.__c;s&&(s.__$f&=-2,(e=s.__$u)===void 0&&(s.__$u=e=function(i){var r;return ie(function(){r=this}),r.c=function(){s.__$f|=1,s.setState({})},r}())),be(e),n(t)});Dt("__e",function(n,t,e,s){be(),n(t,e,s)});Dt("diffed",function(n,t){be();var e;if(typeof t.type=="string"&&(e=t.__e)){var s=t.__np,i=t.props;if(s){var r=e.U;if(r)for(var o in r){var a=r[o];a!==void 0&&!(o in s)&&(a.d(),r[o]=void 0)}else r={},e.U=r;for(var l in s){var u=r[l],f=s[l];u===void 0?(u=Nr(e,l,f,i),r[l]=u):u.o(f,i)}}}n(t)});function Nr(n,t,e,s){var i=t in n&&n.ownerSVGElement===void 0,r=nt(e);return{o:function(o,a){r.value=o,s=a},d:ie(function(){this.N=Hs;var o=r.value.value;s[t]!==o&&(s[t]=o,i?n[t]=o:o?n.setAttribute(t,o):n.removeAttribute(t))})}}Dt("unmount",function(n,t){if(typeof t.type=="string"){var e=t.__e;if(e){var s=e.U;if(s){e.U=void 0;for(var i in s){var r=s[i];r&&r.d()}}}}else{var o=t.__c;if(o){var a=o.__$u;a&&(o.__$u=void 0,a.d())}}n(t)});Dt("__h",function(n,t,e,s){(s<3||s===9)&&(t.__$f|=2),n(t,e,s)});st.prototype.shouldComponentUpdate=function(n,t){var e=this.__$u,s=e&&e.s!==void 0;for(var i in t)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var r=2&this.__$f;if(!(s||r||4&this.__$f)||1&this.__$f)return!0}else if(!(s||4&this.__$f)||3&this.__$f)return!0;for(var o in n)if(o!=="__source"&&n[o]!==this.props[o])return!0;for(var a in this.props)if(!(a in n))return!0;return!1};function Tr(n){return Se(function(){return nt(n)},[])}var Lr=function(n){queueMicrotask(function(){queueMicrotask(n)})};function Pr(){$r(function(){for(var n;n=Ms.shift();)ks.call(n)})}function Hs(){Ms.push(this)===1&&(x.requestAnimationFrame||Lr)(Pr)}const{round:g}=Math,Er=(n,t)=>n.x0<=t.x0&&t.x0<=n.x1&&n.y0<=t.y0&&t.y0<=n.y1||n.x0<=t.x0&&t.x0<=n.x1&&n.y0<=t.y1&&t.y1<=n.y1||n.x0<=t.x1&&t.x1<=n.x1&&n.y0<=t.y0&&t.y0<=n.y1||n.x0<=t.x1&&t.x1<=n.x1&&n.y0<=t.y1&&t.y1<=n.y1,Dr=(n,t)=>n.x0<=t.x0&&t.x0<=n.x1&&n.x0<=t.x1&&t.x1<=n.x1&&n.y0<=t.y0&&t.y0<=n.y1&&n.y0<=t.y1&&t.y1<=n.y1,Gr=["input","textarea","select","INPUT","TEXTAREA","SELECT"];function Ss(n){return n instanceof Element&&Gr.includes(n.tagName)}function Or(){const{activeElement:n}=document;Ss(n)&&n.blur()}const A={None:0,Shift:1,Alt:2,Control:4,Meta:8,of:n=>{let t=A.None;return n.shiftKey&&(t|=A.Shift),n.altKey&&(t|=A.Alt),n.ctrlKey&&(t|=A.Control),n.metaKey&&(t|=A.Meta),t}};function As(...n){const t=n.map(qr);return e=>{if(Ss(e.target))return!0;const s=A.of(e);for(const i of t)if((i.key==="any"||i.key===e.key||i.key===e.code)&&i.mod===s&&i.handler(e,s)!==!1)return e.preventDefault(),!0;return!1}}function qr([n,t]){let e="",s=A.None;const i=n.split("+");for(;i.length>0;){const r=i.shift();switch(r){case"Shift":s|=A.Shift;break;case"Alt":s|=A.Alt;break;case"Ctrl":s|=A.Control;break;case"Meta":s|=A.Meta;break;default:e=r;break}}return{key:e,mod:s,handler:t}}const P=4,E=2,D=1,zr=[P|E|D,P|D,P|E,P,0,E,D,E|D],Br=[P,P|E,P|D,P|E|D,E|D,D,E,0],Ur=[E,E|D,0,D,P|E,P|D|E,P,P|D],Wr=[D,0,E|D,E,P|D,P,P|E|D,P|E],Rr=(n,t)=>{switch(t){case"rl":return zr[n]??0;case"rr":return Br[n]??0;case"mx":return Ur[n]??0;case"my":return Wr[n]??0}return 0},Fr=(n,t)=>{let[e,s,i]=n,r=0;return t&P&&(r=s,s=-i,i=r),t&E&&(s=-s),t&D&&(i=-i),[e,s,i]},ct=n=>n.charAt(0),ut=n=>n.charAt(1),jr=(n,t)=>{let e=ct(n),s=ut(n);switch(t){case"mx":switch(e){case"l":e="r";break;case"r":e="l";break}break;case"my":switch(s){case"t":s="b";break;case"b":s="t";break}break}return`${e}${s}`},$s=(n,t)=>{if(t&P)switch(n){case"lt":n="rt";break;case"lm":n="ct";break;case"lb":n="lt";break;case"ct":n="rm";break;case"cb":n="lm";break;case"rt":n="rb";break;case"rm":n="cb";break;case"rb":n="lb";break}let e=ct(n),s=ut(n);if(t&E)switch(e){case"l":e="r";break;case"r":e="l";break}if(t&D)switch(s){case"t":s="b";break;case"b":s="t";break}return`${e}${s}`},Zr=(n,t)=>{switch(n[0]){case"l":return Xr(n,t);case"c":return Yr(n,t);case"a":return Kr(n,t);case"t":return Jr(n,t)}return n},Xr=(n,t)=>{let[e,s,i,r,o]=n,a=0;return t&P&&(a=s,s=-i,i=a,a=r,r=-o,o=a),t&E&&(s=-s,r=-r),t&D&&(i=-i,o=-o),[e,s,i,r,o]},Yr=(n,t)=>{let[e,s,i,r]=n,o=0;return t&P&&(o=s,s=-i,i=o),t&E&&(s=-s),t&D&&(i=-i),[e,s,i,r]},Kr=(n,t)=>{let[e,s,i,r,o,a]=n,l=0;return t&P&&(l=s,s=-i,i=l,o+=90,a+=90),t&E&&(s=-s,l=o,o=180-a,a=180-l),t&D&&(i=-i,l=o,o=-a,a=-l),[e,s,i,r,o,a]},Jr=(n,t)=>{let[e,s,i,r,o]=n;r=$s(r,t);let a=0;return t&P&&(a=s,s=-i,i=a),t&E&&(s=-s),t&D&&(i=-i),[e,s,i,r,o]},Qr=(n,t)=>{let[e,s,i]=n;i=$s(i,t);let r=0;return t&P&&(r=e,e=-s,s=r),t&E&&(e=-e),t&D&&(s=-s),[e,s,i]},Is=({shapes:n,pins:t},e,s)=>{const i={x:0,y:0},r={x:0,y:0};for(const o of n)switch(o[0]){case"l":{const[a,l,u,f,h]=o;i.x=Math.min(i.x,l,f),i.y=Math.min(i.y,u,h),r.x=Math.max(r.x,l,f),r.y=Math.max(r.y,u,h);break}case"c":{const[a,l,u,f]=o;i.x=Math.min(i.x,l-f,l+f),i.y=Math.min(i.y,u-f,u+f),r.x=Math.max(r.x,l-f,l+f),r.y=Math.max(r.y,u-f,u+f);break}case"a":{const[a,l,u,f,h,p]=o;i.x=Math.min(i.x,l-f,l+f),i.y=Math.min(i.y,u-f,l+f),r.x=Math.max(r.x,l-f,u+f),r.y=Math.max(r.y,u-f,u+f);break}}for(const[o,a,l]of t)i.x=Math.min(i.x,a),i.y=Math.min(i.y,l),r.x=Math.max(r.x,a),r.y=Math.max(r.y,l);return{x0:e+i.x,y0:s+i.y,x1:e+r.x,y1:s+r.y}};let to=0;function eo(){return to+=1}class no{#t=eo();get id(){return this.#t}}class wn{#t=new Map;[Symbol.iterator](){return this.#t.values()}append(t){for(const e of t)this.#t.set(e.id,e);return this}delete(t){for(const e of t)this.#t.delete(e);return this}}let en=class extends no{includes(t,e){const{x0:s,y0:i,x1:r,y1:o}=this.area;return s<=t&&t<=r&&i<=e&&e<=o}};class Ns{static anonymous(t){return`${t}?`}#t=new Map;constructor(t){for(const e of t)if(e instanceof ht){const s=this.#n(e.symbol.prefix);s.instances.push(e),s.names.add(e.name)}}getUniqueName(t){const e=this.#n(t);let s=1;for(;;){const i=`${t}${s}`;if(!e.names.has(i))return e.names.add(i),i;s+=1}}rename(t="none"){for(const[e,s]of this.#t.entries()){switch(t){case"none":break;case"horizontal":s.instances.sort((i,r)=>i.x-r.x||i.y-r.y);break;case"vertical":s.instances.sort((i,r)=>i.y-r.y||i.x-r.x);break}s.names.clear();for(const i of s.instances)i.name=this.getUniqueName(e)}}#n(t){let e=this.#t.get(t);return e==null&&this.#t.set(t,e={instances:[],names:new Set}),e}}function nn(){const n=()=>{throw new Error("unusable")};return new Proxy(Object.create(null),{apply:n,construct:n,defineProperty:n,deleteProperty:n,get:n,getOwnPropertyDescriptor:n,getPrototypeOf:n,has:n,isExtensible:n,ownKeys:n,preventExtensions:n,set:n,setPrototypeOf:n})}class Kt{static create({device:t}){const e=new Kt;return e.#t=new _(t?.propsSchema??{}),e}#t=Vn;constructor(){}setValue(t,e){return this.#t.set(t,e),this.#n()}import(t){return this.#n()}export(){return{}}#n(){const t=new Kt;return t.#t=this.#t,this.#t=Vn,t}}const Vn=nn();class ht extends en{#t;#n;#s;#e;#o;#r;#a=null;#i=null;#u=null;#l=null;constructor(t,e=Ns.anonymous(t.prefix),s=Kt.create(t),i=0,r=0,o=0){super(),this.#t=t,this.#n=e,this.#s=s,this.#e=i,this.#o=r,this.#r=o}get symbol(){return this.#t}get name(){return this.#n}set name(t){this.#n=t}get props(){return this.#s}set props(t){this.#s=t}get x(){return this.#e}get y(){return this.#o}get transform(){return this.#r}moveTo(t,e){this.#e=t,this.#o=e,this.#l=null}transformBy(t,e,s){const i=this.#e,r=this.#o;switch(t){case"rl":this.#e=e+(r-s),this.#o=s-(i-e);break;case"rr":this.#e=e-(r-s),this.#o=s+(i-e);break;case"mx":this.#e=2*e-i;break;case"my":this.#o=2*s-r;break}this.#r=Rr(this.#r,t),this.#a=null,this.#i=null,this.#u=null,this.#l=null}get area(){return this.#l??=Is(this,this.#e,this.#o)}get shapes(){return this.#a??=this.#t.shapes.map(t=>Zr(t,this.#r))}get pins(){return this.#i??=this.#t.pins.map(t=>Fr(t,this.#r))}get labels(){return this.#u??=Qr(this.#t.labels,this.#r)}}const so=(n,t)=>{switch(t){case"rl":switch(n){case"h":return"v";case"v":return"h"}break;case"rr":switch(n){case"h":return"v";case"v":return"h"}break}return n};class Gt extends en{#t;#n;#s;#e;#o;#r;#a;#i=null;constructor(t,e="lt",s="h",i=0,r=0){super(),this.#t=t.trim(),this.#n=e,this.#s=s,this.#e=i,this.#o=r,this.#r=0,this.#a=0,this.#i=null}get text(){return this.#t}set text(t){this.#t=t.trim(),this.#r=0,this.#a=0,this.#i=null}get align(){return this.#n}set align(t){this.#n=t,this.#i=null}get dir(){return this.#s}set dir(t){this.#s=t,this.#i=null}get x(){return this.#e}get y(){return this.#o}get width(){return this.#r}set width(t){this.#r=t,this.#i=null}get height(){return this.#a}set height(t){this.#a=t,this.#i=null}moveTo(t,e){this.#e=t,this.#o=e,this.#i=null}transformBy(t,e,s){const i=this.#e,r=this.#o;switch(t){case"rl":this.#e=e+(r-s),this.#o=s-(i-e);break;case"rr":this.#e=e-(r-s),this.#o=s+(i-e);break;case"mx":this.#e=2*e-i;break;case"my":this.#o=2*s-r;break}this.#n=jr(this.#n,t),this.#s=so(this.#s,t),this.#i=null}get area(){return this.#i??=this.#u()}#u(){let t=0,e=0,s=0,i=0;switch(this.#s){case"h":switch(ct(this.#n)){case"l":t=this.#e,s=this.#e+this.#r;break;case"c":t=this.#e-this.#r/2,s=this.#e+this.#r/2;break;case"r":t=this.#e-this.#r,s=this.#e;break}switch(ut(this.#n)){case"t":e=this.#o,i=this.#o+this.#a;break;case"m":e=this.#o-this.#a/2,i=this.#o+this.#a/2;break;case"b":e=this.#o-this.#a,i=this.#o;break}break;case"v":switch(ct(this.#n)){case"l":e=this.#o-this.#r,i=this.#o;break;case"c":e=this.#o-this.#r/2,i=this.#o+this.#r/2;break;case"r":e=this.#o,i=this.#o+this.#r;break}switch(ut(this.#n)){case"t":t=this.#e,s=this.#e+this.#a;break;case"m":t=this.#e-this.#a/2,s=this.#e+this.#a/2;break;case"b":t=this.#e-this.#a,s=this.#e;break}break}return{x0:t,y0:e,x1:s,y1:i}}}class R extends en{#t;#n;#s;#e;#o;constructor(t,e,s,i){super(),this.#t=t,this.#n=e,this.#s=s,this.#e=i,this.#o=null}get x0(){return this.#t}set x0(t){this.#t=t,this.#o=null}get y0(){return this.#n}set y0(t){this.#n=t,this.#o=null}get x1(){return this.#s}set x1(t){this.#s=t,this.#o=null}get y1(){return this.#e}set y1(t){this.#e=t,this.#o=null}get x(){return this.#t}get y(){return this.#n}moveTo(t,e){const s=this.#t,i=this.#n,r=this.#s,o=this.#e;this.#t=t,this.#n=e,this.#s=t+(r-s),this.#e=e+(o-i),this.#o=null}transformBy(t,e,s){const i=this.#t,r=this.#n,o=this.#s,a=this.#e;switch(t){case"rl":this.#t=e+(r-s),this.#n=s-(i-e),this.#s=e+(a-s),this.#e=s-(o-e);break;case"rr":this.#t=e-(r-s),this.#n=s+(i-e),this.#s=e-(a-s),this.#e=s+(o-e);break;case"mx":this.#t=2*e-i,this.#s=2*e-o;break;case"my":this.#n=2*s-r,this.#e=2*s-a;break}this.#o=null}get area(){return this.#o??={x0:Math.min(this.#t,this.#s),y0:Math.min(this.#n,this.#e),x1:Math.max(this.#t,this.#s),y1:Math.max(this.#n,this.#e)}}includes(t,e){if(this.#n===this.#e){const h=this.#n,p=Math.min(this.#t,this.#s),d=Math.max(this.#t,this.#s);return p<=t&&t<=d&&h-3<=e&&e<=h+3}if(this.#t===this.#s){const h=this.#t,p=Math.min(this.#n,this.#e),d=Math.max(this.#n,this.#e);return p<=e&&e<=d&&h-3<=t&&t<=h+3}const i=Math.abs((this.#e-this.#n)*t-(this.#s-this.#t)*e+this.#s*this.#n-this.#e*this.#t),r=Math.sqrt((this.#e-this.#n)*(this.#e-this.#n)+(this.#s-this.#t)*(this.#s-this.#t)),o=i/r,a=Math.min(this.#t,this.#s),l=Math.min(this.#n,this.#e),u=Math.max(this.#t,this.#s),f=Math.max(this.#n,this.#e);return a<=t&&t<=u&&l<=e&&e<=f&&o<=3}}function Te(n){return n===A.None?"l":n===A.Shift?"r":n===A.Alt?"d":"l"}function io(n,t,e,s,i){return n===e&&t===s?[]:i==="d"?[new R(n,t,e,s)]:t===s?[new R(n,t,e,s)]:n===e?[new R(n,t,e,s)]:i==="l"?[new R(n,t,e,t),new R(e,t,e,s)]:[new R(n,t,n,s),new R(n,s,e,s)]}function ro(n){const t=new oo,e=new ao;for(const i of n)if(i instanceof R){const{x0:r,y0:o,x1:a,y1:l}=i;if(o===l){t.addWire(o,i);continue}if(r===a){e.addWire(r,i);continue}continue}for(const i of n){if(i instanceof ht){for(const[r,o,a]of i.pins){const l=i.x+o,u=i.y+a;t.split(u,l,n),e.split(l,u,n)}continue}if(i instanceof R){const{x0:r,y0:o,x1:a,y1:l}=i;if(r===a&&o===l)continue;if(o===l){e.split(r,o,n),e.split(a,o,n);continue}if(r===a){t.split(o,r,n),t.split(l,r,n);continue}e.split(r,o,n),e.split(a,l,n),t.split(o,r,n),t.split(l,a,n);continue}}t.merge(),e.merge();let s=0;for(;s<n.length;){const i=n[s];if(i instanceof R){const{x0:r,y0:o,x1:a,y1:l}=i;if(r===a&&o===l){n.splice(s,1);continue}}s+=1}}class oo{lines=new Map;addWire(t,e){const{x0:s,x1:i}=e;e.x0=Math.min(s,i),e.x1=Math.max(s,i),e.y0=t,e.y1=t;let r=this.lines.get(t);r==null&&this.lines.set(t,r={wires:[],breakpoints:[]}),r.wires.push(e)}split(t,e,s){let i=this.lines.get(t);if(i!=null){i.breakpoints.push(e);for(const r of i.wires)if(r.x0<e&&e<r.x1){const o=new R(e,t,r.x1,t);s.push(o),i.wires.push(o),r.x1=e}}}merge(){for(const{wires:t,breakpoints:e}of this.lines.values()){t.sort((i,r)=>i.x0-r.x0);let s=1;for(;s<t.length;){const i=t[s-1],r=t[s],o=e.indexOf(i.x1),a=e.indexOf(r.x0);(o===-1||a===-1||o!==a)&&i.x1>=r.x0&&(r.x0=i.x0,r.x1=Math.max(i.x1,r.x1),i.x1=i.x0),s+=1}}}}class ao{lines=new Map;addWire(t,e){const{y0:s,y1:i}=e;e.y0=Math.min(s,i),e.y1=Math.max(s,i),e.x0=t,e.x1=t;let r=this.lines.get(t);r==null&&this.lines.set(t,r={wires:[],breakpoints:[]}),r.wires.push(e)}split(t,e,s){let i=this.lines.get(t);if(i!=null){i.breakpoints.push(e);for(const r of i.wires)if(r.y0<e&&e<r.y1){const o=new R(t,e,t,r.y1);s.push(o),i.wires.push(o),r.y1=e}}}merge(){for(const{wires:t,breakpoints:e}of this.lines.values()){t.sort((i,r)=>i.y0-r.y0);let s=1;for(;s<t.length;){const i=t[s-1],r=t[s],o=e.indexOf(i.y1),a=e.indexOf(r.y0);(o===-1||a===-1||o!==a)&&i.y1>=r.y0&&(r.y0=i.y0,r.y1=Math.max(i.y1,r.y1),i.y1=i.y0),s+=1}}}}function Jt(n){const t=[];for(const e of n){if(e instanceof ht){const{x:s,y:i,transform:r,symbol:o,name:a,props:l}=e;t.push(["i",s,i,r,o.id,a,l.export()])}if(e instanceof R){const{x0:s,y0:i,x1:r,y1:o}=e;t.push(["w",s,i,r,o])}if(e instanceof Gt){const{x:s,y:i,align:r,dir:o,text:a}=e;t.push(["n",s,i,r,o,a])}}return t}function Tt(n){const t=[];for(const e of n)switch(e[0]){case"i":{const[s,i,r,o,a,l,u]=e,f=gs.get(a);t.push(new ht(f,l,Kt.create(f).import(u),i,r,o));break}case"w":{const[s,i,r,o,a]=e;t.push(new R(i,r,o,a));break}case"n":{const[s,i,r,o,a,l]=e;t.push(new Gt(l,o,a,i,r));break}}return t}const ae=new class{#t=[];get full(){return this.#t.length>0}take(){return Tt(this.#t)}put(t){this.#t=Jt(t)}clear(){this.#t=[]}};function lo(n){const t=[];for(const e of n)e instanceof ht&&t.push(e);return t}function co(n){const t=[];for(const e of n)e instanceof R&&t.push(e);return t}function uo(n){const t=[];for(const e of n)e instanceof Gt&&t.push(e);return t}const Wt={instance:1,note:2,wire:4096,notWire:4095,all:65535};function xn(n,t,e,s=Wt.all){for(const i of n)if(s&ho(i)&&i.includes(t,e))return i;return null}function ho(n){switch(!0){case n instanceof ht:return Wt.instance;case n instanceof Gt:return Wt.note;case n instanceof R:return Wt.wire}return 0}class fo{#t;#n;#s;constructor(t,e,s){this.#t=t,this.#n=e,this.#s=s}get name(){return this.#t}get elements(){return this.#n}get pins(){return this.#s}}class po{#t;#n;#s;#e;constructor(t,e,s,i){this.#t=t,this.#n=e,this.#s=s,this.#e=i}get x(){return this.#t}get y(){return this.#n}get instance(){return this.#s}get name(){return this.#e}}function mo(){const n=[],t=[],e=[];return new class{get pins(){return n}get joins(){return t}get nodes(){return e}getWires(){return null}getPins(){return null}}}function _o(n){const t=[],e=[],s=[],i=new Map,r=new go(i,e,s);for(const o of n){if(o instanceof ht){for(const[a,l,u]of o.pins){const f=o.x+l,h=o.y+u,p=new po(f,h,o,a);t.push(p),r.addPin(p)}continue}o instanceof R&&r.addWire(o)}return r.connect(),new class{get pins(){return t}get joins(){return e}get nodes(){return s}getWires(o,a){return i.get(Rt(o,a))?.wires??null}getPins(o,a){return i.get(Rt(o,a))?.pins??null}}}const vo=new Set([Yt.vdc,Yt.idc,K.opamp,K.npn,K.pnp,K.nmos,K.pmos,K.nfet,K.pfet]);class go{cells;joins;nodes;names;constructor(t,e,s){this.cells=t,this.joins=e,this.nodes=s,this.names=new Set(["ground"])}addPin(t){this.getCell(t.x,t.y).pins.push(t)}addWire(t){this.getCell(t.x0,t.y0).wires.push(t),this.getCell(t.x1,t.y1).wires.push(t)}getCell(t,e){const s=Rt(t,e);let i=this.cells.get(s);return i==null&&this.cells.set(s,i={x:t,y:e,wires:[],pins:[],color:null}),i}connect(){this.connectGrounds(),this.connectPorts(),this.connectWithSuggestedNames();let t=1;for(const e of this.cells.values())e.pins.length>0&&e.color==null&&(this.walk([e],this.getColor(this.getUniqueName(`_n${t}`))),t+=1);for(const e of this.cells.values())e.wires.length+e.pins.length>2&&this.joins.push({x:e.x,y:e.y})}connectGrounds(){const t=this.getColor("ground");for(const e of this.cells.values())for(const s of e.pins)if(s.instance.symbol===lt.ground){if(t.elements.push(s.instance),e.color==null)this.walk([e],t);else if(e.color!==t){this.conflict(t,e);return}}}connectPorts(){const t=new Map;for(const e of this.cells.values())for(const s of e.pins)if(s.instance.symbol===lt.port){const{name:i}=s.instance;this.names.add(i);let r=t.get(i);if(r==null&&t.set(i,r=this.getColor(i)),r.elements.push(s.instance),e.color==null)this.walk([e],r);else if(e.color!==r){this.conflict(r,e);return}}}connectWithSuggestedNames(){for(const t of this.cells.values())for(const e of t.pins)if(vo.has(e.instance.symbol)&&t.color==null){const s=`_${e.instance.name}_${e.name}`;this.walk([t],this.getColor(this.getUniqueName(s)))}}conflict(t,e){console.warn(`Node naming conflict: [${t.node.name}] and [${e.color.node.name}]`),this.nodes.length=0}walk(t,e){for(;;){const s=t.pop();if(s==null)break;s.color=e;for(const i of s.wires){e.elements.push(i);const r=s.x===i.x1&&s.y===i.y1?Rt(i.x0,i.y0):Rt(i.x1,i.y1),o=this.cells.get(r);o!=null&&o.color==null&&t.push(o)}for(const i of s.pins)e.pins.push(i)}}getColor(t){const e=[],s=[],i=new fo(t,e,s);return this.nodes.push(i),{node:i,elements:e,pins:s}}getUniqueName(t){if(this.names.has(t)){let e=1;for(;;){let s=`${t}_${e}`;if(!this.names.has(s)){t=s;break}e+=1}}return this.names.add(t),t}}function Rt(n,t){return t+32768<<16|n+32768<<0}class vt{static create(t){const e=new vt;return e.#t=new bo(t),e}#t=Mn;#n=null;#s=null;#e=null;constructor(){}[Symbol.iterator](){return this.#t[Symbol.iterator]()}get instances(){return this.#n??=lo(this.#t)}get notes(){return this.#s??=uo(this.#t)}get wires(){return this.#e??=co(this.#t)}get network(){return this.#t.network}get names(){return this.#t.names}append(t){return this.#t.append(t),this.#o()}delete(t){return this.#t.delete(t),this.#o()}unwire(){return this.#t.unwire(),this.#o()}rewire(){return this.#t.rewire(),this.#o()}rename(t="none"){return this.#t.names.rename(t),this.#o()}edit(t){switch(t.type){case"set-note-text":{const{note:e,text:s}=t;e.text!==s&&(e.text=s);break}case"set-note-align":{const{note:e,align:s}=t;e.align!==s&&(e.align=s);break}case"set-note-dir":{const{note:e,dir:s}=t;e.dir!==s&&(e.dir=s);break}case"set-instance-prop":{const{instance:e,name:s,value:i}=t;e.props=e.props.setValue(s,i);break}}return this.#t.rewire(),this.#o()}#o(){const t=new vt;return t.#t=this.#t,this.#t=Mn,this.#n=null,this.#s=null,this.#e=null,t}}const yo={rewire:n=>{},connect:n=>mo()},kn={rewire:ro,connect:_o};let bo=class{#t;#n;#s;#e;constructor(t){this.#t=[],this.#n=kn,this.#s=null,this.#e=null,this.append(t)}[Symbol.iterator](){return this.#t[Symbol.iterator]()}get network(){return this.#s??=this.#n.connect(this.#t)}get names(){return this.#e??=new Ns(this.#t)}append(t){this.#t=[...new wn().append(this.#t).append(t)],this.#n.rewire(this.#t),this.#s=null,this.names.rename()}delete(t){this.#t=[...new wn().append(this.#t).delete(t)],this.#n.rewire(this.#t),this.#s=null,this.names.rename()}unwire(){this.#n=yo,this.#s=null}rewire(){this.#n=kn,this.#s=null}};const Mn=nn();class we{static create(t){const e=new we;return e.#t=new wo(t),e}#t=Cn;constructor(){}push(t,e){return this.#t.push(t,e),this.#n()}get canUndo(){return this.#t.canUndo}undo(){return[this.#t.undo(),this.#n()]}get canRedo(){return this.#t.canRedo}redo(){return[this.#t.redo(),this.#n()]}#n(){const t=new we;return t.#t=this.#t,this.#t=Cn,t}}class wo{#t;#n;constructor(t){this.#t=[[Jt(t),"initial"]],this.#n=0}get length(){return this.#t.length}push(t,e){this.#n+=1,this.#t.splice(this.#n),this.#t.push([Jt(t),e])}get canUndo(){return this.#n>0}undo(){this.canUndo&&(this.#n-=1);const[t]=this.#t[this.#n];return vt.create(Tt(t))}get canRedo(){return this.#n<this.#t.length-1}redo(){this.canRedo&&(this.#n+=1);const[t]=this.#t[this.#n];return vt.create(Tt(t))}}const Cn=nn();class Hn{#t;#n;constructor(t){this.#t=[...t],this.#n=[...t].map(e=>({element:e,x:e.x,y:e.y}))}get elements(){return this.#t}moveBy(t,e){for(const{element:s,x:i,y:r}of this.#n)s.moveTo(i+t,r+e)}reset(){for(const{element:t,x:e,y:s}of this.#n)t.moveTo(e,s)}}const Q=10,Vo=4,xo=30;class w{static defaultZoom=new w;#t;#n;#s;#e;static snap(t){return g(t/Q)*Q}static floor(t){return Math.floor(t/Q)*Q}static ceil(t){return Math.ceil(t/Q)*Q}constructor(t=Q,e=0,s=0){t=g(t),e=g(e),s=g(s),t=Math.max(Vo,t),t=Math.min(xo,t),this.#t=t,this.#n=e,this.#s=s,this.#e=t/Q}get gridSize(){return this.#t}get x(){return this.#n}get y(){return this.#s}get scale(){return this.#e}scaleTo(t){return new w(Q*t,this.#n,this.#s)}scaleBy(t){return new w(Q*(this.#e+t),this.#n,this.#s)}zoomTo(t){return new w(t,this.#n,this.#s)}zoomBy(t){return new w(this.#t+t,this.#n,this.#s)}moveTo(t,e){return new w(this.#t,t,e)}moveBy(t,e){return new w(this.#t,this.#n+t,this.#s+e)}toGridX(t){return g((t-this.#n)/this.#e)}toGridY(t){return g((t-this.#s)/this.#e)}toScreenX(t){return g(t*this.#e+this.#n)}toScreenY(t){return g(t*this.#e+this.#s)}snapScreenX(t){return this.toScreenX(w.snap(this.toGridX(t)))}snapScreenY(t){return this.toScreenY(w.snap(this.toGridY(t)))}static center(t,e,s,i=!1){const r=s.x1-s.x0,o=s.y1-s.y0;let a=w.defaultZoom;return i&&r>0&&o>0&&(a=a.scaleTo(Math.min(t/(r+Q*2),e/(o+Q*2)))),a.moveTo(t/2-(r/2+s.x0)*a.scale,e/2-(o/2+s.y0)*a.scale)}}nt(new w);const T={symbol:{normal:"#222222",selected:"#0000ff"},pin:{normal:"#222222",selected:"#0000ff"},pinFill:{normal:"#ffffff",selected:"#ffffff"},wire:{normal:"#222222",selected:"#0000ff"},outline:"#22222222",selection:"#0000ff11",gridFine:"#00000066",gridCoarse:"#000000FF",crosshair:"#0000FF66"},V=.5;class Ts{#t;#n;constructor(t){this.#t=t,this.#n=t.getContext("2d")}get canvas(){return this.#t}get ctx(){return this.#n}get width(){return this.#t.width}get height(){return this.#t.height}reset(){this.#n.reset()}paintGrid(t){const e=t.scale,s=t.x,i=t.y,r=t.gridSize,o=10,a=s%r,l=s%(r*o),u=i%r,f=i%(r*o);this.#e((h,p,d)=>{if(e>=1){h.strokeStyle=T.gridFine,h.lineWidth=1,h.lineCap="butt",h.setLineDash([1,r-1]);for(let m=u;m<d;m+=r)h.beginPath(),h.moveTo(a,m+V),h.lineTo(p,m+V),h.stroke()}}),this.#e((h,p,d)=>{h.strokeStyle=e>=1?T.gridCoarse:T.gridFine,h.lineWidth=1,h.lineCap="butt",h.setLineDash([1,r-1]);for(let m=f;m<d;m+=r*o)h.beginPath(),h.moveTo(a,m+V),h.lineTo(p,m+V),h.stroke();for(let m=l;m<p;m+=r*o)h.beginPath(),h.moveTo(m+V,u),h.lineTo(m+V,d),h.stroke()}),this.#e((h,p,d)=>{h.strokeStyle=T.gridFine,h.lineWidth=1,h.lineCap="butt",h.beginPath(),h.moveTo(g(s-10*e)+V,g(i)+V),h.lineTo(g(s+10*e)+V,g(i)+V),h.moveTo(g(s)+V,g(i-10*e)+V),h.lineTo(g(s)+V,g(i+10*e)+V),h.stroke()})}paintCrosshair(t,{x:e,y:s},i){this.#e((r,o,a)=>{i?(r.strokeStyle=T.crosshair,r.lineWidth=1,r.lineCap="butt"):(r.strokeStyle=T.outline,r.lineWidth=1,r.lineCap="butt"),r.beginPath(),r.moveTo(0,t.snapScreenY(s)+V),r.lineTo(o,t.snapScreenY(s)+V),r.moveTo(t.snapScreenX(e)+V,0),r.lineTo(t.snapScreenX(e)+V,a),r.stroke()})}paintSelection(t,e,s){this.#e(i=>{i.fillStyle=T.selection,i.fillRect(g(e.x),g(e.y),g(s.x-e.x),g(s.y-e.y))})}paintInstance(t,e,s=!1){const i=t.scale,r=t.x,o=t.y,a=e.x,l=e.y;this.#e(u=>{s?(u.fillStyle=T.symbol.selected,u.strokeStyle=T.symbol.selected,u.lineWidth=3,u.lineCap="square"):(u.fillStyle=T.symbol.normal,u.strokeStyle=T.symbol.normal,u.lineWidth=1,u.lineCap="square");for(const f of e.shapes)switch(f[0]){case"l":{const[h,p,d,m,v]=f;u.beginPath(),u.moveTo(g(r+(a+p)*i)+V,g(o+(l+d)*i)+V),u.lineTo(g(r+(a+m)*i)+V,g(o+(l+v)*i)+V),u.stroke();break}case"c":{const[h,p,d,m]=f;u.beginPath(),u.ellipse(g(r+(a+p)*i)+V,g(o+(l+d)*i)+V,g(m*i),g(m*i),0,0,2*Math.PI),u.stroke();break}case"a":{const[h,p,d,m,v,k]=f;u.beginPath(),u.ellipse(g(r+(a+p)*i)+V,g(o+(l+d)*i)+V,g(m*i),g(m*i),0,v*(Math.PI/180),k*(Math.PI/180)),u.stroke();break}case"t":{const[h,p,d,m,v]=f;this.#s(u,t,m),u.fillText(v,r+(a+p)*i,o+(l+d)*i);break}}})}paintPins(t,e,s=!1){const i=t.scale,r=t.x,o=t.y,a=e.x,l=e.y;this.#e(u=>{s?(u.fillStyle=T.pinFill.selected,u.strokeStyle=T.pin.selected,u.lineWidth=3,u.lineCap="square"):(u.fillStyle=T.pinFill.normal,u.strokeStyle=T.pin.normal,u.lineWidth=1,u.lineCap="square");for(const f of e.pins){const[h,p,d]=f;u.beginPath(),u.ellipse(g(r+(a+p)*i)+V,g(o+(l+d)*i)+V,g(3*i),g(3*i),0,0,2*Math.PI),u.fill(),u.stroke()}})}paintLabels(t,e,s=!1){const i=t.scale,r=t.x,o=t.y,a=e.x,l=e.y;this.#e(u=>{s?u.fillStyle=T.symbol.selected:u.fillStyle=T.symbol.normal;const[f,h,p]=e.labels;this.#s(u,t,p),u.fillText(e.name,r+(a+f)*i,o+(l+h)*i)})}paintWire(t,e,s=!1){const i=t.scale,r=t.x,o=t.y;this.#e(a=>{s?(a.strokeStyle=T.wire.selected,a.lineWidth=3,a.lineCap="square"):(a.strokeStyle=T.wire.normal,a.lineWidth=1,a.lineCap="square");const{x0:l,y0:u,x1:f,y1:h}=e;a.beginPath(),a.moveTo(g(r+l*i)+V,g(o+u*i)+V),a.lineTo(g(r+f*i)+V,g(o+h*i)+V),a.stroke()})}paintJoins(t,e){const s=t.scale,i=t.x,r=t.y;this.#e(o=>{o.fillStyle=T.wire.normal;for(const{x:a,y:l}of e)o.beginPath(),o.ellipse(g(i+a*s)+V,g(r+l*s)+V,g(3*s),g(3*s),0,0,2*Math.PI),o.fill()})}paintOrigin(t,{x:e,y:s},i){const r=t.scale,o=t.x,a=t.y;this.#e(l=>{i?(l.strokeStyle=T.symbol.selected,l.lineWidth=1,l.lineCap="butt"):(l.strokeStyle=T.outline,l.lineWidth=1,l.lineCap="butt"),l.beginPath(),l.moveTo(g(o+(e-10)*r)+V,g(a+s*r)+V),l.lineTo(g(o+(e+10)*r)+V,g(a+s*r)+V),l.moveTo(g(o+e*r)+V,g(a+(s-10)*r)+V),l.lineTo(g(o+e*r)+V,g(a+(s+10)*r)+V),l.stroke()})}paintArea(t,{x0:e,y0:s,x1:i,y1:r},o){const a=t.scale,l=t.x,u=t.y;this.#e(f=>{o?(f.strokeStyle=T.symbol.selected,f.lineWidth=1,f.lineCap="square"):(f.strokeStyle=T.outline,f.lineWidth=1,f.lineCap="square"),f.strokeRect(g(l+e*a)+V,g(u+s*a)+V,g((i-e)*a),g((r-s)*a))})}paintSymbolIcon(t,e,s){const i=Is(t,0,0),r=w.center(e,s,i,!0);this.paintInstance(r,{x:0,y:0,shapes:t.shapes})}#s(t,e,s){switch(t.font=`${20*e.scale}px serif`,ct(s)){case"l":t.textAlign="left";break;case"c":t.textAlign="center";break;case"r":t.textAlign="right";break}switch(ut(s)){case"t":t.textBaseline="top";break;case"m":t.textBaseline="middle";break;case"b":t.textBaseline="bottom";break}}#e=t=>{const e=this.#n;e.save(),t(e,this.#t.width,this.#t.height),e.restore()}}class F{#t;constructor(t=[]){this.#t=new Set;for(const{id:e}of t)this.#t.add(e)}[Symbol.iterator](){return this.#t[Symbol.iterator]()}get size(){return this.#t.size}get full(){return this.#t.size>0}has({id:t}){return this.#t.has(t)}filter(t){return[...t].filter(({id:e})=>this.#t.has(e))}select(t){return new F(t)}add(t){const e=new F;for(const s of this.#t)e.#t.add(s);for(const{id:s}of t)e.#t.add(s);return e}delete(t){const e=new F;for(const s of this.#t)e.#t.add(s);for(const{id:s}of t)e.#t.delete(s);return e}clear(){return new F}}function Ve(n,t){const e={x:1/0,y:1/0},s={x:-1/0,y:-1/0};for(const i of n)t||i instanceof R?(e.x=Math.min(e.x,i.area.x0),e.y=Math.min(e.y,i.area.y0),s.x=Math.max(s.x,i.area.x1),s.y=Math.max(s.y,i.area.y1)):(e.x=Math.min(e.x,i.x),e.y=Math.min(e.y,i.y),s.x=Math.max(s.x,i.x),s.y=Math.max(s.y,i.y));return e.x<=s.x&&e.y<=s.y?{x0:e.x,y0:e.y,x1:s.x,y1:s.y}:{x0:0,y0:0,x1:0,y1:0}}function ko(n,t){const e=Ve(n,!1);let s=0,i=0;switch(ct(t)){case"l":s=e.x0;break;case"c":s=w.snap((e.x0+e.x1)/2);break;case"r":s=e.x1;break}switch(ut(t)){case"t":i=e.y0;break;case"m":i=w.snap((e.y0+e.y1)/2);break;case"b":i=e.y1;break}for(const r of n)r.moveTo(r.x-s,r.y-i)}function Mo(n,t){const e=Ve(n,!1),s=w.snap((e.x0+e.x1)/2),i=w.snap((e.y0+e.y1)/2);for(const r of n)r.transformBy(t,s,i)}class Co{#t={current:null};#n;#s;#e;#o;#r;#a;#i;#u;#l;constructor(t,e){this.#n=t,this.#s=nt({showGrid:!0,showCrosshair:!0}),this.#e=nt(e),this.#o=nt(we.create(e)),this.#r=nt(new w),this.#a=nt(new F),this.#i=nt({type:"idle",cursor:{x:100,y:100},hovered:null});const s=o=>()=>{this.#r.value=this.#r.value.zoomBy(o)},i=(o,a)=>()=>{this.#r.value=this.#r.value.moveBy(o,a)},r=o=>()=>{this.pasteInstance(o)};this.#u=As(["Digit0",()=>{this.zoomTo("0")}],["Equal",s(1)],["Minus",s(-1)],["Home",()=>{this.zoomTo("1")}],["Space",()=>{this.zoomTo("all")}],["ArrowLeft",i(-10,0)],["Shift+ArrowLeft",i(-100,0)],["ArrowRight",i(10,0)],["Shift+ArrowRight",i(100,0)],["ArrowUp",i(0,-10)],["Shift+ArrowUp",i(0,-100)],["ArrowDown",i(0,10)],["Shift+ArrowDown",i(0,100)],["Ctrl+a",()=>{this.select("all")}],["Ctrl+x",()=>{this.selectionCut()}],["Ctrl+c",()=>{this.selectionCopy()}],["Ctrl+v",()=>{this.selectionPaste()}],["Delete",()=>{this.selectionDelete()}],["Ctrl+z",()=>{this.undo()}],["Ctrl+y",()=>{this.redo()}],["Alt+l",()=>{if(!this.transformSelection("rl"))return!1}],["Alt+r",()=>{if(!this.transformSelection("rr"))return!1}],["Alt+h",()=>{if(!this.transformSelection("mx"))return!1}],["Alt+v",()=>{if(!this.transformSelection("my"))return!1}],["Escape",()=>{if(!this.#h()){if(this.#a.value.full){this.#a.value=this.#a.value.clear();return}return!1}}],["w",()=>{if(this.#h(),!this.#k())return!1}],["g",r(lt.ground)],["o",r(lt.port)],["v",r(Yt.vdc)],["i",r(Yt.idc)],["r",r(fe.resistor)],["c",r(fe.capacitor)],["l",r(fe.inductor)],["d",r(K.diode)],["n",r(K.npn)],["p",r(K.pnp)],["Shift+N",r(K.nmos)],["Shift+P",r(K.pmos)],["a",r(K.opamp)],["t",()=>{this.pasteNote("")}])}get focusRef(){return this.#t}get library(){return this.#n}get settings(){return this.#s.value}get schematic(){return this.#e.value}get history(){return this.#o.value}get zoom(){return this.#r.value}get selection(){return this.#a.value}get mouseAction(){return this.#i.value}attach(t){this.#l=new Ts(t),this.#r.value=this.#D(!1)}handleFocus=t=>{this.#c()};handleBlur=t=>{this.#h(),this.#c()};handleKeyDown=t=>{this.#u(t)||this.#d(t)};handleKeyUp=t=>{this.#d(t)};#d(t){const{key:e}=t,s=A.of(t);if(e==="Shift"&&this.#C(e,s)){t.preventDefault();return}if(e==="Alt"&&this.#C(e,s)){t.preventDefault();return}if(e==="Shift"&&this.#S(e,s)){t.preventDefault();return}}handleMouseDown=t=>{Or();const e=t.button,s=A.of(t),i=this.#f(t);e===0&&s===A.None&&(this.#b(i,s)||this.#V(i,s)||this.#_(i))||e===0&&s===A.Shift&&(this.#b(i,s)||this.#V(i,s)||this.#_(i))||e===0&&s===A.Alt&&this.#b(i,s)||e===1&&s===A.None&&this.#O(i)};handleMouseMove=t=>{const e=A.of(t),s=this.#f(t);this.#P(s)||this.#M(s,e)||this.#I(s)||this.#T(s)||this.#w(s,e)||this.#q(s)||this.#i.value.type==="idle"&&this.#p(s)&&this.#c(s)};handleMouseUp=t=>{const e=this.#f(t);this.#H(e)||this.#x(e)||this.#y(e)||this.#A(e)||this.#c(e)};handleWheel=t=>{t.preventDefault();const e=A.of(t);if(this.#i.value.type==="idle"&&e===A.None){this.#r.value=this.#r.value.zoomBy(-Math.sign(t.deltaY));return}};handleContextMenu=t=>{t.preventDefault()};#f(t){return{x:t.offsetX,y:t.offsetY}}#p(t){const e=this.#r.value.toGridX(t.x),s=this.#r.value.toGridY(t.y),i=this.#r.value.toGridX(this.#i.value.cursor.x),r=this.#r.value.toGridY(this.#i.value.cursor.y);return w.snap(e)!==w.snap(i)||w.snap(s)!==w.snap(r)}#c(t=this.#i.value.cursor){const e=w.snap(this.#r.value.toGridX(t.x)),s=w.snap(this.#r.value.toGridY(t.y)),i=xn(this.#e.value,e,s,Wt.notWire);this.#i.value={type:"idle",cursor:t,hovered:i}}#_(t){return this.#i.value.type==="idle"?(this.#a.value=this.#a.value.clear(),this.#i.value={type:"select",cursor:{...t},origin:{...t}},!0):!1}#w(t,e){if(this.#i.value.type==="select"){const{origin:s}=this.#i.value,i={x0:this.#r.value.toGridX(Math.min(s.x,t.x)),y0:this.#r.value.toGridY(Math.min(s.y,t.y)),x1:this.#r.value.toGridX(Math.max(s.x,t.x)),y1:this.#r.value.toGridY(Math.max(s.y,t.y))};for(const r of this.#e.value)(e===A.Shift?Er(i,r.area):Dr(i,r.area))?this.#a.value=this.#a.value.add([r]):this.#a.value=this.#a.value.delete([r]);return this.#i.value={type:"select",cursor:t,origin:s},!0}return!1}#S(t,e){return this.#i.value.type==="select"?this.#w(this.#i.value.cursor,e):!1}#A(t){if(this.#i.value.type==="select"){const{origin:e}=this.#i.value;return t.x===e.x&&t.y===e.y&&(this.#a.value=this.#a.value.clear()),this.#c(t),!0}return!1}#$(){return this.#i.value.type==="select"?(this.#a.value=new F,this.#c(),!0):!1}#V(t,e){if(this.#i.value.type==="idle"){const s=xn(this.#e.value,this.#r.value.toGridX(t.x),this.#r.value.toGridY(t.y));if(s!=null){this.#a.value.has(s)||(this.#a.value=e===A.Shift?this.#a.value.add([s]):this.#a.value.select([s]));const i=Jt(this.#e.value),r=new Hn(this.#a.value.filter(this.#e.value));return this.#e.value=this.#e.value.unwire(),this.#i.value={type:"move",cursor:{...t},origin:{...t},undo:i,mover:r},!0}}return!1}#I(t){if(this.#i.value.type==="move"){if(this.#p(t)){const{origin:e,undo:s,mover:i}=this.#i.value,r=w.snap(this.#r.value.toGridX(e.x)),o=w.snap(this.#r.value.toGridY(e.y)),a=w.snap(this.#r.value.toGridX(t.x)),l=w.snap(this.#r.value.toGridY(t.y));i.moveBy(a-r,l-o),this.#e.value=this.#e.value.unwire(),this.#i.value={type:"move",cursor:t,origin:e,undo:s,mover:i}}return!0}return!1}#x(t){if(this.#i.value.type==="move"){const{origin:e,mover:s}=this.#i.value,i=w.snap(this.#r.value.toGridX(e.x)),r=w.snap(this.#r.value.toGridY(e.y)),o=w.snap(this.#r.value.toGridX(t.x)),a=w.snap(this.#r.value.toGridY(t.y));return s.moveBy(o-i,a-r),this.#e.value=this.#e.value.rewire(),(i!==o||r!==a)&&this.#m("move selection"),this.#c(t),!0}return!1}#N(){if(this.#i.value.type==="move"){const{undo:t}=this.#i.value;return this.#e.value=vt.create(Tt(t)),this.#a.value=new F,this.#c(),!0}return!1}#g(t){if(this.#i.value.type==="idle"){const{cursor:e}=this.#i.value;ko(t,"cm");const s=Jt(this.#e.value),i=new Hn(t),r=w.snap(this.#r.value.toGridX(e.x)),o=w.snap(this.#r.value.toGridY(e.y));return i.moveBy(r,o),this.#e.value=this.#e.value.unwire().append(t).rename(),this.#a.value=new F(t),this.#i.value={type:"paste",cursor:e,undo:s,mover:i},!0}return!1}#T(t){if(this.#i.value.type==="paste"){if(this.#p(t)){const{undo:e,mover:s}=this.#i.value,i=w.snap(this.#r.value.toGridX(t.x)),r=w.snap(this.#r.value.toGridY(t.y));s.moveBy(i,r),this.#e.value=this.#e.value.unwire(),this.#i.value={type:"paste",cursor:t,undo:e,mover:s}}return!0}return!1}#y(t){if(this.#i.value.type==="paste"){const{mover:e}=this.#i.value,s=w.snap(this.#r.value.toGridX(t.x)),i=w.snap(this.#r.value.toGridY(t.y));return e.moveBy(s,i),this.#e.value=this.#e.value.rewire(),this.#m("paste"),this.#c(t),!0}return!1}#L(){if(this.#i.value.type==="paste"){const{undo:t}=this.#i.value;return this.#e.value=vt.create(Tt(t)),this.#a.value=new F,this.#c(),!0}return!1}#k(){if(this.#i.value.type==="idle"){this.#a.value=this.#a.value.clear();const{cursor:t}=this.#i.value;return this.#i.value={type:"wire-start",cursor:t},!0}return!1}#P(t){return this.#i.value.type==="wire-start"?(this.#i.value={type:"wire-start",cursor:t},!0):!1}#E(){return this.#i.value.type==="wire-start"?(this.#c(),!0):!1}#b(t,e){return this.#i.value.type==="idle"&&this.#z(t)?(this.#a.value=this.#a.value.clear(),this.#i.value={type:"wire",cursor:{...t},origin:{...t},wires:[],shape:Te(e)},!0):this.#i.value.type==="wire-start"?(this.#i.value={type:"wire",cursor:{...t},origin:{...t},wires:[],shape:Te(e)},!0):!1}#M(t,e){if(this.#i.value.type==="wire"){const{origin:s}=this.#i.value,i=w.snap(this.#r.value.toGridX(s.x)),r=w.snap(this.#r.value.toGridY(s.y)),o=w.snap(this.#r.value.toGridX(t.x)),a=w.snap(this.#r.value.toGridY(t.y)),l=Te(e),u=io(i,r,o,a,l);return this.#i.value={type:"wire",cursor:t,origin:s,wires:u,shape:l},!0}return!1}#C(t,e){return this.#i.value.type==="wire"?this.#M(this.#i.value.cursor,e):!1}#H(t){return this.#i.value.type==="wire"?(this.#e.value=this.#e.value.append(this.#i.value.wires),this.#m("draw wires"),this.#c(t),!0):!1}#G(){return this.#i.value.type==="wire"?(this.#c(),!0):!1}#O(t){return this.#i.value.type==="idle"?(this.#i.value={type:"scroll",cursor:{...t},origin:{...t},offset:{x:this.#r.value.x,y:this.#r.value.y}},!0):!1}#q(t){if(this.#i.value.type==="scroll"){const{origin:e,offset:s}=this.#i.value;return this.#r.value=this.#r.value.moveTo(s.x+(t.x-e.x),s.y+(t.y-e.y)),this.#i.value={type:"scroll",cursor:t,origin:e,offset:s},!0}return!1}#h(){return!!(this.#E()||this.#G()||this.#N()||this.#L()||this.#$())}#z(t){const{network:e}=this.#e.value,s=this.#r.value.toGridX(t.x),i=this.#r.value.toGridY(t.y),r=w.snap(s),o=w.snap(i);return r-5<=s&&s<=r+5&&o-5<=i&&i<=o+5&&(e.getWires(r,o)!=null||e.getPins(r,o)!=null)}#D(t){return w.center(this.#l.width,this.#l.height,Ve(this.#e.peek(),!0),t)}#m(t){this.#o.value=this.#o.value.push(this.#e.value,t)}edit(t){this.#e.value=this.#e.value.edit(t)}transformSelection(t){if(this.#a.value.full){const e=this.#a.value.filter(this.#e.value);switch(Mo(e,t),this.#e.value=this.#e.value.rewire(),t){case"rl":this.#m("rotate counter-clockwise");break;case"rr":this.#m("rotate clockwise");break;case"mx":this.#m("flip from left to right");break;case"my":this.#m("flip from top to bottom");break}return!0}return!1}pasteInstance(t){this.focus(),this.#h(),t===lt.wire?this.#k():this.#g([new ht(t)])}pasteNote(t){this.focus(),this.#h(),this.#g([new Gt(t)])}undo(){if(this.#o.value.canUndo){this.#h();const[t,e]=this.#o.value.undo();this.#e.value=t,this.#o.value=e,this.#a.value=new F}}redo(){if(this.#o.value.canRedo){this.#h();const[t,e]=this.#o.value.redo();this.#e.value=t,this.#o.value=e,this.#a.value=new F}}select(t){switch(this.#h(),t){case"all":this.#a.value=new F(this.#e.value);break;case"none":this.#a.value=new F;break;case"invert":this.#a.value=new F([...this.#e.value].filter(e=>!this.#a.value.has(e)));break;default:this.#a.value=new F(t);break}}selectionCut(){this.#h(),this.#a.value.size>0&&(ae.put(this.#a.value.filter(this.#e.value)),this.#e.value=this.#e.value.delete(this.#a.value),this.#a.value=new F,this.#m("cut"))}selectionCopy(){this.#h(),this.#a.value.size>0&&ae.put(this.#a.value.filter(this.#e.value))}selectionPaste(){ae.full&&(this.#h(),this.#g(ae.take()))}selectionDelete(){this.#h(),this.#a.value.size>0&&(this.#e.value=this.#e.value.delete(this.#a.value),this.#a.value=new F,this.#m("delete"))}zoomTo(t){switch(t){case"+":this.#r.value=this.#r.value.zoomBy(1);break;case"-":this.#r.value=this.#r.value.zoomBy(-1);break;case"0":this.#r.value=new w().moveTo(20,20);break;case"1":this.#r.value=this.#D(!1);break;case"all":this.#r.value=this.#D(!0);break}}updateSettings(t){this.#s.value={...this.#s.value,...t}}focus(){this.#t.current?.focus()}blur(){this.#t.current?.blur()}get focused(){return this.#t.current?.focused??!1}paint(){const t=this.#s.peek(),e=this.#r.peek(),s=this.#i.peek();switch(this.#l.reset(),t.showGrid&&this.#l.paintGrid(e),s.type){case"idle":{this.#v(!1,s.hovered,!1),this.focused&&t.showCrosshair&&this.#l.paintCrosshair(e,s.cursor,!1);break}case"scroll":{this.#v(!1,null,!1);break}case"select":{this.#v(!1,null,!1),this.#l.paintSelection(e,s.origin,s.cursor);break}case"wire-start":{this.#v(!0,null,!1),this.#l.paintCrosshair(e,s.cursor,!0);break}case"wire":{this.#l.paintCrosshair(e,s.cursor,!0),this.#v(!0,null,!1);for(const i of s.wires)this.#l.paintWire(e,i,!0);break}case"move":case"paste":{this.#v(!0,null,!0);const i=Ve(s.mover.elements,!1),r=e.toScreenX(w.snap((i.x0+i.x1)/2)),o=e.toScreenY(w.snap((i.y0+i.y1)/2));this.#l.paintCrosshair(e,{x:r,y:o},!0);break}}}#v(t,e,s){const i=this.#e.peek(),r=this.#r.peek(),o=this.#a.peek();for(const a of i.instances)this.#l.paintInstance(r,a,o.has(a)),a.symbol!==lt.ground&&this.#l.paintLabels(r,a,o.has(a)),(a===e||s)&&(this.#l.paintArea(r,a.area,!1),this.#l.paintOrigin(r,a,!1));for(const a of i.notes)o.has(a)?(this.#l.paintArea(r,a.area,!0),this.#l.paintOrigin(r,a,!0)):(a===e||s)&&(this.#l.paintArea(r,a.area,!1),this.#l.paintOrigin(r,a,!1));for(const a of i.wires)this.#l.paintWire(r,a,o.has(a));for(const a of i.instances)(t||a===e)&&this.#l.paintPins(r,a,o.has(a));this.#l.paintJoins(r,i.network.joins)}}const Ls=Ze(null);function it(){return ts(Ls)}function Ps(n){var t,e,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(e=Ps(n[t]))&&(s&&(s+=" "),s+=e)}else for(e in n)n[e]&&(s&&(s+=" "),s+=e);return s}function Ho(){for(var n,t,e=0,s="",i=arguments.length;e<i;e++)(n=arguments[e])&&(t=Ps(n))&&(s&&(s+=" "),s+=t);return s}const So="_root_1813r_1",Ao="_item_1813r_9",$o="_selected_1813r_22";function Io(){const n=it(),{schematic:t,selection:e}=n;return c("ul",{class:So,children:t.instances.filter(({symbol:s})=>s!==lt.ground&&s!==lt.port).map(s=>c("li",{class:Ho(Ao,e.has(s)&&$o),onClick:()=>{n.select([s]),n.focus()},children:[s.symbol.id,":",s.name," (#",s.id,")"]},s.id))})}function Es({canvas:n,style:t,...e}){return c("canvas",{...e,ref:n,style:{display:"block",inlineSize:"100%",blockSize:"100%",...t}})}const Ds=n=>{const t=n.getContext("2d"),e=devicePixelRatio,{width:s,height:i}=n.getBoundingClientRect(),r=Math.max(1,s*e),o=Math.max(1,i*e);return(n.width!==r||n.height!==o)&&(n.width=r,n.height=o,t.scale(e,e)),{width:r,height:o}},No="_root_1ar66_1",To="_category_1ar66_5",Lo="_title_1ar66_10",Po="_list_1ar66_15",Eo="_symbol_1ar66_24";function Do(){const{library:n}=it(),t=Object.groupBy(n,({category:e})=>e);return c("div",{class:No,children:Object.entries(t).map(([e,s])=>c(Go,{name:e,symbols:s},e))})}function Go({name:n,symbols:t}){return c("div",{class:To,children:[c("div",{class:Lo,children:n}),c("div",{class:Po,children:t.map(e=>c(Oo,{symbol:e},e.id))})]})}function Oo({symbol:n}){const t=it(),e=Nt(null);return He(()=>{const{width:s,height:i}=Ds(e.current);new Ts(e.current).paintSymbolIcon(n,s,i)},[n]),c("div",{class:Eo,title:n.name,onClick:()=>{t.pasteInstance(n)},children:c(Es,{canvas:e})})}const qo="_root_k0zzy_1",zo="_item_k0zzy_9";function Bo(){const n=it(),{schematic:t}=n;return c("ul",{class:qo,children:t.network.nodes.map(e=>c("li",{class:zo,onClick:()=>{n.select(e.elements),n.focus()},children:e.name},e.name))})}function Gs({inputRef:n={current:null},type:t="text",value:e,onFocus:s,onBlur:i,onChange:r,...o}){const a=Nt(null);Qn(n,()=>({focus(){a.current.focus()},blur(){a.current.blur()},get focused(){return document.activeElement===a.current},select(){a.current.select()}}));const[l,u]=Ce(e);return t==="textarea"?c("textarea",{...o,ref:a,value:l,onInput:f=>{u(f.currentTarget.value)},onFocus:f=>{s?.(f)},onBlur:f=>{r(l),i?.(f)},onKeyDown:f=>{f.key==="Enter"&&A.of(f)===A.Control&&(f.preventDefault(),r(l))}}):c("input",{...o,ref:a,type:t,value:l,onInput:f=>{u(f.currentTarget.value)},onFocus:f=>{s?.(f)},onBlur:f=>{r(l),i?.(f)},onKeyDown:f=>{f.key==="Enter"&&A.of(f)===A.None&&(f.preventDefault(),r(l))}})}const Uo="_root_hzlci_1",Sn="_title_hzlci_8",Wo="_table_hzlci_13",Ro="_propName_hzlci_19",Fo="_propValue_hzlci_26",jo="_propTitle_hzlci_33",Zo="_input_hzlci_41";function Xo({instance:n}){const t=it(),{device:e}=n.symbol;return c("div",{class:Uo,children:[c("div",{class:Sn,children:n.symbol.name}),c("div",{class:Sn,children:["name: ",n.name]}),e!=null&&c("table",{class:Wo,children:c("tbody",{children:Object.entries(e.propsSchema).map(([s,i])=>c("tr",{children:[c("td",{class:Ro,children:s}),c("td",{class:Fo,children:c(Gs,{class:Zo,type:"text",value:String(i.defaultValue||"0"),onChange:r=>{t.edit({type:"set-instance-prop",instance:n,name:s,value:r})}})}),c("td",{class:jo,children:i.title})]}))})})]})}var Yo="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z",Ko="M11 2H13V7H21V10H13V14H18V17H13V22H11V17H6V14H11V10H3V7H11V2Z",Jo="M4 22H2V2H4V22M22 7H6V10H22V7M16 14H6V17H16V14Z",Qo="M20 2H22V22H20V2M2 10H18V7H2V10M8 17H18V14H8V17Z",ta="M22 22H2V20H22V22M10 2H7V18H10V2M17 8H14V18H17V8Z",ea="M22 11H17V6H14V11H10V3H7V11H1.8V13H7V21H10V13H14V18H17V13H22V11Z",na="M22 2V4H2V2H22M7 22H10V6H7V22M14 16H17V6H14V16Z",sa="M7,2H17A2,2 0 0,1 19,4V20A2,2 0 0,1 17,22H7A2,2 0 0,1 5,20V4A2,2 0 0,1 7,2M7,4V8H17V4H7M7,10V12H9V10H7M11,10V12H13V10H11M15,10V12H17V10H15M7,14V16H9V14H7M11,14V16H13V14H11M15,14V16H17V14H15M7,18V20H9V18H7M11,18V20H13V18H11M15,18V20H17V18H15Z",ia="M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M12 20C7.59 20 4 16.41 4 12S7.59 4 12 4 20 7.59 20 12 16.41 20 12 20M16.59 7.58L10 14.17L7.41 11.59L6 13L10 17L18 9L16.59 7.58Z",ra="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",oa="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z",aa="M19,3L13,9L15,11L22,4V3M12,12.5A0.5,0.5 0 0,1 11.5,12A0.5,0.5 0 0,1 12,11.5A0.5,0.5 0 0,1 12.5,12A0.5,0.5 0 0,1 12,12.5M6,20A2,2 0 0,1 4,18C4,16.89 4.9,16 6,16A2,2 0 0,1 8,18C8,19.11 7.1,20 6,20M6,8A2,2 0 0,1 4,6C4,4.89 4.9,4 6,4A2,2 0 0,1 8,6C8,7.11 7.1,8 6,8M9.64,7.64C9.87,7.14 10,6.59 10,6A4,4 0 0,0 6,2A4,4 0 0,0 2,6A4,4 0 0,0 6,10C6.59,10 7.14,9.87 7.64,9.64L10,12L7.64,14.36C7.14,14.13 6.59,14 6,14A4,4 0 0,0 2,18A4,4 0 0,0 6,22A4,4 0 0,0 10,18C10,17.41 9.87,16.86 9.64,16.36L12,14L19,21H22V20L9.64,7.64Z",la="M19,20H5V4H7V7H17V4H19M12,2A1,1 0 0,1 13,3A1,1 0 0,1 12,4A1,1 0 0,1 11,3A1,1 0 0,1 12,2M19,2H14.82C14.4,0.84 13.3,0 12,0C10.7,0 9.6,0.84 9.18,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V4A2,2 0 0,0 19,2Z",ca="M3.05,13H1V11H3.05C3.5,6.83 6.83,3.5 11,3.05V1H13V3.05C17.17,3.5 20.5,6.83 20.95,11H23V13H20.95C20.5,17.17 17.17,20.5 13,20.95V23H11V20.95C6.83,20.5 3.5,17.17 3.05,13M12,5A7,7 0 0,0 5,12A7,7 0 0,0 12,19A7,7 0 0,0 19,12A7,7 0 0,0 12,5Z",ua="M20.94 11C20.5 6.83 17.17 3.5 13 3.06V1H11V3.06C9.87 3.18 8.81 3.5 7.84 4.03L9.34 5.53C10.16 5.19 11.06 5 12 5C15.87 5 19 8.13 19 12C19 12.94 18.81 13.84 18.5 14.65L20 16.15C20.5 15.19 20.82 14.13 20.95 13H23V11H20.94M3 4.27L5.04 6.31C3.97 7.62 3.25 9.23 3.06 11H1V13H3.06C3.5 17.17 6.83 20.5 11 20.94V23H13V20.94C14.77 20.74 16.38 20.03 17.69 18.96L19.73 21L21 19.73L4.27 3L3 4.27M16.27 17.54C15.09 18.45 13.61 19 12 19C8.13 19 5 15.87 5 12C5 10.39 5.55 8.91 6.46 7.73L16.27 17.54Z",ha="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z",fa="M15 21H17V19H15M19 9H21V7H19M3 5V19C3 20.1 3.9 21 5 21H9V19H5V5H9V3H5C3.9 3 3 3.9 3 5M19 3V5H21C21 3.9 20.1 3 19 3M11 23H13V1H11M19 17H21V15H19M15 5H17V3H15M19 13H21V11H19M19 21C20.1 21 21 20.1 21 19H19Z",da="M3 15V17H5V15M15 19V21H17V19M19 3H5C3.9 3 3 3.9 3 5V9H5V5H19V9H21V5C21 3.9 20.1 3 19 3M21 19H19V21C20.1 21 21 20.1 21 19M1 11V13H23V11M7 19V21H9V19M19 15V17H21V15M11 19V21H13V19M3 19C3 20.1 3.9 21 5 21V19Z",pa="M20 18H4V8H20M20 6H12L10 4H4A2 2 0 0 0 2 6V18A2 2 0 0 0 4 20H20A2 2 0 0 0 22 18V8A2 2 0 0 0 20 6M14 9H16V13H19L15 17L11 13H14Z",ma="M13 19C13 19.34 13.04 19.67 13.09 20H4C2.9 20 2 19.11 2 18V6C2 4.89 2.89 4 4 4H10L12 6H20C21.1 6 22 6.89 22 8V13.81C21.39 13.46 20.72 13.22 20 13.09V8H4V18H13.09C13.04 18.33 13 18.66 13 19M20 18V15H18V18H15V20H18V23H20V20H23V18H20Z",_a="M20 18H4V8H20M20 6H12L10 4H4A2 2 0 0 0 2 6V18A2 2 0 0 0 4 20H20A2 2 0 0 0 22 18V8A2 2 0 0 0 20 6M16 17H14V13H11L15 9L19 13H16Z",va="M20.5,18L17.5,21V19H5V17H17.5V15L20.5,18M10.13,10H13.88L12,4.97L10.13,10M12.75,3L17.5,14H15.42L14.5,11.81H9.5L8.58,14H6.5L11.25,3H12.75Z",ga="M3 12V13.5L14 18.25V16.15L11.8 15.25V10.25L14 9.35V7.25L3 12M10 14.62L5 12.75L10 10.88V14.62M18 4.25L15 7.25H17V19.75H19V7.25H21L18 4.25Z",ya="M10,4V8H14V4H10M16,4V8H20V4H16M16,10V14H20V10H16M16,16V20H20V16H16M14,20V16H10V20H14M8,20V16H4V20H8M8,14V10H4V14H8M8,8V4H4V8H8M10,14H14V10H10V14M4,2H20A2,2 0 0,1 22,4V20A2,2 0 0,1 20,22H4C2.92,22 2,21.1 2,20V4A2,2 0 0,1 4,2Z",ba="M0,2.77L1.28,1.5L22.5,22.72L21.23,24L19.23,22H4C2.92,22 2,21.1 2,20V4.77L0,2.77M10,4V7.68L8,5.68V4H6.32L4.32,2H20A2,2 0 0,1 22,4V19.7L20,17.7V16H18.32L16.32,14H20V10H16V13.68L14,11.68V10H12.32L10.32,8H14V4H10M16,4V8H20V4H16M16,20H17.23L16,18.77V20M4,8H5.23L4,6.77V8M10,14H11.23L10,12.77V14M14,20V16.77L13.23,16H10V20H14M8,20V16H4V20H8M8,14V10.77L7.23,10H4V14H8Z",wa="M10,19H13V22H10V19M12,2C17.35,2.22 19.68,7.62 16.5,11.67C15.67,12.67 14.33,13.33 13.67,14.17C13,15 13,16 13,17H10C10,15.33 10,13.92 10.67,12.92C11.33,11.92 12.67,11.33 13.5,10.67C15.92,8.43 15.32,5.26 12,5A3,3 0 0,0 9,8H6A6,6 0 0,1 12,2Z",Va="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",xa="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z",ka="M18 16H17.42L16.61 15.19C17.5 14 18 12.5 18 11C18 7.13 14.87 4 11 4C9.5 4 8 4.5 6.79 5.4C3.7 7.72 3.07 12.11 5.39 15.2C7.71 18.29 12.1 18.92 15.19 16.6L16 17.41V18L21 23L23 21L18 16M11 16C8.24 16 6 13.76 6 11S8.24 6 11 6 16 8.24 16 11 13.76 16 11 16M3 6L1 8V1H8L6 3H3V6M21 1V8L19 6V3H16L14 1H21M6 19L8 21H1V14L3 16V19H6Z",Ma="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z",Ca="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z",Ha="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z",Sa="M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z",Aa="M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10L15.55,5.55Z",$a="M9,9H15V15H9M7,17H17V7H7M15,5H17V3H15M15,21H17V19H15M19,17H21V15H19M19,9H21V7H19M19,21A2,2 0 0,0 21,19H19M19,13H21V11H19M11,21H13V19H11M9,3H7V5H9M3,17H5V15H3M5,21V19H3A2,2 0 0,0 5,21M19,3V5H21A2,2 0 0,0 19,3M13,3H11V5H13M3,9H5V7H3M7,21H9V19H7M3,13H5V11H3M3,5H5V3A2,2 0 0,0 3,5Z",Ia="M5,3H7V5H9V3H11V5H13V3H15V5H17V3H19V5H21V7H19V9H21V11H19V13H21V15H19V17H21V19H19V21H17V19H15V21H13V19H11V21H9V19H7V21H5V19H3V17H5V15H3V13H5V11H3V9H5V7H3V5H5V3Z",Na="M1,4.27L2.28,3L21,21.72L19.73,23L17,20.27V21H15V19H15.73L5,8.27V9H3V7H3.73L1,4.27M20,3A1,1 0 0,1 21,4V5H19V3H20M15,5V3H17V5H15M11,5V3H13V5H11M7,5V3H9V5H7M11,21V19H13V21H11M7,21V19H9V21H7M4,21A1,1 0 0,1 3,20V19H5V21H4M3,15H5V17H3V15M21,15V17H19V15H21M3,11H5V13H3V11M21,11V13H19V11H21M21,7V9H19V7H21Z",Ta="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z",La="M16.59,5.41L15.17,4L12,7.17L8.83,4L7.41,5.41L12,10M7.41,18.59L8.83,20L12,16.83L15.17,20L16.58,18.59L12,14L7.41,18.59Z",Pa="M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z";const Ea="_root_1pl8d_1";function M({class:n=Ea,shape:t,viewBox:e="0 0 24 24",size:s="2rem",...i}){return c("svg",{class:n,viewBox:e,width:s,height:s,...i,children:c("path",{d:t})})}const Da="_root_12ddp_1";function S({autoFocus:n,checked:t,class:e=Da,disabled:s,icon:i,tabIndex:r,title:o,...a}){return c("button",{class:e,disabled:s,tabIndex:r,autoFocus:n,"aria-checked":t,title:o,...a,children:i})}const Ga="_root_1oe1v_1",Oa="_separator_1oe1v_6";function J({children:n,class:t=Ga}){return c("div",{class:t,children:n})}function qa(){return c("span",{class:Oa})}J.Separator=qa;const za="_root_1dace_1",Ba="_title_1dace_8",Ua="_toolbar_1dace_13",Wa="_text_1dace_22";function Ra({note:n}){const t=it(),e=ct(n.align),s=ut(n.align),i=n.dir;return c("div",{class:za,children:[c("div",{class:Ba,children:"Note"}),c(J,{class:Ua,children:[c(S,{icon:c(M,{shape:Jo,size:"24px"}),checked:e==="l",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`l${s}`})}}),c(S,{icon:c(M,{shape:Ko,size:"24px"}),checked:e==="c",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`c${s}`})}}),c(S,{icon:c(M,{shape:Qo,size:"24px"}),checked:e==="r",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`r${s}`})}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:na,size:"24px"}),checked:s==="t",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`${e}t`})}}),c(S,{icon:c(M,{shape:ea,size:"24px"}),checked:s==="m",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`${e}m`})}}),c(S,{icon:c(M,{shape:ta,size:"24px"}),checked:s==="b",onClick:()=>{t.edit({type:"set-note-align",note:n,align:`${e}b`})}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:va,size:"24px"}),checked:i==="h",onClick:()=>{t.edit({type:"set-note-dir",note:n,dir:"h"})}}),c(S,{icon:c(M,{shape:ga,size:"24px"}),checked:i==="v",onClick:()=>{t.edit({type:"set-note-dir",note:n,dir:"v"})}})]}),c(Gs,{class:Wa,type:"textarea",value:n.text,placeholder:"note...",onChange:r=>{t.edit({type:"set-note-text",note:n,text:r})}})]})}const Os="_root_d1mui_1",Fa="_empty_d1mui_7",ja="_title_d1mui_11";function Za(){const n=it(),{schematic:t,selection:e}=n,s=e.filter(t);if(s.length===1){const[i]=s;if(i instanceof ht)return c(Xo,{instance:i},i.id);if(i instanceof Gt)return c(Ra,{note:i},i.id);if(i instanceof R)return c(Xa,{wire:i},i.id)}return c("div",{class:Os,children:c("div",{class:Fa,children:"-"})})}function Xa({wire:n}){return c("div",{class:Os,children:c("div",{class:ja,children:"Wire"})})}function Ya(n){const[t,e]=Ce(new DOMRect);return He(()=>{const{current:s}=n;if(s==null)return;const i=new ResizeObserver(()=>{e(s.getBoundingClientRect())});return i.observe(s),()=>{i.disconnect()}},[n]),t}function Ka(n,t){for(var e in t)n[e]=t[e];return n}function Be(n,t){for(var e in n)if(e!=="__source"&&!(e in t))return!0;for(var s in t)if(s!=="__source"&&n[s]!==t[s])return!0;return!1}function An(n,t){this.props=n,this.context=t}function Ja(n,t){function e(i){var r=this.props.ref,o=r==i.ref;return!o&&r&&(r.call?r(null):r.current=null),t?!t(this.props,i)||!o:Be(this.props,i)}function s(i){return this.shouldComponentUpdate=e,de(n,i)}return s.displayName="Memo("+(n.displayName||n.name)+")",s.prototype.isReactComponent=!0,s.__f=!0,s}(An.prototype=new st).isPureReactComponent=!0,An.prototype.shouldComponentUpdate=function(n,t){return Be(this.props,n)||Be(this.state,t)};var $n=x.__b;x.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),$n&&$n(n)};var Qa=x.__e;x.__e=function(n,t,e,s){if(n.then){for(var i,r=t;r=r.__;)if((i=r.__c)&&i.__c)return t.__e==null&&(t.__e=e.__e,t.__k=e.__k),i.__c(n,t)}Qa(n,t,e,s)};var In=x.unmount;function qs(n,t,e){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),n.__c.__H=null),(n=Ka({},n)).__c!=null&&(n.__c.__P===e&&(n.__c.__P=t),n.__c=null),n.__k=n.__k&&n.__k.map(function(s){return qs(s,t,e)})),n}function zs(n,t,e){return n&&e&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(s){return zs(s,t,e)}),n.__c&&n.__c.__P===t&&(n.__e&&e.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=e)),n}function Le(){this.__u=0,this.o=null,this.__b=null}function Bs(n){var t=n.__.__c;return t&&t.__a&&t.__a(n)}function le(){this.i=null,this.l=null}x.unmount=function(n){var t=n.__c;t&&t.__R&&t.__R(),t&&32&n.__u&&(n.type=null),In&&In(n)},(Le.prototype=new st).__c=function(n,t){var e=t.__c,s=this;s.o==null&&(s.o=[]),s.o.push(e);var i=Bs(s.__v),r=!1,o=function(){r||(r=!0,e.__R=null,i?i(a):a())};e.__R=o;var a=function(){if(!--s.__u){if(s.state.__a){var l=s.state.__a;s.__v.__k[0]=zs(l,l.__c.__P,l.__c.__O)}var u;for(s.setState({__a:s.__b=null});u=s.o.pop();)u.forceUpdate()}};s.__u++||32&t.__u||s.setState({__a:s.__b=s.__v.__k[0]}),n.then(o,o)},Le.prototype.componentWillUnmount=function(){this.o=[]},Le.prototype.render=function(n,t){if(this.__b){if(this.__v.__k){var e=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=qs(this.__b,e,s.__O=s.__P)}this.__b=null}var i=t.__a&&de(xt,null,n.fallback);return i&&(i.__u&=-33),[de(xt,null,t.__a?null:n.children),i]};var Nn=function(n,t,e){if(++e[1]===e[0]&&n.l.delete(t),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.l.size))for(e=n.i;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;n.i=e=e[2]}};(le.prototype=new st).__a=function(n){var t=this,e=Bs(t.__v),s=t.l.get(n);return s[0]++,function(i){var r=function(){t.props.revealOrder?(s.push(i),Nn(t,n,s)):i()};e?e(r):r()}},le.prototype.render=function(n){this.i=null,this.l=new Map;var t=me(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&t.reverse();for(var e=t.length;e--;)this.l.set(t[e],this.i=[1,0,this.i]);return n.children},le.prototype.componentDidUpdate=le.prototype.componentDidMount=function(){var n=this;this.l.forEach(function(t,e){Nn(n,e,t)})};var tl=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,el=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,nl=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,sl=/[A-Z0-9]/g,il=typeof document<"u",rl=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(n)};st.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(st.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(t){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:t})}})});var Tn=x.event;function ol(){}function al(){return this.cancelBubble}function ll(){return this.defaultPrevented}x.event=function(n){return Tn&&(n=Tn(n)),n.persist=ol,n.isPropagationStopped=al,n.isDefaultPrevented=ll,n.nativeEvent=n};var cl={enumerable:!1,configurable:!0,get:function(){return this.class}},Ln=x.vnode;x.vnode=function(n){typeof n.type=="string"&&function(t){var e=t.props,s=t.type,i={},r=s.indexOf("-")===-1;for(var o in e){var a=e[o];if(!(o==="value"&&"defaultValue"in e&&a==null||il&&o==="children"&&s==="noscript"||o==="class"||o==="className")){var l=o.toLowerCase();o==="defaultValue"&&"value"in e&&e.value==null?o="value":o==="download"&&a===!0?a="":l==="translate"&&a==="no"?a=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?o="ondblclick":l!=="onchange"||s!=="input"&&s!=="textarea"||rl(e.type)?l==="onfocus"?o="onfocusin":l==="onblur"?o="onfocusout":nl.test(o)&&(o=l):l=o="oninput":r&&el.test(o)?o=o.replace(sl,"-$&").toLowerCase():a===null&&(a=void 0),l==="oninput"&&i[o=l]&&(o="oninputCapture"),i[o]=a}}s=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=me(e.children).forEach(function(u){u.props.selected=i.value.indexOf(u.props.value)!=-1})),s=="select"&&i.defaultValue!=null&&(i.value=me(e.children).forEach(function(u){u.props.selected=i.multiple?i.defaultValue.indexOf(u.props.value)!=-1:i.defaultValue==u.props.value})),e.class&&!e.className?(i.class=e.class,Object.defineProperty(i,"className",cl)):(e.className&&!e.class||e.class&&e.className)&&(i.class=i.className=e.className),t.props=i}(n),n.$$typeof=tl,Ln&&Ln(n)};var Pn=x.__r;x.__r=function(n){Pn&&Pn(n),n.__c};var En=x.diffed;x.diffed=function(n){En&&En(n);var t=n.props,e=n.__e;e!=null&&n.type==="textarea"&&"value"in t&&t.value!==e.value&&(e.value=t.value==null?"":t.value)};const ul={open:/\$/y,close:/\$/y},hl={open:/\\\(/y,close:/\\\)/y},fl={open:/\$\$/y,close:/\$\$/y},dl={open:/\\\[/y,close:/\\\]/y},Dn=/\s+|\\\{|\\\}|\\\\/y;function pl(n){const t=xe(n,"$","$"),e=xe(n,"\\(","\\)");if(t!==-1&&e!==-1)return Math.min(t,e);if(t!==-1)return t;if(e!==-1)return e}function ml(n,t){return ke(n,ul,t)||ke(n,hl,t)}function _l(n){const t=xe(n,"$$","$$"),e=xe(n,"\\[","\\]");if(t!==-1&&e!==-1)return Math.min(t,e);if(t!==-1)return t;if(e!==-1)return e}function vl(n,t){return ke(n,fl,t)||ke(n,dl,t)}function xe(n,t,e){let s=n.indexOf(t);return s!==-1&&n.indexOf(e,s+t.length+1)===-1&&(s=-1),s}function ke(n,t,e){if(Pe(n,t.open,0)){let s=t.open.lastIndex;for(;s<n.length;)if(Pe(n,Dn,s))s=Dn.lastIndex;else{if(Pe(n,t.close,s))return e.raw=n.substring(0,t.close.lastIndex),e.text=n.substring(t.open.lastIndex,s).trim(),!0;s+=1}}return!1}function Pe(n,t,e){return t.lastIndex=e,t.test(n)}function gl(n){return{extensions:[yl(n),bl(n)]}}function yl(n){const t={raw:"",text:""};return{name:"blockKatex",level:"block",start(e){return _l(e)},tokenizer(e){if(vl(e,t))return{type:"blockKatex",raw:t.raw,text:t.text}},renderer({text:e}){return On(e,{...n,displayMode:!0})+`
`}}}function bl(n){const t={raw:"",text:""};return{name:"inlineKatex",level:"inline",start(e){return pl(e)},tokenizer(e){if(ml(e,t))return{type:"inlineKatex",raw:t.raw,text:t.text}},renderer({text:e}){return On(e,{...n,displayMode:!1})}}}const wl=new Fs(gl({output:"mathml",throwOnError:!1}));function Vl(n){return wl.parse(n,{async:!1,silent:!0,gfm:!1,pedantic:!1})}const xl="_root_2mcg2_1",kl=Ja(Ml);function Ml({note:n,text:t,align:e,dir:s,x:i,y:r,width:o,height:a}){const l=Nt(null);Xt(()=>{l.current.setHTMLUnsafe(Vl(t||"note..."))},[t]),Xt(()=>{n.width=l.current.offsetWidth,n.height=l.current.offsetHeight});const u=Cl(i,r,e,s);return c("div",{ref:l,class:xl,style:u,"data-align":e,"data-h-align":ct(e),"data-v-align":ut(e),"data-dir":s})}function Cl(n,t,e,s){let i=0,r=0;switch(ct(e)){case"l":i=0;break;case"c":i=-50;break;case"r":i=-100;break}switch(ut(e)){case"t":r=0;break;case"m":r=-50;break;case"b":r=-100;break}let o=0;switch(s){case"v":o=-90;break;case"h":o=0;break}return{position:"absolute",left:n,top:t,transformOrigin:`${-i}% ${-r}%`,translate:`${i}% ${r}%`,rotate:`${o}deg`}}const Hl="_root_1nll4_1";function Sl(){const{schematic:n,zoom:t}=it();return c("div",{class:Hl,style:{transformOrigin:"0px 0px",translate:`${t.x}px ${t.y}px`,scale:`${t.scale}`},children:n.notes.map(e=>c(kl,{note:e,text:e.text,align:e.align,dir:e.dir,x:e.x,y:e.y,width:e.width,height:e.height},e.id))})}const Al="_root_1hx45_1";function $l(){const n=it(),t=Nt(null),e=Nt(null),{width:s,height:i}=Ya(e);return Qn(n.focusRef,()=>({focus:()=>{t.current?.focus()},blur:()=>{t.current?.blur()},get focused(){return t.current===document.activeElement}})),Xt(()=>{s>0&&i>0&&(Ds(e.current),n.attach(e.current))},[n,s,i]),Xt(()=>{if(s>0&&i>0){const r=requestAnimationFrame(()=>{n.paint()});return()=>{cancelAnimationFrame(r)}}},[n,s,i,n.settings,n.schematic,n.zoom,n.selection,n.mouseAction]),c("div",{ref:t,class:Al,tabIndex:0,autofocus:!0,onFocus:n.handleFocus,onBlur:n.handleBlur,onKeyDown:n.handleKeyDown,onKeyUp:n.handleKeyUp,style:Il(n),children:[c(Es,{canvas:e,onMouseDown:n.handleMouseDown,onMouseMove:n.handleMouseMove,onMouseUp:n.handleMouseUp,onWheel:n.handleWheel,onContextMenu:n.handleContextMenu}),c(Sl,{})]})}function Il(n){switch(n.mouseAction.type){case"scroll":return{cursor:"all-scroll"};case"wire-start":case"wire":return{cursor:"crosshair"};case"move":case"paste":return{cursor:"move"}}return{cursor:"default"}}const Nl=Ze(null),Tl="_root_3m5pl_1 _fadeIn_kq333_1";let Ll=0;class Pl{constructor(t,e){this.message=t,this.options=e}#t=Ll+=1;get key(){return this.#t}}const Lt=nt([]);function El(n){Lt.value=[...Lt.value,n]}function Dl(n){Lt.value=Lt.value.filter(t=>t!==n)}function Gl({message:n}){const t=Nt(null);return He(()=>{n.options.modal?t.current?.showModal():t.current?.show()},[n]),c("dialog",{ref:t,class:Tl,onClose:()=>{Dl(n),n.options.onClose()},children:c(Nl,{value:{close:()=>{t.current?.close()}},children:n.message})},n.key)}const Ol="_root_5uo3x_1";function ql(){return c("div",{class:Ol,hidden:Lt.value.length===0,children:Lt.value.map(n=>c(Gl,{message:n}))})}function Gn(n,{modal:t=!0,onClose:e=()=>{}}={}){El(new Pl(n,{modal:t,onClose:e}))}const zl="_alert_ppbdc_1 _fadeIn_kq333_1",Bl="_message_ppbdc_17";class Ul{#t=new Set;get pending(){return this.#t.size}delayed(t,e){let s=!1,i=!1;const r=()=>{i||(i=!0,this.#t.delete(o),clearTimeout(a))},o=new class{cancel(){r()}get fired(){return s}get cancelled(){return i}};this.#t.add(o);const a=setTimeout(()=>{i||(this.#t.delete(o),s=!0,e())},t);return o}repeated(t,e){let s=!1,i=!1;const r=()=>{i||(i=!0,this.#t.delete(o),clearInterval(a))},o=new class{cancel(){r()}get fired(){return s}get cancelled(){return i}};this.#t.add(o);const a=setInterval(()=>{i||(s=!0,e())},t);return o}cancelAll(){for(const t of this.#t)t.cancel();return this}}const Wl=new Ul;let Rl=0;class Fl{constructor(t,e){this.message=t,this.options=e}#t=Rl+=1;#n=null;get key(){return this.#t}delayed(t,e){this.clearDelayed(),this.#n=Wl.delayed(e,t)}clearDelayed(){this.#n!=null&&(this.#n.cancel(),this.#n=null)}}const Pt=nt([]);function jl(n){Pt.value=[...Pt.value,n],Us(n)}function Ue(n){Pt.value=Pt.value.filter(t=>t!==n)}function Zl(n,t){t?n.clearDelayed():Us(n)}function Us(n){n.options.autoClose&&n.delayed(()=>{Ue(n)},n.options.autoClose)}const Ws=Ze(null);function Xl({toast:n,children:t}){return c(Ws,{value:{close:()=>{Ue(n)},hover:e=>{n.options.autoClose&&n.options.pauseOnHover&&Zl(n,e)},click:()=>{n.options.closeOnClick&&Ue(n)}},children:t})}function sn(){return ts(Ws)}function Rs(n){return{onMouseEnter:()=>{n.hover(!0)},onMouseLeave:()=>{n.hover(!1)},onClick:()=>{n.click()}}}function Yl({children:n}){return Qs(n,{...n.props,...Rs(sn())})}function Kl(){const n=sn();return c(M,{shape:ra,onClick:()=>{n.close()}})}function Jl({severity:n}){switch(n){case"info":return c(Ql,{});case"success":return c(tc,{});case"error":return c(ec,{});default:return null}}function Ql(){return c(M,{shape:Va})}function tc(){return c(M,{shape:ia})}function ec(){return c(M,{shape:Yo})}function nc({children:n,severity:t=null,closeButton:e=!0}){const s=sn();return c("div",{class:zl,...Rs(s),popover:!0,children:[t&&c(Jl,{severity:t}),c("div",{class:Bl,children:n}),e&&c(Kl,{})]})}const sc="_root_1k080_1";function ic(){return c("div",{class:sc,hidden:Pt.value.length===0,children:[...Pt.value].reverse().map(n=>c(Xl,{toast:n,children:c(Yl,{children:n.message})},n.key))})}function rc(n,{autoClose:t=3e3,pauseOnHover:e=!0,closeOnClick:s=!0}={}){jl(new Fl(n,{autoClose:t,pauseOnHover:e,closeOnClick:s}))}function Ft({error:n}){return c(nc,{severity:"error",children:n instanceof AggregateError?n.errors.map((t,e)=>c("p",{children:String(t)},e)):c("p",{children:String(n)})})}function oc(n,{autoClose:t=3e3,pauseOnHover:e=!0,closeOnClick:s=!1}={}){rc(c(Ft,{error:n}),{autoClose:t,pauseOnHover:e,closeOnClick:s})}Ft.report=oc;const ac="_root_yio74_1",lc="_header_yio74_9",cc="_headerText_yio74_14",uc="_headerButton_yio74_25",hc="_content_yio74_29",fc="_resize_yio74_36";function ce({title:n,children:t,style:e}){const[s,i]=Ce(!0);return c("div",{class:ac,style:e,children:[c("div",{class:lc,children:[c("span",{class:cc,children:n}),c("span",{class:uc,onClick:()=>{i(!s)},children:c(M,{shape:s?La:Pa})})]}),s&&c(xt,{children:[c("div",{class:hc,children:t}),c(dc,{})]})]})}function dc(){return c("svg",{class:fc,viewBox:"0 0 24 24",children:c("path",{d:"M22,22H20V20H22V22M22,18H20V16H22V18M18,22H16V20H18V22M18,18H16V16H18V18M14,22H12V20H14V22M22,14H20V12H22V14Z"})})}const pc="_root_948vb_1",mc="_toolbar_948vb_8",_c="_schematic_948vb_17";function vc(){return vt.create(Tt([["i",50,50,0,"vdc","V1",{}],["i",150,50,0,"r","R1",{}],["i",50,120,0,"g","G1",{}],["w",50,0,150,0],["w",50,100,150,100],["w",50,0,50,20],["w",50,80,50,100],["w",50,100,50,120],["w",150,0,150,20],["w",150,80,150,100],["n",250,0,"lt","h",`# Ohm's law

*Ohm's law* states that the electric current $I$ through a conductor between two points is directly proportional to the voltage $V$ across the two points.

$$I = \\frac{V}{R}$$

The law was named after the German physicist *Georg Ohm*.`],["n",700,0,"lm","h","\\[ \\int_{a}^{b} x^2 \\, dx \\]"],["n",700,50,"lm","h","\\[ \\iint_V \\mu(u,v) \\, du \\, dv \\]"],["n",700,100,"lm","h","\\[ \\oint_V f(s) \\, ds \\]"],["n",700,150,"lm","h","\\[ \\sum_{n=1}^{\\infty} 2^{-n} = 1 \\]"],["n",700,200,"lm","h","\\[ \\prod_{i=a}^{b} f(i) \\]"],["n",700,250,"lm","h","\\[ \\lim_{x\\to\\infty} f(x) \\]"],["n",700,300,"lm","h","\\[ \\begin{pmatrix} 1 & 2 & 3 \\\\ a & b & c \\end{pmatrix} \\]"]]))}const gc="_root_1bk49_1",yc="_select_1bk49_8",bc="_content_1bk49_13";function wc(){return c("p",{children:"Capacitive reactance"})}function Vc(){return c("p",{children:"Inductive reactance"})}function xc(){return c("p",{children:"Resistive voltage divider"})}function kc(){return c("p",{children:"LC resonance"})}function Mc(){return c("p",{children:"Wavelength and frequency"})}const ue=[{name:"Resistive voltage divider",component:xc},{name:"Capacitive reactance",component:wc},{name:"Inductive reactance",component:Vc},{name:"LC resonance",component:kc},{name:"Wavelength and frequency",component:Mc}];function Cc(){const[n,t]=Ce(ue[0]),{component:e}=n;return c("section",{class:gc,children:[c("select",{class:yc,value:n.name,onInput:({target:s})=>{const{value:i}=s;t(ue.find(({name:r})=>r===i)??ue[0])},children:ue.map(({name:s})=>c("option",{value:s,children:s}))}),c("div",{class:bc,children:c(e,{})})]})}const Hc="_root_8tr57_1";function Sc(){return c("section",{class:Hc,children:[c("p",{children:["To draw a wire, click and start moving the pointer from a device pin, a wire end, or a wire junction. To draw a wire from any location on the grid, press ",c("kbd",{children:"W"}),". To change a wire's angle, press ",c("kbd",{children:"Shift"}),". To draw a diagonal wire, press ",c("kbd",{children:"Alt"}),"."]}),c("p",{children:"Shortcuts:"}),c("ul",{children:[c("li",{children:[c("kbd",{children:"W"})," Start drawing a wire from any point on the grid"]}),c("li",{children:[c("kbd",{children:"Shift"})," While drawing a wire, changes the angle of the wire"]}),c("li",{children:[c("kbd",{children:"Alt"})," While drawing a wire, draws a diagonal wire"]}),c("li",{children:[c("kbd",{children:"G"})," Place a ground symbol"]}),c("li",{children:[c("kbd",{children:"O"})," Place a port symbol"]}),c("li",{children:[c("kbd",{children:"V"})," Place a voltage source"]}),c("li",{children:[c("kbd",{children:"I"})," Place a current source"]}),c("li",{children:[c("kbd",{children:"R"})," Place a resistor"]}),c("li",{children:[c("kbd",{children:"C"})," Place a capacitor"]}),c("li",{children:[c("kbd",{children:"L"})," Place an inductor"]}),c("li",{children:[c("kbd",{children:"D"})," Place a diode"]}),c("li",{children:[c("kbd",{children:"N"})," Place an NPN transistor"]}),c("li",{children:[c("kbd",{children:"P"})," Place a PNP transistor"]}),c("li",{children:[c("kbd",{children:"Shift+N"})," Place an N-channel MOSFET"]}),c("li",{children:[c("kbd",{children:"Shift+P"})," Place a P-channel MOSFET"]}),c("li",{children:[c("kbd",{children:"A"})," Place an operational amplifier"]}),c("li",{children:[c("kbd",{children:"Home"})," Zoom to 100%"]}),c("li",{children:[c("kbd",{children:"Space"})," Expand or shrink to cover the whole screen"]}),c("li",{children:[c("kbd",{children:"Ctrl+X"})," Cut selected item(s) to clipboard"]}),c("li",{children:[c("kbd",{children:"Ctrl+C"})," Copy selected item(s) to clipboard"]}),c("li",{children:[c("kbd",{children:"Ctrl+V"})," Paste item(s) from clipboard"]}),c("li",{children:[c("kbd",{children:"Ctrl+A"})," Select all"]}),c("li",{children:[c("kbd",{children:"Delete"})," Delete selected item(s)"]}),c("li",{children:[c("kbd",{children:"Alt+L"})," Rotate selected item(s) to the left"]}),c("li",{children:[c("kbd",{children:"Alt+R"})," Rotate selected item(s) to the right"]}),c("li",{children:[c("kbd",{children:"Alt+H"})," Flip selected item(s) from left to right"]}),c("li",{children:[c("kbd",{children:"Alt+V"})," Flip selected item(s) from top to bottom"]}),c("li",{children:[c("kbd",{children:"Ctrl+Z"})," Undo"]}),c("li",{children:[c("kbd",{children:"Ctrl+Y"})," Redo"]})]})]})}const Ac="_root_1qxgy_1";function $c(){const n=it(),{settings:t}=n;return c(J,{class:Ac,children:[c(S,{icon:c(M,{shape:pa}),title:"Open schematic",onClick:()=>{Ft.report("Not implemented")}}),c(S,{icon:c(M,{shape:_a}),title:"Save schematic",onClick:()=>{Ft.report("Not implemented")}}),c(S,{icon:c(M,{shape:ma}),title:"New schematic",onClick:()=>{Ft.report("Not implemented")}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:$a}),title:"Select all",onClick:()=>{n.select("all"),n.focus()}}),c(S,{icon:c(M,{shape:Ia}),title:"Invert selection",onClick:()=>{n.select("invert"),n.focus()}}),c(S,{icon:c(M,{shape:Na}),title:"Clear selection",onClick:()=>{n.select("none"),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:aa}),title:"Cut selected item(s) to clipboard",onClick:()=>{n.selectionCut(),n.focus()}}),c(S,{icon:c(M,{shape:oa}),title:"Copy selected item(s) to clipboard",onClick:()=>{n.selectionCopy(),n.focus()}}),c(S,{icon:c(M,{shape:la}),title:"Paste item(s) from clipboard",onClick:()=>{n.selectionPaste(),n.focus()}}),c(S,{icon:c(M,{shape:ha}),title:"Delete selected item(s)",onClick:()=>{n.selectionDelete(),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:Sa}),title:"Rotate selected item(s) to the left",disabled:!n.selection.full,onClick:()=>{n.transformSelection("rl"),n.focus()}}),c(S,{icon:c(M,{shape:Aa}),title:"Rotate selected item(s) to the right",disabled:!n.selection.full,onClick:()=>{n.transformSelection("rr"),n.focus()}}),c(S,{icon:c(M,{shape:fa}),title:"Flip selected item(s) from left to right",disabled:!n.selection.full,onClick:()=>{n.transformSelection("mx"),n.focus()}}),c(S,{icon:c(M,{shape:da}),title:"Flip selected item(s) from top to bottom",disabled:!n.selection.full,onClick:()=>{n.transformSelection("my"),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:Ta}),title:"Undo",disabled:!n.history.canUndo,onClick:()=>{n.undo(),n.focus()}}),c(S,{icon:c(M,{shape:Ha}),title:"Redo",disabled:!n.history.canRedo,onClick:()=>{n.redo(),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:xa}),title:"Zoom 100%",onClick:()=>{n.zoomTo("1"),n.focus()}}),c(S,{icon:c(M,{shape:Ca}),title:"Zoom in",onClick:()=>{n.zoomTo("+"),n.focus()}}),c(S,{icon:c(M,{shape:Ma}),title:"Zoom out",onClick:()=>{n.zoomTo("-"),n.focus()}}),c(S,{icon:c(M,{shape:ka}),title:"View all",onClick:()=>{n.zoomTo("all"),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:t.showGrid?ba:ya}),title:t.showGrid?"Hide grid":"Show grid",onClick:()=>{n.updateSettings({showGrid:!t.showGrid}),n.focus()}}),c(S,{icon:c(M,{shape:t.showCrosshair?ua:ca}),title:t.showCrosshair?"Hide crosshair":"Show crosshair",onClick:()=>{n.updateSettings({showCrosshair:!t.showCrosshair}),n.focus()}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:sa}),title:"Calculator",onClick:()=>{Gn(c(Cc,{}),{modal:!0,onClose:()=>{n.focus()}})}}),c(J.Separator,{}),c(S,{icon:c(M,{shape:wa}),title:"Help",onClick:()=>{Gn(c(Sc,{}),{modal:!0,onClose:()=>{n.focus()}})}})]})}function Ic(){const n=Se(()=>new Co(gs,vc()),[]);return He(()=>{const t=As(["Alt+v",()=>{}],["Alt+h",()=>{}],["Alt+r",()=>{}],["Alt+l",()=>{}],["Ctrl+a",()=>{}],["Ctrl+s",()=>{}],["Ctrl+o",()=>{}],["Ctrl+n",()=>{}],["Ctrl+r",()=>{}]);return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[n]),c(Ls,{value:n,children:[c("main",{class:pc,children:[c("div",{class:mc,children:c($c,{})}),c("div",{class:_c,children:c($l,{})}),c(ce,{title:"Instances",style:{insetInlineEnd:"38rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:c(Io,{})}),c(ce,{title:"Nodes",style:{insetInlineEnd:"20rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:c(Bo,{})}),c(ce,{title:"Library",style:{insetInlineEnd:"2rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:c(Do,{})}),c(ce,{title:"Properties",style:{insetInlineStart:"2rem",insetBlockStart:"4rem"},children:c(Za,{})})]}),c(ql,{}),c(ic,{})]})}Js(c(Ic,{}),document.querySelector("#app"));
