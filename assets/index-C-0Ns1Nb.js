import{k as ui}from"./katex-DvRmkopC.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();var Ne,V,fn,pn,oe,Et,dn,pt,_n,wt,dt,_t,mn,Ae={},vn=[],hi=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Qe=Array.isArray;function Q(n,e){for(var t in e)n[t]=e[t];return n}function xt(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function qe(n,e,t){var i,s,r,o={};for(r in e)r=="key"?i=e[r]:r=="ref"?s=e[r]:o[r]=e[r];if(arguments.length>2&&(o.children=arguments.length>3?Ne.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(r in n.defaultProps)o[r]===void 0&&(o[r]=n.defaultProps[r]);return xe(n,o,i,s,null)}function xe(n,e,t,i,s){var r={type:n,props:e,key:t,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++fn,__i:-1,__u:0};return s==null&&V.vnode!=null&&V.vnode(r),r}function le(n){return n.children}function J(n,e){this.props=n,this.context=e}function de(n,e){if(e==null)return n.__?de(n.__,n.__i+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?de(n):null}function yn(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return yn(n)}}function mt(n){(!n.__d&&(n.__d=!0)&&oe.push(n)&&!je.__r++||Et!==V.debounceRendering)&&((Et=V.debounceRendering)||dn)(je)}function je(){var n,e,t,i,s,r,o,l;for(oe.sort(pt);n=oe.shift();)n.__d&&(e=oe.length,i=void 0,r=(s=(t=n).__v).__e,o=[],l=[],t.__P&&((i=Q({},s)).__v=s.__v+1,V.vnode&&V.vnode(i),Ct(t.__P,i,s,t.__n,t.__P.namespaceURI,32&s.__u?[r]:null,o,r??de(s),!!(32&s.__u),l),i.__v=s.__v,i.__.__k[i.__i]=i,Vn(o,i,l),i.__e!=r&&yn(i)),oe.length>e&&oe.sort(pt));je.__r=0}function gn(n,e,t,i,s,r,o,l,a,c,f){var h,d,p,_,v,w,y=i&&i.__k||vn,m=e.length;for(a=fi(t,e,y,a,m),h=0;h<m;h++)(p=t.__k[h])!=null&&(d=p.__i===-1?Ae:y[p.__i]||Ae,p.__i=h,w=Ct(n,p,d,s,r,o,l,a,c,f),_=p.__e,p.ref&&d.ref!=p.ref&&(d.ref&&kt(d.ref,null,p),f.push(p.ref,p.__c||_,p)),v==null&&_!=null&&(v=_),4&p.__u||d.__k===p.__k?a=bn(p,a,n):typeof p.type=="function"&&w!==void 0?a=w:_&&(a=_.nextSibling),p.__u&=-7);return t.__e=v,a}function fi(n,e,t,i,s){var r,o,l,a,c,f=t.length,h=f,d=0;for(n.__k=new Array(s),r=0;r<s;r++)(o=e[r])!=null&&typeof o!="boolean"&&typeof o!="function"?(a=r+d,(o=n.__k[r]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?xe(null,o,null,null,null):Qe(o)?xe(le,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?xe(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,l=null,(c=o.__i=pi(o,t,a,h))!==-1&&(h--,(l=t[c])&&(l.__u|=2)),l==null||l.__v===null?(c==-1&&d--,typeof o.type!="function"&&(o.__u|=4)):c!=a&&(c==a-1?d--:c==a+1?d++:(c>a?d--:d++,o.__u|=4))):n.__k[r]=null;if(h)for(r=0;r<f;r++)(l=t[r])!=null&&!(2&l.__u)&&(l.__e==i&&(i=de(l)),wn(l,l));return i}function bn(n,e,t){var i,s;if(typeof n.type=="function"){for(i=n.__k,s=0;i&&s<i.length;s++)i[s]&&(i[s].__=n,e=bn(i[s],e,t));return e}n.__e!=e&&(e&&n.type&&!t.contains(e)&&(e=de(n)),t.insertBefore(n.__e,e||null),e=n.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ze(n,e){return e=e||[],n==null||typeof n=="boolean"||(Qe(n)?n.some(function(t){Ze(t,e)}):e.push(n)),e}function pi(n,e,t,i){var s,r,o=n.key,l=n.type,a=e[t];if(a===null||a&&o==a.key&&l===a.type&&!(2&a.__u))return t;if(i>(a!=null&&!(2&a.__u)?1:0))for(s=t-1,r=t+1;s>=0||r<e.length;){if(s>=0){if((a=e[s])&&!(2&a.__u)&&o==a.key&&l===a.type)return s;s--}if(r<e.length){if((a=e[r])&&!(2&a.__u)&&o==a.key&&l===a.type)return r;r++}}return-1}function Gt(n,e,t){e[0]=="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||hi.test(e)?t:t+"px"}function Be(n,e,t,i,s){var r;e:if(e=="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof i=="string"&&(n.style.cssText=i=""),i)for(e in i)t&&e in t||Gt(n.style,e,"");if(t)for(e in t)i&&t[e]===i[e]||Gt(n.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(_n,"$1")),e=e.toLowerCase()in n||e=="onFocusOut"||e=="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+r]=t,t?i?t.u=i.u:(t.u=wt,n.addEventListener(e,r?_t:dt,r)):n.removeEventListener(e,r?_t:dt,r);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?n.removeAttribute(e):n.setAttribute(e,e=="popover"&&t==1?"":t))}}function Bt(n){return function(e){if(this.l){var t=this.l[e.type+n];if(e.t==null)e.t=wt++;else if(e.t<t.u)return;return t(V.event?V.event(e):e)}}}function Ct(n,e,t,i,s,r,o,l,a,c){var f,h,d,p,_,v,w,y,m,G,A,z,F,k,P,B,M,O=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(a=!!(32&t.__u),r=[l=e.__e=t.__e]),(f=V.__b)&&f(e);e:if(typeof O=="function")try{if(y=e.props,m="prototype"in O&&O.prototype.render,G=(f=O.contextType)&&i[f.__c],A=f?G?G.props.value:f.__:i,t.__c?w=(h=e.__c=t.__c).__=h.__E:(m?e.__c=h=new O(y,A):(e.__c=h=new J(y,A),h.constructor=O,h.render=_i),G&&G.sub(h),h.props=y,h.state||(h.state={}),h.context=A,h.__n=i,d=h.__d=!0,h.__h=[],h._sb=[]),m&&h.__s==null&&(h.__s=h.state),m&&O.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=Q({},h.__s)),Q(h.__s,O.getDerivedStateFromProps(y,h.__s))),p=h.props,_=h.state,h.__v=e,d)m&&O.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),m&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(m&&O.getDerivedStateFromProps==null&&y!==p&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(y,A),!h.__e&&(h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(y,h.__s,A)===!1||e.__v==t.__v)){for(e.__v!=t.__v&&(h.props=y,h.state=h.__s,h.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(j){j&&(j.__=e)}),z=0;z<h._sb.length;z++)h.__h.push(h._sb[z]);h._sb=[],h.__h.length&&o.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(y,h.__s,A),m&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(p,_,v)})}if(h.context=A,h.props=y,h.__P=n,h.__e=!1,F=V.__r,k=0,m){for(h.state=h.__s,h.__d=!1,F&&F(e),f=h.render(h.props,h.state,h.context),P=0;P<h._sb.length;P++)h.__h.push(h._sb[P]);h._sb=[]}else do h.__d=!1,F&&F(e),f=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++k<25);h.state=h.__s,h.getChildContext!=null&&(i=Q(Q({},i),h.getChildContext())),m&&!d&&h.getSnapshotBeforeUpdate!=null&&(v=h.getSnapshotBeforeUpdate(p,_)),l=gn(n,Qe(B=f!=null&&f.type===le&&f.key==null?f.props.children:f)?B:[B],e,t,i,s,r,o,l,a,c),h.base=e.__e,e.__u&=-161,h.__h.length&&o.push(h),w&&(h.__E=h.__=null)}catch(j){if(e.__v=null,a||r!=null)if(j.then){for(e.__u|=a?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;r[r.indexOf(l)]=null,e.__e=l}else for(M=r.length;M--;)xt(r[M]);else e.__e=t.__e,e.__k=t.__k;V.__e(j,e,t)}else r==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):l=e.__e=di(t.__e,e,t,i,s,r,o,a,c);return(f=V.diffed)&&f(e),128&e.__u?void 0:l}function Vn(n,e,t){for(var i=0;i<t.length;i++)kt(t[i],t[++i],t[++i]);V.__c&&V.__c(e,n),n.some(function(s){try{n=s.__h,s.__h=[],n.some(function(r){r.call(s)})}catch(r){V.__e(r,s.__v)}})}function di(n,e,t,i,s,r,o,l,a){var c,f,h,d,p,_,v,w=t.props,y=e.props,m=e.type;if(m=="svg"?s="http://www.w3.org/2000/svg":m=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),r!=null){for(c=0;c<r.length;c++)if((p=r[c])&&"setAttribute"in p==!!m&&(m?p.localName==m:p.nodeType==3)){n=p,r[c]=null;break}}if(n==null){if(m==null)return document.createTextNode(y);n=document.createElementNS(s,m,y.is&&y),l&&(V.__m&&V.__m(e,r),l=!1),r=null}if(m===null)w===y||l&&n.data===y||(n.data=y);else{if(r=r&&Ne.call(n.childNodes),w=t.props||Ae,!l&&r!=null)for(w={},c=0;c<n.attributes.length;c++)w[(p=n.attributes[c]).name]=p.value;for(c in w)if(p=w[c],c!="children"){if(c=="dangerouslySetInnerHTML")h=p;else if(!(c in y)){if(c=="value"&&"defaultValue"in y||c=="checked"&&"defaultChecked"in y)continue;Be(n,c,null,p,s)}}for(c in y)p=y[c],c=="children"?d=p:c=="dangerouslySetInnerHTML"?f=p:c=="value"?_=p:c=="checked"?v=p:l&&typeof p!="function"||w[c]===p||Be(n,c,p,w[c],s);if(f)l||h&&(f.__html===h.__html||f.__html===n.innerHTML)||(n.innerHTML=f.__html),e.__k=[];else if(h&&(n.innerHTML=""),gn(n,Qe(d)?d:[d],e,t,i,m=="foreignObject"?"http://www.w3.org/1999/xhtml":s,r,o,r?r[0]:t.__k&&de(t,0),l,a),r!=null)for(c=r.length;c--;)xt(r[c]);l||(c="value",m=="progress"&&_==null?n.removeAttribute("value"):_!==void 0&&(_!==n[c]||m=="progress"&&!_||m=="option"&&_!==w[c])&&Be(n,c,_,w[c],s),c="checked",v!==void 0&&v!==n[c]&&Be(n,c,v,w[c],s))}return n}function kt(n,e,t){try{if(typeof n=="function"){var i=typeof n.__u=="function";i&&n.__u(),i&&e==null||(n.__u=n(e))}else n.current=e}catch(s){V.__e(s,t)}}function wn(n,e,t){var i,s;if(V.unmount&&V.unmount(n),(i=n.ref)&&(i.current&&i.current!==n.__e||kt(i,null,e)),(i=n.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){V.__e(r,e)}i.base=i.__P=null}if(i=n.__k)for(s=0;s<i.length;s++)i[s]&&wn(i[s],e,t||typeof n.type!="function");t||xt(n.__e),n.__c=n.__=n.__e=void 0}function _i(n,e,t){return this.constructor(n,t)}function mi(n,e,t){var i,s,r,o;e==document&&(e=document.documentElement),V.__&&V.__(n,e),s=(i=!1)?null:e.__k,r=[],o=[],Ct(e,n=e.__k=qe(le,null,[n]),s||Ae,Ae,e.namespaceURI,s?null:e.firstChild?Ne.call(e.childNodes):null,r,s?s.__e:e.firstChild,i,o),Vn(r,n,o)}function vi(n,e,t){var i,s,r,o,l=Q({},n.props);for(r in n.type&&n.type.defaultProps&&(o=n.type.defaultProps),e)r=="key"?i=e[r]:r=="ref"?s=e[r]:l[r]=e[r]===void 0&&o!==void 0?o[r]:e[r];return arguments.length>2&&(l.children=arguments.length>3?Ne.call(arguments,2):t),xe(n.type,l,i||n.key,s||n.ref,null)}function Mt(n,e){var t={__c:e="__cC"+mn++,__:n,Consumer:function(i,s){return i.children(s)},Provider:function(i){var s,r;return this.getChildContext||(s=new Set,(r={})[e]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){s=null},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&s.forEach(function(l){l.__e=!0,mt(l)})},this.sub=function(o){s.add(o);var l=o.componentWillUnmount;o.componentWillUnmount=function(){s&&s.delete(o),l&&l.call(o)}}),i.children}};return t.Provider.__=t.Consumer.contextType=t}Ne=vn.slice,V={__e:function(n,e,t,i){for(var s,r,o;e=e.__;)if((s=e.__c)&&!s.__)try{if((r=s.constructor)&&r.getDerivedStateFromError!=null&&(s.setState(r.getDerivedStateFromError(n)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(n,i||{}),o=s.__d),o)return s.__E=s}catch(l){n=l}throw n}},fn=0,pn=function(n){return n!=null&&n.constructor==null},J.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Q({},this.state),typeof n=="function"&&(n=n(Q({},t),this.props)),n&&Q(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),mt(this))},J.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),mt(this))},J.prototype.render=le,oe=[],dn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,pt=function(n,e){return n.__v.__b-e.__v.__b},je.__r=0,_n=/(PointerCapture)$|Capture$/i,wt=0,dt=Bt(!1),_t=Bt(!0),mn=0;var yi=0;function u(n,e,t,i,s,r){e||(e={});var o,l,a=e;if("ref"in a)for(l in a={},e)l=="ref"?o=e[l]:a[l]=e[l];var c={type:n,props:a,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--yi,__i:-1,__u:0,__source:s,__self:r};if(typeof n=="function"&&(o=n.defaultProps))for(l in o)a[l]===void 0&&(a[l]=o[l]);return V.vnode&&V.vnode(c),c}var ae,I,at,Ot,Ie=0,xn=[],D=V,Wt=D.__b,Ut=D.__r,Rt=D.diffed,zt=D.__c,Ft=D.unmount,qt=D.__;function Te(n,e){D.__h&&D.__h(I,n,Ie||e),Ie=0;var t=I.__H||(I.__H={__:[],__h:[]});return n>=t.__.length&&t.__.push({}),t.__[n]}function Ht(n){return Ie=1,gi(kn,n)}function gi(n,e,t){var i=Te(ae++,2);if(i.t=n,!i.__c&&(i.__=[t?t(e):kn(void 0,e),function(l){var a=i.__N?i.__N[0]:i.__[0],c=i.t(a,l);a!==c&&(i.__N=[c,i.__[1]],i.__c.setState({}))}],i.__c=I,!I.u)){var s=function(l,a,c){if(!i.__c.__H)return!0;var f=i.__c.__H.__.filter(function(d){return!!d.__c});if(f.every(function(d){return!d.__N}))return!r||r.call(this,l,a,c);var h=i.__c.props!==l;return f.forEach(function(d){if(d.__N){var p=d.__[0];d.__=d.__N,d.__N=void 0,p!==d.__[0]&&(h=!0)}}),r&&r.call(this,l,a,c)||h};I.u=!0;var r=I.shouldComponentUpdate,o=I.componentWillUpdate;I.componentWillUpdate=function(l,a,c){if(this.__e){var f=r;r=void 0,s(l,a,c),r=f}o&&o.call(this,l,a,c)},I.shouldComponentUpdate=s}return i.__N||i.__}function et(n,e){var t=Te(ae++,3);!D.__s&&St(t.__H,e)&&(t.__=n,t.i=e,I.__H.__h.push(t))}function Ye(n,e){var t=Te(ae++,4);!D.__s&&St(t.__H,e)&&(t.__=n,t.i=e,I.__h.push(t))}function $e(n){return Ie=5,tt(function(){return{current:n}},[])}function bi(n,e,t){Ie=6,Ye(function(){return typeof n=="function"?(n(e()),function(){return n(null)}):n?(n.current=e(),function(){return n.current=null}):void 0},t==null?t:t.concat(n))}function tt(n,e){var t=Te(ae++,7);return St(t.__H,e)&&(t.__=n(),t.__H=e,t.__h=n),t.__}function Cn(n){var e=I.context[n.__c],t=Te(ae++,9);return t.c=n,e?(t.__==null&&(t.__=!0,e.sub(I)),e.props.value):n.__}function Vi(){for(var n;n=xn.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(ze),n.__H.__h.forEach(vt),n.__H.__h=[]}catch(e){n.__H.__h=[],D.__e(e,n.__v)}}D.__b=function(n){I=null,Wt&&Wt(n)},D.__=function(n,e){n&&e.__k&&e.__k.__m&&(n.__m=e.__k.__m),qt&&qt(n,e)},D.__r=function(n){Ut&&Ut(n),ae=0;var e=(I=n.__c).__H;e&&(at===I?(e.__h=[],I.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.i=t.__N=void 0})):(e.__h.forEach(ze),e.__h.forEach(vt),e.__h=[],ae=0)),at=I},D.diffed=function(n){Rt&&Rt(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(xn.push(e)!==1&&Ot===D.requestAnimationFrame||((Ot=D.requestAnimationFrame)||wi)(Vi)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.i=void 0})),at=I=null},D.__c=function(n,e){e.some(function(t){try{t.__h.forEach(ze),t.__h=t.__h.filter(function(i){return!i.__||vt(i)})}catch(i){e.some(function(s){s.__h&&(s.__h=[])}),e=[],D.__e(i,t.__v)}}),zt&&zt(n,e)},D.unmount=function(n){Ft&&Ft(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(i){try{ze(i)}catch(s){e=s}}),t.__H=void 0,e&&D.__e(e,t.__v))};var jt=typeof requestAnimationFrame=="function";function wi(n){var e,t=function(){clearTimeout(i),jt&&cancelAnimationFrame(e),setTimeout(n)},i=setTimeout(t,100);jt&&(e=requestAnimationFrame(t))}function ze(n){var e=I,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),I=e}function vt(n){var e=I;n.__c=n.__(),I=e}function St(n,e){return!n||n.length!==e.length||e.some(function(t,i){return t!==n[i]})}function kn(n,e){return typeof e=="function"?e(n):e}const xi={id:"wire",name:"Wire",category:"Conductors",prefix:"W",shapes:[["l",-15,15,15,-15]],pins:[["a",-15,15],["a",15,-15]],labels:[0,0,"cm"],device:null},Ci={id:"g",name:"Ground",category:"Conductors",prefix:"G",shapes:[["l",0,0,0,15],["l",-20,15,20,15],["l",-10,20,10,20],["l",-5,25,5,25]],pins:[["a",0,0]],labels:[0,30,"ct"],device:null},ki={id:"p",name:"Port",category:"Conductors",prefix:"P",shapes:[["l",0,-15,0,0],["c",0,-25,10]],pins:[["a",0,0]],labels:[0,-40,"cb"],device:null},ie={wire:xi,ground:Ci,port:ki};class q extends Error{name="CircuitError";constructor(e,t){super(e,t)}}class b{static number(e){return{type:"number",...e}}static string(e){return{type:"string",...e}}static temp=b.number({defaultValue:26.85,range:["real",">",-273.15],title:"device temperature in degrees Celsius"});schema=new Map;values=new Map;constructor(e){for(const[t,i]of Object.entries(e))this.schema.set(t,i)}names(){return[...this.schema.keys()]}prop(e){const t=this.schema.get(e);if(t==null){const i=this.names();throw new q(`Unknown property [${e}]. Expected one of ${i.map(s=>`[${s}]`).join(", ")}.`)}return t}from(e){for(const[t,i]of e.values.entries())this.set(t,i)}hasAll(){for(const[e,t]of this.schema.entries())if(!this.values.has(e)&&t.defaultValue==null)return!1;return!0}has(e){return this.prop(e),this.values.has(e)}set(e,t){const i=this.prop(e);switch(i.type){case"number":{Mi(i,e,t);break}case"string":{Hi(i,e,t);break}}return this.values.set(e,t),this}getNumber(e,t=null){const i=this.prop(e);if(i.type!=="number")throw new q(`Property [${e}] is not a number.`);const s=this.values.get(e)??t??i.defaultValue;if(s==null)throw new q(`Property [${e}] has no value.`);return s}getString(e,t=null){const i=this.prop(e);if(i.type!=="string")throw new q(`Property [${e}] is not a string.`);const s=this.values.get(e)??t??i.defaultValue;if(s==null)throw new q(`Property [${e}] has no value.`);return s}}function Mi(n,e,t){if(typeof t!="number")throw new q(`Invalid value for property [${e}]. Expected a number, got ${ne(t)}.`);const{range:i=["real"]}=n,[s,...r]=i;switch(s){case"real":if(!Number.isFinite(t))throw new q(`Invalid value for property [${e}]. Not a finite value.`);break;case"integer":if(!Number.isInteger(t))throw new q(`Invalid value for property [${e}]. Not an integer value.`);break}let o=0;for(;o<r.length;){const l=r[o++],a=r[o++];switch(l){case">":if(t<=a)throw new q(`Invalid value for property [${e}]. Expected a value larger than ${a}, got ${ne(t)}.`);break;case">=":if(t<a)throw new q(`Invalid value for property [${e}]. Expected a value larger than or equal to ${a}, got ${ne(t)}.`);break;case"<":if(t>=a)throw new q(`Invalid value for property [${e}]. Expected a value less than ${a}, got ${ne(t)}.`);break;case"<=":if(t>a)throw new q(`Invalid value for property [${e}]. Expected a value less than or equal to ${a}, got ${ne(t)}.`);break;case"<>":if(t===a)throw new q(`Invalid value for property [${e}]. Expected a value not equal to ${a}.`);break}}}function Hi(n,e,t){if(typeof t!="string")throw new q(`Invalid value for property [${e}]. Expected a string, got ${ne(t)}.`);const{range:i=[]}=n;if(i.length>0&&!i.includes(t))throw new q(`Invalid value for property [${e}]. Expected one of ${i.map(s=>ne(s)).join(", ")}, got ${ne(t)}.`)}function ne(n){switch(typeof n){case"string":return`"${n}"`;case"number":return String(n)}return`[${n}]`}class E{static dummy=new class extends E{static id="DUMMY";static numTerminals=0;static propertiesSchema={};static stateSchema={length:0,ops:[]};constructor(){super("DUMMY")}};static id;static numTerminals;static propertiesSchema;static stateSchema;static linear=!0;static Dc=class extends E{initTr(t,i){this.initDc(t,i)}loadTr(t,i,s){this.loadDc(t,i,s)}endTr(t,i){this.endDc(t,i)}};id;properties;state;diffs=[];constructor(e){this.id=e;const{propertiesSchema:t,stateSchema:i}=this.deviceClass;this.properties=new b(t),this.state=new Float64Array(i.length)}get deviceClass(){return this.constructor}connect(e,t){}init(e){}initDc(e,t){}loadDc(e,t,i){}endDc(e,t){}initTr(e,t){}loadTr(e,t,i){}endTr(e,t){}initAc(e){}loadAc(e,t,i){}endAc(e){}}function Si(n){const e=new Array(n);for(let t=0;t<n;t++)e[t]=yt(n);return e}function Ai(n,e=0){for(const t of n)t.fill(e)}function yt(n){return new Float64Array(n)}function Zt(n,e=0){n.fill(e)}function At(n,e){e.set(n)}function Ii(n){const e=new Int32Array(n);return Mn(e),e}function Mn(n){for(let e=0;e<n.length;e++)n[e]=e}function Hn(n,e,t){return $i(n,e,t,t)}function $i(n,e,t,i){let s=t,r=Math.abs(n[t][i]);for(t++;t<e;){const o=Math.abs(n[t][i]);o>r&&(s=t,r=o),t++}return s}function Xe(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}class Li extends Error{name="MathError";constructor(e,t){super(e,t)}}class It extends Li{name="SingularMatrixError";constructor(e){super("Singular matrix.",e)}}function Pi(n){const{size:e,A:t,x:i,b:s}=n;for(let r=0;r<e;r++){n.findPivot(r);const o=t[r][r];if(o===0)throw new It;for(let l=r;l<e;l++)t[r][l]/=o;s[r]/=o;for(let l=0;l<e;l++)if(l!==r){const a=t[l][r];for(let c=r;c<e;c++)t[l][c]-=t[r][c]*a;s[l]-=s[r]*a}}At(s,i)}function Ni(n){const{size:e,A:t,x:i,b:s}=n;for(let r=0;r<e-1;r++){n.findPivot(r);const o=t[r][r];if(o===0)throw new It;for(let l=r+1;l<e;l++){const a=t[l][r]/o;for(let c=r;c<e;c++)t[l][c]-=t[r][c]*a;s[l]-=s[r]*a}}for(let r=e-1;r>=0;r--){s[r]/=t[r][r];for(let o=r-1;o>=0;o--)s[o]-=t[o][r]*s[r]}At(s,i)}function Ti(n){const{size:e,A:t,perm:i}=n;for(let s=0;s<e;s++){Ei(t,i,e,s);const r=t[s][s];if(r===0)throw new It;for(let o=s+1;o<e;o++)t[s][o]/=r;for(let o=s+1;o<e;o++)for(let l=s+1;l<e;l++)t[o][l]-=t[o][s]*t[s][l]}}function Di(n){const{size:e,A:t,x:i,b:s,perm:r}=n;for(let o=0;o<e;o++){let l=0;for(let a=0;a<o;a++)l+=t[o][a]*i[a];i[o]=(s[r[o]]-l)/t[o][o]}for(let o=e-1;o>=0;o--){let l=0;for(let a=o+1;a<e;a++)l+=t[o][a]*s[a];s[o]=i[o]-l}At(s,i)}function Ei(n,e,t,i){const s=Hn(n,t,i);s!==i&&(Xe(n,i,s),Xe(e,i,s))}var Ce;(function(n){n.Gauss="gauss",n.GaussJordan="gauss-jordan",n.LU="lu"})(Ce||(Ce={}));class Gi{size;A;x;b;perm;constructor(e){this.size=e,this.A=Si(e),this.x=yt(e),this.b=yt(e),this.perm=Ii(e)}clear(){Ai(this.A),Zt(this.x),Zt(this.b),Mn(this.perm)}solve(e){switch(e){case Ce.Gauss:Ni(this);break;case Ce.GaussJordan:Pi(this);break;case Ce.LU:Ti(this),Di(this);break}}findPivot(e){const{size:t,A:i,b:s}=this,r=Hn(i,t,e);r!==e&&(Xe(i,e,r),Xe(s,e,r))}}var Yt;(function(n){n.Euler="euler",n.Trapezoidal="trapezoidal",n.Gear="gear"})(Yt||(Yt={}));const Xt=Symbol("tran"),Bi=Symbol("index");class Sn{[Xt];[Bi];V=0;C=0;I=0;Geq=0;Ieq=0;diff(e,t){this[Xt].diff(this,e,t)}}const Oi=6;(()=>{const n=new Array;for(let e=0;e<=Oi+1;e++)n.push(new Gi(e));return n})();class Wi extends E{static id="C";static numTerminals=2;static propertiesSchema={C:b.number({title:"capacitance",range:["real",">",0]}),V0:b.number({title:"initial voltage",defaultValue:0})};static stateSchema={length:4,ops:[{index:2,name:"V",unit:"V"},{index:3,name:"I",unit:"A"}]};diff=new Sn;na;nb;constructor(e){super(e),this.diffs.push(this.diff)}connect(e,[t,i]){this.na=t,this.nb=i}init(e){e[0]=this.properties.getNumber("C"),e[1]=this.properties.getNumber("V0")}endDc(e,t){const{na:i,nb:s}=this;e[2]=i.voltage-s.voltage,e[3]=0}loadTr(e,{time:t},i){const{diff:s,na:r,nb:o}=this,l=e[0],a=t>0?r.voltage-o.voltage:e[1];s.diff(a,l),e[2]=s.V,e[3]=s.I,i.stampConductance(r,o,s.Geq),i.stampCurrentSource(r,o,s.Ieq)}loadAc(e,t,i){const{na:s,nb:r}=this,o=e[0],l=2*Math.PI*t*o;i.stampConductance(s,r,0,l)}}class Ui extends E{static id="L";static numTerminals=2;static propertiesSchema={L:b.number({title:"inductance",range:["real",">",0]}),I0:b.number({title:"initial current",defaultValue:0})};static stateSchema={length:4,ops:[{index:2,name:"V",unit:"V"},{index:3,name:"I",unit:"A"}]};diff=new Sn;na;nb;branch;constructor(e){super(e),this.diffs.push(this.diff)}connect(e,[t,i]){this.na=t,this.nb=i,this.branch=e.makeBranch(this.na,this.nb)}init(e){e[0]=this.properties.getNumber("L"),e[1]=this.properties.getNumber("I0")}loadDc(e,t,i){const{na:s,nb:r,branch:o}=this;i.stampVoltageSource(s,r,o,0)}endDc(e,t){const{branch:i}=this;e[2]=0,e[3]=i.current}loadTr(e,{time:t},i){const{diff:s,na:r,nb:o,branch:l}=this,a=e[0],c=t>0?l.current:e[1];s.diff(c,a),e[2]=s.I,e[3]=s.V,i.stampA(l,l,-s.Geq),i.stampVoltageSource(r,o,l,s.Ieq)}loadAc(e,t,i){const{na:s,nb:r}=this,o=e[0],l=-1/(2*Math.PI*t*o);i.stampConductance(s,r,0,l)}}class Ri extends E.Dc{static id="R";static numTerminals=2;static propertiesSchema={R:b.number({title:"resistance",range:["real","<>",0]})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};na;nb;connect(e,[t,i]){this.na=t,this.nb=i}init(e){const t=this.properties.getNumber("R");e[0]=1/t}loadDc(e,t,i){const{na:s,nb:r}=this,o=e[0];i.stampConductance(s,r,o)}endDc(e,t){const{na:i,nb:s}=this,r=e[0],o=i.voltage-s.voltage,l=o*r;e[1]=o,e[2]=l}loadAc(e,t,i){const{na:s,nb:r}=this,o=e[0];i.stampConductance(s,r,o,0)}}function De(n){return n+273.15}const zi=De(26.85),Fi=1602176634e-28,qi=1380649e-29,ji=3,Zi=1.11,Yi=2/Math.PI,Xi=Math.PI/2,K=1e-12,An="npn",In="pnp",$t="nfet",Lt="pfet";function Ki(n){switch(n){case An:return 1;case In:return-1}}function $n(n){switch(n){case $t:return 1;case Lt:return-1}}function fe(n,e,t){const i=n/zi,s=t*n*(qi/Fi),r=e*Math.pow(i,ji/t)*Math.exp((i-1)*(Zi/s)),o=s*Math.log(s/Math.sqrt(2)/r);return[s,r,o]}function ce(n,e,t){if(n>=0){const i=1/t;return e*(Math.exp(i*n)-1)}else return 0}function ue(n,e,t){if(n>=0){const i=1/t;return i*e*Math.exp(i*n)}else return 0}function he(n,e,t,i){if(n>=0&&n>i&&Math.abs(n-e)>2*t)if(e>0){const s=(n-e)/t;s>0?n=e+t*(2+Math.log(s-2)):n=e-t*(2+Math.log(2-s))}else n=i;return n}function Oe(n,e){return Math.abs(n-e)>.5?n>e?e+.5:e-.5:n}class Ln extends E.Dc{static id="BJT";static numTerminals=3;static propertiesSchema={polarity:b.string({range:[An,In],title:"transistor polarity"}),Bf:b.number({defaultValue:100,range:["real",">",0],title:"forward beta"}),Br:b.number({defaultValue:1,range:["real",">",0],title:"reverse beta"}),Is:b.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),Nf:b.number({defaultValue:1,range:["real",">",0],title:"forward emission coefficient"}),Nr:b.number({defaultValue:1,range:["real",">",0],title:"reverse emission coefficient"}),Vaf:b.number({defaultValue:10,range:["real",">=",0],title:"forward Early voltage"}),Var:b.number({defaultValue:0,range:["real",">=",0],title:"reverse Early voltage"}),temp:b.temp};static stateSchema={length:16,ops:[{index:8,name:"Vbe",unit:"V"},{index:9,name:"Vbc",unit:"V"},{index:10,name:"Vce",unit:"V"},{index:11,name:"Ie",unit:"A"},{index:12,name:"Ic",unit:"A"},{index:13,name:"Ib",unit:"A"}]};static linear=!1;ne;nb;nc;connect(e,[t,i,s]){this.ne=t,this.nb=i,this.nc=s}initDc(e,t){const i=this.properties.getString("polarity"),s=this.properties.getNumber("Bf"),r=this.properties.getNumber("Br"),o=this.properties.getNumber("Is"),l=this.properties.getNumber("Nf"),a=this.properties.getNumber("Nr"),c=De(this.properties.getNumber("temp",t.temp)),f=Ki(i),h=s/(s+1),d=r/(r+1),[p,,_]=fe(c,o,l),[v,,w]=fe(c,o,a),[,y]=fe(c,o,1);e[0]=f,e[1]=h,e[2]=d,e[3]=y,e[4]=p,e[5]=v,e[6]=_,e[7]=w}eval(e,t){const{ne:i,nb:s,nc:r}=this,o=e[0],l=e[1],a=e[2],c=e[3],f=e[4],h=e[5],d=e[6],p=e[7];let _=o*(s.voltage-i.voltage),v=o*(s.voltage-r.voltage);t&&(_=he(_,o*e[8],f,d),v=he(v,o*e[9],h,p));const w=ce(_,c,f),y=ce(v,c,h),m=a*y-w,G=l*w-y,A=ue(_,c,f)+K,z=ue(v,c,h)+K;e[8]=o*_,e[9]=o*v,e[10]=o*(_-v),e[11]=o*m,e[12]=o*G,e[13]=o*-(m+G),e[14]=A,e[15]=z}loadDc(e,t,i){const{ne:s,nb:r,nc:o}=this;this.eval(e,!0);const l=e[0],a=e[1],c=e[2],f=l*e[8],h=l*e[9],d=l*e[11],p=l*e[12],_=e[14],v=e[15],w=-_,y=-v,m=c*v,G=a*_;i.stampConductance(s,r,-w),i.stampConductance(o,r,-y),i.stampTransconductance(s,r,o,r,-m),i.stampTransconductance(o,r,s,r,-G),i.stampCurrentSource(s,r,l*(d-w*f-m*h)),i.stampCurrentSource(o,r,l*(p-G*f-y*h))}endDc(e,t){this.eval(e,!1)}}class nt extends E.Dc{static id="Diode";static numTerminals=2;static propertiesSchema={Is:b.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:b.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:b.temp};static stateSchema={length:7,ops:[{index:4,name:"V",unit:"V"},{index:5,name:"I",unit:"A"}]};static linear=!1;na;nc;connect(e,[t,i]){this.na=t,this.nc=i}initDc(e,t){const i=this.properties.getNumber("Is"),s=this.properties.getNumber("N"),r=De(this.properties.getNumber("temp",t.temp)),[o,l,a]=fe(r,i,s);e[0]=l,e[2]=o,e[3]=a}eval(e,t){const{na:i,nc:s}=this,r=e[0],o=e[2],l=e[3];let a=i.voltage-s.voltage;t&&(a=he(a,e[4],o,l));const c=ce(a,r,o),f=ue(a,r,o)+K;e[4]=a,e[5]=c,e[6]=f}loadDc(e,t,i){const{na:s,nc:r}=this;this.eval(e,!0);const o=e[4],l=e[5],a=e[6];i.stampConductance(s,r,a),i.stampCurrentSource(s,r,l-a*o)}endDc(e,t){this.eval(e,!1)}}class Pn extends E.Dc{static id="JFET";static numTerminals=3;static propertiesSchema={polarity:b.string({range:[$t,Lt],title:"transistor polarity"}),Vth:b.number({defaultValue:-2,range:["real"],title:"threshold voltage"}),beta:b.number({defaultValue:1e-4,range:["real",">",0],title:"transconductance parameter"}),lambda:b.number({defaultValue:0,range:["real",">=",0],title:"channel-length modulation parameter"}),Is:b.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:b.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:b.temp};static stateSchema={length:17,ops:[{index:7,name:"Vgs",unit:"V"},{index:10,name:"Vgd",unit:"V"},{index:13,name:"Vds",unit:"V"},{index:14,name:"Ids",unit:"A"}]};static linear=!1;ns;ng;nd;connect(e,[t,i,s]){this.ns=t,this.ng=i,this.nd=s}initDc(e,t){const i=this.properties.getString("polarity"),s=this.properties.getNumber("Vth"),r=this.properties.getNumber("beta"),o=this.properties.getNumber("lambda"),l=this.properties.getNumber("Is"),a=this.properties.getNumber("N"),c=De(this.properties.getNumber("temp",t.temp)),f=$n(i),[h,d,p]=fe(c,l,a);e[0]=f,e[1]=s,e[2]=r,e[3]=o,e[4]=d,e[5]=h,e[6]=p}eval(e,t){const{ns:i,ng:s,nd:r}=this,o=e[0],l=e[1],a=e[2],c=e[3],f=e[4],h=e[5],d=e[6];let p=o*(s.voltage-i.voltage),_=o*(s.voltage-r.voltage);t&&(p=he(p,o*e[7],h,d),_=he(_,o*e[10],h,d));const v=p-_,w=ce(p,f,h),y=ue(p,f,h)+K,m=ce(_,f,h),G=ue(_,f,h)+K;let A,z,F;if(p>=_){const k=p-l;if(k<=0)A=0,z=K,F=0;else{const P=c*v,B=a*(1+P);k<=v?(A=B*k*k,z=a*c*k*k,F=2*B*k):(A=B*v*(2*k-v),z=2*B*(k-v)+a*P*(2*k-v),F=2*B*v)}}else{const k=_-l;if(k<=0)A=0,z=K,F=0;else{const P=-v,B=c*P,M=a*(1+B);k<=P?(A=-M*k*k,z=a*c*k*k+2*M*k,F=-2*M*k):(A=-M*P*(2*k-P),z=2*M*k+a*B*(2*k-P),F=-2*M*P)}}e[7]=o*p,e[10]=o*_,e[13]=o*v,e[8]=o*w,e[9]=y,e[11]=o*m,e[12]=G,e[14]=o*A,e[15]=z,e[16]=F}loadDc(e,t,i){const{ns:s,ng:r,nd:o}=this;this.eval(e,!0);const l=e[0],a=l*e[7],c=l*e[8],f=e[9],h=l*e[10],d=l*e[11],p=e[15],_=l*e[13],v=l*e[14],w=e[15],y=e[16];i.stampConductance(r,s,f),i.stampCurrentSource(r,s,l*(c-f*a)),i.stampConductance(r,o,p),i.stampCurrentSource(r,o,l*(d-p*h)),i.stampConductance(o,s,w),i.stampTransconductance(o,s,r,s,y),i.stampCurrentSource(o,s,l*(v-w*_-y*a))}endDc(e,t){this.eval(e,!1)}}class Nn extends E.Dc{static id="MOSFET";static numTerminals=4;static propertiesSchema={polarity:b.string({range:[$t,Lt],title:"transistor polarity"}),Vth:b.number({range:["real"],title:"threshold voltage"}),beta:b.number({defaultValue:.02,range:["real",">",0],title:"transconductance parameter"}),lambda:b.number({defaultValue:0,range:["real",">=",0],title:"channel-length modulation parameter"}),Is:b.number({defaultValue:1e-14,range:["real",">",0],title:"saturation current"}),N:b.number({defaultValue:1,range:["real",">",0],title:"emission coefficient"}),temp:b.temp};static stateSchema={length:19,ops:[{index:13,name:"Vgs",unit:"V"},{index:14,name:"Vgd",unit:"V"},{index:15,name:"Vds",unit:"V"},{index:16,name:"Ids",unit:"A"}]};static linear=!1;ns;ng;nd;nb;connect(e,[t,i,s,r]){this.ns=t,this.ng=i,this.nd=s,this.nb=r}initDc(e,t){const i=this.properties.getString("polarity"),s=this.properties.getNumber("Vth"),r=this.properties.getNumber("beta"),o=this.properties.getNumber("lambda"),l=this.properties.getNumber("Is"),a=this.properties.getNumber("N"),c=De(this.properties.getNumber("temp",t.temp)),f=$n(i),[h,d,p]=fe(c,l,a);e[0]=f,e[1]=s,e[2]=r,e[3]=o,e[4]=d,e[5]=h,e[6]=p}eval(e,t){const{ns:i,ng:s,nd:r,nb:o}=this,l=e[0],a=e[1],c=e[2],f=e[3],h=e[4],d=e[5],p=e[6];let _=l*(o.voltage-i.voltage),v=l*(o.voltage-r.voltage),w=e[13]=l*(s.voltage-i.voltage),y=e[14]=l*(s.voltage-r.voltage),m=w-y;t&&(_=he(_,l*e[7],d,p),v=he(v,l*e[10],d,p),m>0?(w=Oe(w,l*e[13]),m=Oe(w-y,l*e[15])):(y=Oe(y,l*e[14]),m=Oe(w-y,l*e[15])));const G=ce(_,h,d),A=ue(_,h,d)+K,z=ce(v,h,d),F=ue(v,h,d)+K;let k,P,B;if(m>0){const M=w-l*a;if(M<=0)k=0,P=K,B=0;else{const O=f*m,j=c*(1+O);M<=m?(k=1/2*j*M*M,P=1/2*c*f*M*M,B=j*M):(k=j*m*(M-m/2),P=j*(M-m)+c*O*(M-m/2),B=j*m)}}else{const M=y-l*a;if(M<=0)k=0,P=K,B=0;else{const O=-m,j=f*O,Ve=c*(1+j);M<=O?(k=-.5*Ve*M*M,P=1/2*c*f*M*M,B=Ve*M):(k=-Ve*O*(M-O/2),P=Ve*M+c*j*(M-O/2),B=Ve*O)}}e[7]=l*_,e[10]=l*v,e[13]=l*w,e[14]=l*y,e[15]=l*m,e[8]=l*G,e[9]=A,e[11]=l*z,e[12]=F,e[16]=l*k,e[17]=P,e[18]=B}loadDc(e,t,i){const{ns:s,ng:r,nd:o,nb:l}=this;this.eval(e,!0);const a=e[0],c=a*e[7],f=a*e[10],h=a*e[13],d=a*e[14],p=a*e[15],_=a*e[8],v=e[9],w=a*e[11],y=e[12],m=a*e[16],G=e[17],A=e[18];i.stampConductance(l,s,v),i.stampCurrentSource(l,s,a*(_-v*c)),i.stampConductance(l,o,y),i.stampCurrentSource(l,o,a*(w-y*f)),p>0?(i.stampConductance(o,s,G),i.stampTransconductance(o,s,r,s,A),i.stampCurrentSource(o,s,a*(m-G*p-A*h))):(i.stampConductance(o,s,G),i.stampTransconductance(o,s,r,o,A),i.stampCurrentSource(o,s,a*(m-G*p-A*d)))}endDc(e,t){this.eval(e,!1)}}class Ji extends E.Dc{static id="OpAmp";static numTerminals=3;static propertiesSchema={gain:b.number({defaultValue:1e6,range:["real",">",0],title:"gain"}),Vmax:b.number({defaultValue:15,range:["real",">",0],title:"maximum absolute value of output voltage"})};static stateSchema={length:5,ops:[{index:2,name:"Vin",unit:"V"},{index:3,name:"Vout",unit:"V"}]};static linear=!1;np;nn;no;branch;connect(e,[t,i,s]){this.np=t,this.nn=i,this.no=s,this.branch=e.makeBranch(this.no,e.groundNode)}init(e){const t=this.properties.getNumber("gain"),i=this.properties.getNumber("Vmax");e[0]=t,e[1]=i}loadDc(e,t,i){const{np:s,nn:r,no:o,branch:l}=this,a=e[0],c=e[1],f=s.voltage-r.voltage,h=Xi*a*f/c,d=c*Yi*Math.atan(h),p=a/(1+h*h)+K;e[2]=f,e[3]=d,e[4]=p,i.stampA(o,l,1),i.stampA(l,s,p),i.stampA(l,r,-p),i.stampA(l,o,-1),i.stampB(l,p*f-d)}}class Qi extends E.Dc{static id="Ammeter";static numTerminals=2;static propertiesSchema={};static stateSchema={length:1,ops:[{index:0,name:"I",unit:"A"}]};np;nn;branch;connect(e,[t,i]){this.np=t,this.nn=i,this.branch=e.makeBranch(this.np,this.nn)}loadDc(e,t,i){const{np:s,nn:r,branch:o}=this;i.stampVoltageSource(s,r,o,0)}endDc(e,t){const{branch:i}=this;e[0]=i.current}}class es extends E.Dc{static id="Voltmeter";static numTerminals=2;static propertiesSchema={};static stateSchema={length:1,ops:[{index:0,name:"V",unit:"V"}]};np;nn;connect(e,[t,i]){this.np=t,this.nn=i}endDc(e,t){const{np:i,nn:s}=this;e[0]=i.voltage-s.voltage}}class Rl extends E.Dc{static id="CCCS";static numTerminals=4;static propertiesSchema={gain:b.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;ncp;ncn;branch;connect(e,[t,i,s,r]){this.np=t,this.nn=i,this.ncp=s,this.ncn=r,this.branch=e.makeBranch(this.ncp,this.ncn)}init(e){e[0]=this.properties.getNumber("gain")}loadDc(e,t,i){const{np:s,nn:r,ncp:o,ncn:l,branch:a}=this,c=e[0];i.stampVoltageSource(o,l,a,0),i.stampA(s,a,c),i.stampA(r,a,-c)}endDc(e,t){const{np:i,nn:s,branch:r}=this,o=e[0],l=r.current*o,a=i.voltage-s.voltage;e[1]=l,e[2]=a}}class zl extends E.Dc{static id="CCVS";static numTerminals=4;static propertiesSchema={gain:b.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;ncp;ncn;branch1;branch2;connect(e,[t,i,s,r]){this.np=t,this.nn=i,this.ncp=s,this.ncn=r,this.branch1=e.makeBranch(this.np,this.nn),this.branch2=e.makeBranch(this.ncp,this.ncn)}init(e){e[0]=this.properties.getNumber("gain")}loadDc(e,t,i){const{np:s,nn:r,branch1:o,ncp:l,ncn:a,branch2:c}=this,f=e[0];i.stampVoltageSource(s,r,o,0),i.stampVoltageSource(l,a,c,0),i.stampA(o,c,-f)}endDc(e,t){const{np:i,nn:s,branch1:r}=this,o=i.voltage-s.voltage,l=r.current;e[1]=o,e[2]=l}}class Fl extends E{static id="Iac";static numTerminals=2;static propertiesSchema={I:b.number({title:"amplitude"}),f:b.number({title:"frequency"}),phase:b.number({title:"phase",defaultValue:0})};static stateSchema={length:5,ops:[{index:3,name:"I",unit:"A"},{index:4,name:"V",unit:"V"}]};np;nn;connect(e,[t,i]){this.np=t,this.nn=i}init(e){const t=this.properties.getNumber("I"),i=this.properties.getNumber("f"),s=this.properties.getNumber("phase"),r=2*Math.PI*i,o=s/180*Math.PI;e[0]=t,e[1]=r,e[2]=o}endDc(e,t){e[3]=0,e[4]=0}loadTr(e,{time:t,sourceFactor:i},s){const{np:r,nn:o}=this,l=e[0],a=e[1],c=e[2],f=i*l*Math.sin(a*t+c);e[3]=f,s.stampCurrentSource(r,o,f)}endTr(e,t){const{np:i,nn:s}=this;e[4]=i.voltage-s.voltage}loadAc(e,t,i){const{np:s,nn:r}=this,o=e[0],l=e[2],a=o*Math.cos(l),c=o*Math.sin(l);i.stampCurrentSource(s,r,a,c)}}class ts extends E.Dc{static id="I";static numTerminals=2;static propertiesSchema={I:b.number({title:"current"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;connect(e,[t,i]){this.np=t,this.nn=i}init(e){e[0]=this.properties.getNumber("I")}loadDc(e,{sourceFactor:t},i){const{np:s,nn:r}=this,o=e[0],l=t*o;e[1]=l,i.stampCurrentSource(s,r,l)}endDc(e,t){const{np:i,nn:s}=this;e[2]=i.voltage-s.voltage}}class ql extends E{static id="Vac";static numTerminals=2;static propertiesSchema={V:b.number({title:"amplitude"}),f:b.number({title:"frequency"}),phase:b.number({title:"phase",defaultValue:0})};static stateSchema={length:5,ops:[{index:3,name:"V",unit:"V"},{index:4,name:"I",unit:"A"}]};np;nn;branch;connect(e,[t,i]){this.np=t,this.nn=i,this.branch=e.makeBranch(this.np,this.nn)}init(e){const t=this.properties.getNumber("V"),i=this.properties.getNumber("f"),s=this.properties.getNumber("phase"),r=2*Math.PI*i,o=s/180*Math.PI;e[0]=t,e[1]=r,e[2]=o}loadDc(e,t,i){const{np:s,nn:r,branch:o}=this;i.stampVoltageSource(s,r,o,0)}endDc(e,t){e[3]=0,e[4]=0}loadTr(e,{time:t,sourceFactor:i},s){const{np:r,nn:o,branch:l}=this,a=e[0],c=e[1],f=e[2],h=i*a*Math.sin(c*t+f);e[3]=h,s.stampVoltageSource(r,o,l,h)}endTr(e,t){const{branch:i}=this,s=i.current;e[4]=s}loadAc(e,t,i){const{np:s,nn:r,branch:o}=this,l=e[0],a=e[2],c=l*Math.cos(a),f=l*Math.sin(a);i.stampVoltageSource(s,r,o,c,f)}}class jl extends E.Dc{static id="VCCS";static numTerminals=4;static propertiesSchema={gain:b.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"I",unit:"A"},{index:2,name:"V",unit:"V"}]};np;nn;ncp;ncn;branch;connect(e,[t,i,s,r]){this.np=t,this.nn=i,this.ncp=s,this.ncn=r,this.branch=e.makeBranch(this.np,this.nn)}init(e){e[0]=this.properties.getNumber("gain")}loadDc(e,t,i){const{np:s,nn:r,ncp:o,ncn:l,branch:a}=this,c=e[0];i.stampA(s,a,1),i.stampA(r,a,-1),i.stampA(a,o,c),i.stampA(a,l,-c),i.stampA(a,a,-1)}endDc(e,t){const{np:i,nn:s,branch:r}=this;e[1]=r.current,e[2]=i.voltage-s.voltage}}class Zl extends E.Dc{static id="VCVS";static numTerminals=4;static propertiesSchema={gain:b.number({title:"gain"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;ncp;ncn;branch;connect(e,[t,i,s,r]){this.np=t,this.nn=i,this.ncp=s,this.ncn=r,this.branch=e.makeBranch(this.np,this.nn)}init(e){e[0]=this.properties.getNumber("gain")}loadDc(e,t,i){const{np:s,nn:r,ncp:o,ncn:l,branch:a}=this,c=e[0];i.stampVoltageSource(s,r,a,0),i.stampA(a,o,-c),i.stampA(a,l,c)}endDc(e,t){const{np:i,nn:s,branch:r}=this;e[1]=i.voltage-s.voltage,e[2]=r.current}}class ns extends E.Dc{static id="V";static numTerminals=2;static propertiesSchema={V:b.number({title:"voltage"})};static stateSchema={length:3,ops:[{index:1,name:"V",unit:"V"},{index:2,name:"I",unit:"A"}]};np;nn;branch;connect(e,[t,i]){this.np=t,this.nn=i,this.branch=e.makeBranch(this.np,this.nn)}init(e){e[0]=this.properties.getNumber("V")}loadDc(e,{sourceFactor:t},i){const{np:s,nn:r,branch:o}=this,l=e[0],a=t*l;e[1]=a,i.stampVoltageSource(s,r,o,a)}endDc(e,t){const{branch:i}=this;e[2]=i.current}}const is={id:"r",name:"Resistor",category:"Linear",prefix:"R",shapes:[["l",0,-30,0,-20],["l",-8,-20,8,-20],["l",-8,20,8,20],["l",-8,-20,-8,20],["l",8,-20,8,20],["l",0,30,0,20]],pins:[["a",0,-30],["b",0,30]],labels:[15,0,"lm"],device:Ri},ss={id:"c",name:"Capacitor",category:"Linear",prefix:"C",shapes:[["l",0,-30,0,-6],["l",-20,-6,20,-6],["l",-20,6,20,6],["l",0,30,0,6]],pins:[["a",0,-30],["b",0,30]],labels:[30,0,"lm"],device:Wi},rs={id:"l",name:"Inductor",category:"Linear",prefix:"L",shapes:[["l",0,-30,0,-22],["a",0,-14,7,-90,90],["a",0,0,7,-90,90],["a",0,14,7,-90,90],["l",0,30,0,22]],pins:[["a",0,-30],["b",0,30]],labels:[15,0,"lm"],device:Ui},Fe={resistor:is,capacitor:ss,inductor:rs},it=(n,e,t,i,s=10)=>{const r=Math.atan2(i-e,t-n),o=r-Math.PI/6,l=r+Math.PI/6;return[["l",n,e,t,i],["l",t,i,t-s*Math.cos(o),i-s*Math.sin(o)],["l",t,i,t-s*Math.cos(l),i-s*Math.sin(l)]]},os={id:"d",name:"Diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-15,-11,15,-11],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:nt},ls={id:"dz",name:"Zener diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-20,-5,-15,-11],["l",-15,-11,15,-11],["l",15,-11,20,-17],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:nt},as={id:"ds",name:"Schottky diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-10],["l",-9,-17,-15,-17],["l",-15,-17,-15,-11],["l",-15,-11,15,-11],["l",15,-11,15,-5],["l",15,-5,9,-5],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:nt},cs={id:"dv",name:"Varicap diode",category:"Nonlinear",prefix:"D",shapes:[["l",0,-30,0,-17],["l",-15,-17,15,-17],["l",-15,-11,15,-11],["l",0,-10,-15,10],["l",0,-10,15,10],["l",-15,10,15,10],["l",0,30,0,10]],pins:[["a",0,-30],["b",0,30]],labels:[20,0,"lm"],device:nt},us={id:"npn",name:"NPN bipolar junction transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-20],["l",0,30,0,20],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",-20,-5,0,-20],...it(-20,5,0,20)],pins:[["c",0,-30],["e",0,30],["b",-30,0]],labels:[10,0,"lm"],device:Ln},hs={id:"pnp",name:"PNP bipolar junction transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-20],["l",0,30,0,20],["l",-30,0,-20,0],["l",-20,-15,-20,15],...it(0,-20,-20,-5),["l",0,20,-20,5]],pins:[["e",0,-30],["c",0,30],["b",-30,0]],labels:[10,0,"lm"],device:Ln},fs={id:"nfet",name:"N-channel junction field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,10],["l",-30,0,-12,0],["l",0,-10,-12,-10],["l",0,10,-12,10],["l",-12,-15,-12,15],["l",-21,-5,-15,0],["l",-21,5,-15,0]],pins:[["d",0,-30],["s",0,30],["g",-30,0]],labels:[10,0,"lm"],device:Pn},ps={id:"pfet",name:"P-channel junction field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,10],["l",-30,0,-12,0],["l",0,-10,-12,-10],["l",0,10,-12,10],["l",-12,-15,-12,15],["l",-21,0,-15,-5],["l",-21,0,-15,5]],pins:[["s",0,-30],["d",0,30],["g",-30,0]],labels:[10,0,"lm"],device:Pn},ds={id:"nmos",name:"N-channel MOS field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,-10],["l",0,30,0,0],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",0,-10,-15,-10],["l",-15,-15,-15,-6],["l",0,0,-15,0],["l",-15,-3,-15,3],["l",-13,0,-8,-4],["l",-13,0,-8,4],["l",0,10,-15,10],["l",-15,15,-15,6]],pins:[["d",0,-30],["s",0,30],["g",-30,0]],labels:[10,0,"lm"],device:Nn},_s={id:"pmos",name:"P-channel MOS field-effect transistor",category:"Nonlinear",prefix:"Q",shapes:[["l",0,-30,0,0],["l",0,30,0,10],["l",-30,0,-20,0],["l",-20,-15,-20,15],["l",0,-10,-15,-10],["l",-15,-15,-15,-6],["l",0,0,-15,0],["l",-15,-3,-15,3],["l",-6,-4,-1,0],["l",-6,4,-1,0],["l",0,10,-15,10],["l",-15,15,-15,6]],pins:[["s",0,-30],["d",0,30],["g",-30,0]],labels:[10,0,"lm"],device:Nn},ms={id:"opamp",name:"Operational amplifier",category:"Nonlinear",prefix:"OA",shapes:[["l",-50,-30,-30,-30],["l",-50,30,-30,30],["l",30,0,50,0],["l",-30,-50,30,0],["l",-30,50,30,0],["l",-30,-50,-30,50],["l",-25,-30,-15,-30],["l",-20,-35,-20,-25],["l",-25,30,-15,30]],pins:[["noninv",-50,-30],["inv",-50,30],["out",50,0]],labels:[-30,55,"lt"],device:Ji},Z={diode:os,zener:ls,schottky:as,varicap:cs,npn:us,pnp:hs,nfet:fs,pfet:ps,nmos:ds,pmos:_s,opamp:ms},vs={id:"vmeter",name:"Voltmeter",category:"Probes",prefix:"Pr",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,30,0,20],["t",0,0,"cm","V"],...it(-25,25,25,-25)],pins:[["a",0,-30],["b",0,30]],labels:[25,0,"lm"],device:es},ys={id:"ameter",name:"Ammeter",category:"Probes",prefix:"Pr",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,30,0,20],["t",0,0,"cm","A"],...it(-25,25,25,-25)],pins:[["a",0,-30],["b",0,30]],labels:[25,0,"lm"],device:Qi},gs={vmeter:vs,ameter:ys},bs={id:"vdc",name:"Ideal DC voltage source",category:"Sources",prefix:"V",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,-15,0,-5],["l",-5,-10,5,-10],["l",-5,10,5,10],["l",0,30,0,20]],pins:[["pos",0,-30],["neg",0,30]],labels:[25,0,"lm"],device:ns},Vs={id:"idc",name:"Ideal DC current source",category:"Sources",prefix:"I",shapes:[["l",0,-30,0,-20],["c",0,0,20],["l",0,10,0,-10],["l",0,-11,-5,-3],["l",0,-11,5,-3],["l",0,30,0,20]],pins:[["pos",0,-30],["neg",0,30]],labels:[25,0,"lm"],device:ts},Le={vdc:bs,idc:Vs};class ws{#e=new Map;constructor(e){for(const t of e)this.#e.set(t.id,t)}[Symbol.iterator](){return this.#e.values()}get(e){const t=this.#e.get(e);if(t==null)throw new Error(`Unknown symbol [${e}]`);return t}}const Tn=new ws([...Object.values(ie),...Object.values(Fe),...Object.values(Z),...Object.values(Le),...Object.values(gs)]);var xs=Symbol.for("preact-signals");function st(){if(se>1)se--;else{for(var n,e=!1;ke!==void 0;){var t=ke;for(ke=void 0,gt++;t!==void 0;){var i=t.o;if(t.o=void 0,t.f&=-3,!(8&t.f)&&En(t))try{t.c()}catch(s){e||(n=s,e=!0)}t=i}}if(gt=0,se--,e)throw n}}function Cs(n){if(se>0)return n();se++;try{return n()}finally{st()}}var S=void 0,ke=void 0,se=0,gt=0,Ke=0;function Dn(n){if(S!==void 0){var e=n.n;if(e===void 0||e.t!==S)return e={i:0,S:n,p:S.s,n:void 0,t:S,e:void 0,x:void 0,r:e},S.s!==void 0&&(S.s.n=e),S.s=e,n.n=e,32&S.f&&n.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=S.s,e.n=void 0,S.s.n=e,S.s=e),e}}function R(n){this.v=n,this.i=0,this.n=void 0,this.t=void 0}R.prototype.brand=xs;R.prototype.h=function(){return!0};R.prototype.S=function(n){this.t!==n&&n.e===void 0&&(n.x=this.t,this.t!==void 0&&(this.t.e=n),this.t=n)};R.prototype.U=function(n){if(this.t!==void 0){var e=n.e,t=n.x;e!==void 0&&(e.x=t,n.e=void 0),t!==void 0&&(t.e=e,n.x=void 0),n===this.t&&(this.t=t)}};R.prototype.subscribe=function(n){var e=this;return Ge(function(){var t=e.value,i=S;S=void 0;try{n(t)}finally{S=i}})};R.prototype.valueOf=function(){return this.value};R.prototype.toString=function(){return this.value+""};R.prototype.toJSON=function(){return this.value};R.prototype.peek=function(){var n=S;S=void 0;try{return this.value}finally{S=n}};Object.defineProperty(R.prototype,"value",{get:function(){var n=Dn(this);return n!==void 0&&(n.i=this.i),this.v},set:function(n){if(n!==this.v){if(gt>100)throw new Error("Cycle detected");this.v=n,this.i++,Ke++,se++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{st()}}}});function ee(n){return new R(n)}function En(n){for(var e=n.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function Gn(n){for(var e=n.s;e!==void 0;e=e.n){var t=e.S.n;if(t!==void 0&&(e.r=t),e.S.n=e,e.i=-1,e.n===void 0){n.s=e;break}}}function Bn(n){for(var e=n.s,t=void 0;e!==void 0;){var i=e.p;e.i===-1?(e.S.U(e),i!==void 0&&(i.n=e.n),e.n!==void 0&&(e.n.p=i)):t=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=i}n.s=t}function ye(n){R.call(this,void 0),this.x=n,this.s=void 0,this.g=Ke-1,this.f=4}(ye.prototype=new R).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Ke))return!0;if(this.g=Ke,this.f|=1,this.i>0&&!En(this))return this.f&=-2,!0;var n=S;try{Gn(this),S=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(t){this.v=t,this.f|=16,this.i++}return S=n,Bn(this),this.f&=-2,!0};ye.prototype.S=function(n){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}R.prototype.S.call(this,n)};ye.prototype.U=function(n){if(this.t!==void 0&&(R.prototype.U.call(this,n),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};ye.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var n=this.t;n!==void 0;n=n.x)n.t.N()}};Object.defineProperty(ye.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var n=Dn(this);if(this.h(),n!==void 0&&(n.i=this.i),16&this.f)throw this.v;return this.v}});function Kt(n){return new ye(n)}function On(n){var e=n.u;if(n.u=void 0,typeof e=="function"){se++;var t=S;S=void 0;try{e()}catch(i){throw n.f&=-2,n.f|=8,Pt(n),i}finally{S=t,st()}}}function Pt(n){for(var e=n.s;e!==void 0;e=e.n)e.S.U(e);n.x=void 0,n.s=void 0,On(n)}function ks(n){if(S!==this)throw new Error("Out-of-order effect");Bn(this),S=n,this.f&=-2,8&this.f&&Pt(this),st()}function Ee(n){this.x=n,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Ee.prototype.c=function(){var n=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{n()}};Ee.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,On(this),Gn(this),se++;var n=S;return S=this,ks.bind(this,n)};Ee.prototype.N=function(){2&this.f||(this.f|=2,this.o=ke,ke=this)};Ee.prototype.d=function(){this.f|=8,1&this.f||Pt(this)};function Ge(n){var e=new Ee(n);try{e.c()}catch(t){throw e.d(),t}return e.d.bind(e)}var Wn,ct,Un=[];Ge(function(){Wn=this.N})();function ge(n,e){V[n]=e.bind(null,V[n]||function(){})}function Je(n){ct&&ct(),ct=n&&n.S()}function Rn(n){var e=this,t=n.data,i=Hs(t);i.value=t;var s=tt(function(){for(var l=e,a=e.__v;a=a.__;)if(a.__c){a.__c.__$f|=4;break}var c=Kt(function(){var p=i.value.value;return p===0?0:p===!0?"":p||""}),f=Kt(function(){return!pn(c.value)}),h=Ge(function(){if(this.N=zn,f.value){var p=c.value;l.base&&l.base.nodeType===3&&(l.base.data=p)}}),d=e.__$u.d;return e.__$u.d=function(){h(),d.call(this)},[f,c]},[]),r=s[0],o=s[1];return r.value?o.peek():o.value}Rn.displayName="_st";Object.defineProperties(R.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Rn},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});ge("__b",function(n,e){if(typeof e.type=="string"){var t,i=e.props;for(var s in i)if(s!=="children"){var r=i[s];r instanceof R&&(t||(e.__np=t={}),t[s]=r,i[s]=r.peek())}}n(e)});ge("__r",function(n,e){Je();var t,i=e.__c;i&&(i.__$f&=-2,(t=i.__$u)===void 0&&(i.__$u=t=function(s){var r;return Ge(function(){r=this}),r.c=function(){i.__$f|=1,i.setState({})},r}())),Je(t),n(e)});ge("__e",function(n,e,t,i){Je(),n(e,t,i)});ge("diffed",function(n,e){Je();var t;if(typeof e.type=="string"&&(t=e.__e)){var i=e.__np,s=e.props;if(i){var r=t.U;if(r)for(var o in r){var l=r[o];l!==void 0&&!(o in i)&&(l.d(),r[o]=void 0)}else r={},t.U=r;for(var a in i){var c=r[a],f=i[a];c===void 0?(c=Ms(t,a,f,s),r[a]=c):c.o(f,s)}}}n(e)});function Ms(n,e,t,i){var s=e in n&&n.ownerSVGElement===void 0,r=ee(t);return{o:function(o,l){r.value=o,i=l},d:Ge(function(){this.N=zn;var o=r.value.value;i[e]!==o&&(i[e]=o,s?n[e]=o:o?n.setAttribute(e,o):n.removeAttribute(e))})}}ge("unmount",function(n,e){if(typeof e.type=="string"){var t=e.__e;if(t){var i=t.U;if(i){t.U=void 0;for(var s in i){var r=i[s];r&&r.d()}}}}else{var o=e.__c;if(o){var l=o.__$u;l&&(o.__$u=void 0,l.d())}}n(e)});ge("__h",function(n,e,t,i){(i<3||i===9)&&(e.__$f|=2),n(e,t,i)});J.prototype.shouldComponentUpdate=function(n,e){var t=this.__$u,i=t&&t.s!==void 0;for(var s in e)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var r=2&this.__$f;if(!(i||r||4&this.__$f)||1&this.__$f)return!0}else if(!(i||4&this.__$f)||3&this.__$f)return!0;for(var o in n)if(o!=="__source"&&n[o]!==this.props[o])return!0;for(var l in this.props)if(!(l in n))return!0;return!1};function Hs(n){return tt(function(){return ee(n)},[])}var Ss=function(n){queueMicrotask(function(){queueMicrotask(n)})};function As(){Cs(function(){for(var n;n=Un.shift();)Wn.call(n)})}function zn(){Un.push(this)===1&&(V.requestAnimationFrame||Ss)(As)}const{round:g}=Math,Is=(n,e)=>n.x0<=e.x0&&e.x0<=n.x1&&n.y0<=e.y0&&e.y0<=n.y1||n.x0<=e.x0&&e.x0<=n.x1&&n.y0<=e.y1&&e.y1<=n.y1||n.x0<=e.x1&&e.x1<=n.x1&&n.y0<=e.y0&&e.y0<=n.y1||n.x0<=e.x1&&e.x1<=n.x1&&n.y0<=e.y1&&e.y1<=n.y1,$s=(n,e)=>n.x0<=e.x0&&e.x0<=n.x1&&n.x0<=e.x1&&e.x1<=n.x1&&n.y0<=e.y0&&e.y0<=n.y1&&n.y0<=e.y1&&e.y1<=n.y1;let Ls=0;function Ps(){return Ls+=1}class Ns{#e=Ps();get id(){return this.#e}}let Nt=class extends Ns{moveTo(e,t){return this}includes(e,t){const{x0:i,y0:s,x1:r,y1:o}=this.area;return i<=e&&e<=r&&s<=t&&t<=o}};function Jt(n,e,t,i=null){for(const s of n)if((i==null||i===s.type)&&s.includes(e,t))return s;return null}function Fn(n){const e={x:1/0,y:1/0},t={x:-1/0,y:-1/0};for(const{area:i}of n)e.x=Math.min(e.x,i.x0),e.y=Math.min(e.y,i.y0),t.x=Math.max(t.x,i.x1),t.y=Math.max(t.y,i.y1);return e.x<t.x&&e.y<t.y?{x0:e.x,y0:e.y,x1:t.x,y1:t.y}:{x0:0,y0:0,x1:0,y1:0}}class rt extends Nt{type="formula";#e;#i;#n;#t;#r=null;constructor(e,t="cm",i=0,s=0){super(),this.#e=e,this.#i=t,this.#n=i,this.#t=s,this.#r=null}get text(){return this.#e}set text(e){this.#e=e}get align(){return this.#i}set align(e){this.#i=e}get x(){return this.#n}get y(){return this.#t}get area(){return this.#r??={x0:this.#n,y0:this.#t,x1:this.#n+50,y1:this.#t+50}}moveTo(e,t){return this.#n=e,this.#t=t,this.#r=null,this}}const N=4,$=2,L=1,Ts=[N|$|L,N|L,N|$,N,0,$,L,$|L],Ds=[N,N|$,N|L,N|$|L,$|L,L,$,0],Es=[$,$|L,0,L,N|$,N|L|$,N,N|L],Gs=[L,0,$|L,$,N|L,N,N|$|L,N|$],Bs=(n,e)=>{switch(e){case"rl":return Ts[n]??0;case"rr":return Ds[n]??0;case"mx":return Es[n]??0;case"my":return Gs[n]??0}return 0},Os=(n,e)=>{let[t,i,s]=n,r=0;return e&N&&(r=i,i=-s,s=r),e&$&&(i=-i),e&L&&(s=-s),[t,i,s]},qn=(n,e)=>{let t=n.charAt(0),i=n.charAt(1);if(e&$)switch(t){case"l":t="r";break;case"r":t="l";break}if(e&L)switch(i){case"t":i="b";break;case"b":i="t";break}return`${t}${i}`},Ws=(n,e)=>{switch(n[0]){case"l":return Us(n,e);case"c":return Rs(n,e);case"a":return zs(n,e);case"t":return Fs(n,e)}return n},Us=(n,e)=>{let[t,i,s,r,o]=n,l=0;return e&N&&(l=i,i=-s,s=l,l=r,r=-o,o=l),e&$&&(i=-i,r=-r),e&L&&(s=-s,o=-o),[t,i,s,r,o]},Rs=(n,e)=>{let[t,i,s,r]=n,o=0;return e&N&&(o=i,i=-s,s=o),e&$&&(i=-i),e&L&&(s=-s),[t,i,s,r]},zs=(n,e)=>{let[t,i,s,r,o,l]=n,a=0;return e&N&&(a=i,i=-s,s=a,o+=90,l+=90),e&$&&(i=-i,a=o,o=180-l,l=180-a),e&L&&(s=-s,a=o,o=-l,l=-a),[t,i,s,r,o,l]},Fs=(n,e)=>{let[t,i,s,r,o]=n;r=qn(r,e);let l=0;return e&N&&(l=i,i=-s,s=l),e&$&&(i=-i),e&L&&(s=-s),[t,i,s,r,o]},qs=(n,e)=>{let[t,i,s]=n;s=qn(s,e);let r=0;return e&N&&(r=t,t=-i,i=r),e&$&&(t=-t),e&L&&(i=-i),[t,i,s]},jn=({shapes:n,pins:e},t,i)=>{const s={x:0,y:0},r={x:0,y:0};for(const o of n)switch(o[0]){case"l":{const[l,a,c,f,h]=o;s.x=Math.min(s.x,a,f),s.y=Math.min(s.y,c,h),r.x=Math.max(r.x,a,f),r.y=Math.max(r.y,c,h);break}case"c":{const[l,a,c,f]=o;s.x=Math.min(s.x,a-f,a+f),s.y=Math.min(s.y,c-f,c+f),r.x=Math.max(r.x,a-f,a+f),r.y=Math.max(r.y,c-f,c+f);break}case"a":{const[l,a,c,f,h,d]=o;s.x=Math.min(s.x,a-f,a+f),s.y=Math.min(s.y,c-f,a+f),r.x=Math.max(r.x,a-f,c+f),r.y=Math.max(r.y,c-f,c+f);break}}for(const[o,l,a]of e)s.x=Math.min(s.x,l),s.y=Math.min(s.y,a),r.x=Math.max(r.x,l),r.y=Math.max(r.y,a);return{x0:t+s.x,y0:i+s.y,x1:t+r.x,y1:i+r.y}};class Zn{static anonymous(e){return`${e}?`}#e=new Map;constructor(e){for(const t of e)if(t instanceof te){const i=this.#i(t.symbol.prefix);i.instances.push(t),i.names.add(t.name)}}getUniqueName(e){const t=this.#i(e);let i=1;for(;;){const s=`${e}${i}`;if(!t.names.has(s))return t.names.add(s),s;i+=1}}rename(e="none"){for(const[t,i]of this.#e.entries()){switch(e){case"none":break;case"horizontal":i.instances.sort((s,r)=>s.x-r.x||s.y-r.y);break;case"vertical":i.instances.sort((s,r)=>s.y-r.y||s.x-r.x);break}i.names.clear();for(const s of i.instances)s.name=this.getUniqueName(t)}}#i(e){let t=this.#e.get(e);return t==null&&this.#e.set(e,t={instances:[],names:new Set}),t}}class te extends Nt{type="instance";#e;#i;#n;#t;#r;#s;#a=null;#u=null;#p=null;#o=null;constructor(e,t=Zn.anonymous(e.prefix),i={},s=0,r=0,o=0){super(),this.#e=e,this.#i=t,this.#n=i,this.#t=s,this.#r=r,this.#s=o}get symbol(){return this.#e}get name(){return this.#i}set name(e){this.#i=e}get props(){return this.#n}set props(e){this.#n=e}get x(){return this.#t}get y(){return this.#r}get area(){return this.#o??=jn(this,this.#t,this.#r)}moveTo(e,t){return this.#t=e,this.#r=t,this.#o=null,this}get transform(){return this.#s}transformBy(e){return this.#s=Bs(this.#s,e),this.#a=null,this.#u=null,this.#p=null,this.#o=null,this}get shapes(){return this.#a??=this.#e.shapes.map(e=>Ws(e,this.#s))}get pins(){return this.#u??=this.#e.pins.map(e=>Os(e,this.#s))}get labels(){return this.#p??=qs(this.#e.labels,this.#s)}}class U extends Nt{type="wire";#e;#i;#n;#t;#r;constructor(e,t,i,s){super(),this.#e=e,this.#i=t,this.#n=i,this.#t=s,this.#r=null}get x0(){return this.#e}set x0(e){this.#e=e,this.#r=null}get y0(){return this.#i}set y0(e){this.#i=e,this.#r=null}get x1(){return this.#n}set x1(e){this.#n=e,this.#r=null}get y1(){return this.#t}set y1(e){this.#t=e,this.#r=null}get x(){return this.#e}get y(){return this.#i}get area(){return this.#r??={x0:Math.min(this.#e,this.#n),y0:Math.min(this.#i,this.#t),x1:Math.max(this.#e,this.#n),y1:Math.max(this.#i,this.#t)}}moveTo(e,t){const i=this.#n-this.#e,s=this.#t-this.#i;return this.#e=e,this.#i=t,this.#n=e+i,this.#t=t+s,this.#r=null,this}includes(e,t){if(this.#i===this.#t){const h=this.#i,d=Math.min(this.#e,this.#n),p=Math.max(this.#e,this.#n);return d<=e&&e<=p&&h-3<=t&&t<=h+3}if(this.#e===this.#n){const h=this.#e,d=Math.min(this.#i,this.#t),p=Math.max(this.#i,this.#t);return d<=t&&t<=p&&h-3<=e&&e<=h+3}const s=Math.abs((this.#t-this.#i)*e-(this.#n-this.#e)*t+this.#n*this.#i-this.#t*this.#e),r=Math.sqrt((this.#t-this.#i)*(this.#t-this.#i)+(this.#n-this.#e)*(this.#n-this.#e)),o=s/r,l=Math.min(this.#e,this.#n),a=Math.min(this.#i,this.#t),c=Math.max(this.#e,this.#n),f=Math.max(this.#i,this.#t);return l<=e&&e<=c&&a<=t&&t<=f&&o<=3}}function js(n){const e=new Zs,t=new Ys;for(const s of n)if(s instanceof U){const{x0:r,y0:o,x1:l,y1:a}=s;if(o===a){e.addWire(o,s);continue}if(r===l){t.addWire(r,s);continue}continue}for(const s of n){if(s instanceof te){for(const[r,o,l]of s.pins){const a=s.x+o,c=s.y+l;e.split(c,a,n),t.split(a,c,n)}continue}if(s instanceof U){const{x0:r,y0:o,x1:l,y1:a}=s;if(r===l&&o===a)continue;if(o===a){t.split(r,o,n),t.split(l,o,n);continue}if(r===l){e.split(o,r,n),e.split(a,r,n);continue}t.split(r,o,n),t.split(l,a,n),e.split(o,r,n),e.split(a,l,n);continue}}e.merge(),t.merge();let i=0;for(;i<n.length;){const s=n[i];if(s instanceof U){const{x0:r,y0:o,x1:l,y1:a}=s;if(r===l&&o===a){n.splice(i,1);continue}}i+=1}}class Zs{lines=new Map;addWire(e,t){const{x0:i,x1:s}=t;t.x0=Math.min(i,s),t.x1=Math.max(i,s),t.y0=e,t.y1=e;let r=this.lines.get(e);r==null&&this.lines.set(e,r={wires:[],breakpoints:[]}),r.wires.push(t)}split(e,t,i){let s=this.lines.get(e);if(s!=null){s.breakpoints.push(t);for(const r of s.wires)if(r.x0<t&&t<r.x1){const o=new U(t,e,r.x1,e);i.push(o),s.wires.push(o),r.x1=t}}}merge(){for(const{wires:e,breakpoints:t}of this.lines.values()){e.sort((s,r)=>s.x0-r.x0);let i=1;for(;i<e.length;){const s=e[i-1],r=e[i],o=t.indexOf(s.x1),l=t.indexOf(r.x0);(o===-1||l===-1||o!==l)&&s.x1>=r.x0&&(r.x0=s.x0,r.x1=Math.max(s.x1,r.x1),s.x1=s.x0),i+=1}}}}class Ys{lines=new Map;addWire(e,t){const{y0:i,y1:s}=t;t.y0=Math.min(i,s),t.y1=Math.max(i,s),t.x0=e,t.x1=e;let r=this.lines.get(e);r==null&&this.lines.set(e,r={wires:[],breakpoints:[]}),r.wires.push(t)}split(e,t,i){let s=this.lines.get(e);if(s!=null){s.breakpoints.push(t);for(const r of s.wires)if(r.y0<t&&t<r.y1){const o=new U(e,t,e,r.y1);i.push(o),s.wires.push(o),r.y1=t}}}merge(){for(const{wires:e,breakpoints:t}of this.lines.values()){e.sort((s,r)=>s.y0-r.y0);let i=1;for(;i<e.length;){const s=e[i-1],r=e[i],o=t.indexOf(s.y1),l=t.indexOf(r.y0);(o===-1||l===-1||o!==l)&&s.y1>=r.y0&&(r.y0=s.y0,r.y1=Math.max(s.y1,r.y1),s.y1=s.y0),i+=1}}}}function Pe(n){const e=[];for(const t of n){if(t instanceof te){const{x:i,y:s,transform:r,symbol:o,name:l,props:a}=t;e.push(["i",i,s,r,o.id,l,a])}if(t instanceof U){const{x0:i,y0:s,x1:r,y1:o}=t;e.push(["w",i,s,r,o])}if(t instanceof rt){const{x:i,y:s,align:r,text:o}=t;e.push(["f",i,s,r,o])}}return e}function _e(n){const e=[];for(const t of n)switch(t[0]){case"i":{const[i,s,r,o,l,a,c]=t;e.push(new te(Tn.get(l),a,c,s,r,o));break}case"w":{const[i,s,r,o,l]=t;e.push(new U(s,r,o,l));break}case"f":{const[i,s,r,o,l]=t;e.push(new rt(l,o,s,r));break}}return e}class Xs{#e=[];get full(){return this.#e.length>0}take(){return _e(this.#e)}put(e){this.#e=Pe(e)}clear(){this.#e=[]}}const Me=0,pe=1,ot=16,Yn=256,Xn=4096,Ks=["input","textarea","select","INPUT","TEXTAREA","SELECT"];function Kn(...n){const e=n.map(Js);return t=>{const{target:i}=t;if(i instanceof Element&&Ks.includes(i.tagName))return!0;const s=we(t);for(const r of e)if((r.key==="any"||r.key===t.key||r.key===t.code)&&r.mod===s&&r.handler(t,s)!==!1)return t.preventDefault(),!0;return!1}}function we(n){let e=0;return n.shiftKey&&(e|=pe),n.altKey&&(e|=ot),n.ctrlKey&&(e|=Yn),n.metaKey&&(e|=Xn),e}function Js([n,e]){let t="",i=Me;const s=n.split("+");for(;s.length>0;){const r=s.shift();switch(r){case"Shift":i|=pe;break;case"Alt":i|=ot;break;case"Ctrl":i|=Yn;break;case"Meta":i|=Xn;break;default:t=r;break}}return{key:t,mod:i,handler:e}}function ut(n){return{x:n.offsetX,y:n.offsetY}}function Qs(n){const e=[];for(const t of n)t instanceof te&&e.push(t);return e}function er(n){const e=[];for(const t of n)t instanceof U&&e.push(t);return e}function tr(n){const e=[];for(const t of n)t instanceof rt&&e.push(t);return e}class nr{#e;#i;#n;constructor(e,t,i){this.#e=e,this.#i=t,this.#n=i}get name(){return this.#e}get elements(){return this.#i}get pins(){return this.#n}}class ir{#e;#i;#n;#t;constructor(e,t,i,s){this.#e=e,this.#i=t,this.#n=i,this.#t=s}get x(){return this.#e}get y(){return this.#i}get instance(){return this.#n}get name(){return this.#t}}function sr(){const n=[],e=[],t=[];return new class{get pins(){return n}get joins(){return e}get nodes(){return t}getWires(){return null}getPins(){return null}}}function rr(n){const e=[],t=[],i=[],s=new Map,r=new lr(s,t,i);for(const o of n){if(o instanceof te){for(const[l,a,c]of o.pins){const f=o.x+a,h=o.y+c,d=new ir(f,h,o,l);e.push(d),r.addPin(d)}continue}o instanceof U&&r.addWire(o)}return r.connect(),new class{get pins(){return e}get joins(){return t}get nodes(){return i}getWires(o,l){return s.get(He(o,l))?.wires??null}getPins(o,l){return s.get(He(o,l))?.pins??null}}}const or=new Set([Le.vdc,Le.idc,Z.opamp,Z.npn,Z.pnp,Z.nmos,Z.pmos,Z.nfet,Z.pfet]);class lr{cells;joins;nodes;names;constructor(e,t,i){this.cells=e,this.joins=t,this.nodes=i,this.names=new Set(["ground"])}addPin(e){this.getCell(e.x,e.y).pins.push(e)}addWire(e){this.getCell(e.x0,e.y0).wires.push(e),this.getCell(e.x1,e.y1).wires.push(e)}getCell(e,t){const i=He(e,t);let s=this.cells.get(i);return s==null&&this.cells.set(i,s={x:e,y:t,wires:[],pins:[],color:null}),s}connect(){this.connectGrounds(),this.connectPorts(),this.connectWithSuggestedNames();let e=1;for(const t of this.cells.values())t.pins.length>0&&t.color==null&&(this.walk([t],this.getColor(this.getUniqueName(`_n${e}`))),e+=1);for(const t of this.cells.values())t.wires.length+t.pins.length>2&&this.joins.push({x:t.x,y:t.y})}connectGrounds(){const e=this.getColor("ground");for(const t of this.cells.values())for(const i of t.pins)if(i.instance.symbol===ie.ground){if(e.elements.push(i.instance),t.color==null)this.walk([t],e);else if(t.color!==e){this.conflict(e,t);return}}}connectPorts(){const e=new Map;for(const t of this.cells.values())for(const i of t.pins)if(i.instance.symbol===ie.port){const{name:s}=i.instance;this.names.add(s);let r=e.get(s);if(r==null&&e.set(s,r=this.getColor(s)),r.elements.push(i.instance),t.color==null)this.walk([t],r);else if(t.color!==r){this.conflict(r,t);return}}}connectWithSuggestedNames(){for(const e of this.cells.values())for(const t of e.pins)if(or.has(t.instance.symbol)&&e.color==null){const i=`_${t.instance.name}_${t.name}`;this.walk([e],this.getColor(this.getUniqueName(i)))}}conflict(e,t){console.warn(`Node naming conflict: [${e.node.name}] and [${t.color.node.name}]`),this.nodes.length=0}walk(e,t){for(;;){const i=e.pop();if(i==null)break;i.color=t;for(const s of i.wires){t.elements.push(s);const r=i.x===s.x1&&i.y===s.y1?He(s.x0,s.y0):He(s.x1,s.y1),o=this.cells.get(r);o!=null&&o.color==null&&e.push(o)}for(const s of i.pins)t.pins.push(s)}}getColor(e){const t=[],i=[],s=new nr(e,t,i);return this.nodes.push(s),{node:s,elements:t,pins:i}}getUniqueName(e){if(this.names.has(e)){let t=1;for(;;){let i=`${e}_${t}`;if(!this.names.has(i)){e=i;break}t+=1}}return this.names.add(e),e}}function He(n,e){return e+32768<<16|n+32768<<0}const Qt={rewire(n){},connect(n){return sr()}},en={rewire(n){js(n)},connect(n){return rr(n)}};class Y{#e;#i;#n;#t;#r;#s;#a;constructor(e,t=en){this.#e=[...e],this.#i=t,this.#n=null,this.#t=null,this.#r=null,this.#s=null,this.#a=null,this.#i.rewire(this.#e),e instanceof Y&&e.#u()}[Symbol.iterator](){return this.#e[Symbol.iterator]()}get instances(){return this.#n??=Qs(this.#e)}get formulas(){return this.#t??=tr(this.#e)}get wires(){return this.#r??=er(this.#e)}get network(){return this.#s??=this.#i.connect(this.#e)}get names(){return this.#a??=new Zn(this.#e)}append(e){return new Y([...this.#e,...e],this.#i)}delete(e){return new Y(this.#e.filter(t=>!e.has(t)),this.#i)}unwire(){return new Y(this.#e,Qt)}rewire(){return new Y(this.#e,en)}rename(e="none"){const t=new Y(this.#e,this.#i);return t.names.rename(e),t}#u(){this.#e=[],this.#i=Qt,this.#n=null,this.#t=null,this.#r=null,this.#s=null,this.#a=null}}class ar{#e;#i;constructor(e){this.#e=[[Pe(e),"initial"]],this.#i=0}*[Symbol.iterator](){let e=0;for(const[t,i]of this.#e)yield[e,i],e+=1}get length(){return this.#e.length}push(e,t){this.#i+=1,this.#e.splice(this.#i),this.#e.push([Pe(e),t])}get canUndo(){return this.#i>0}undo(){this.canUndo&&(this.#i-=1);const[e]=this.#e[this.#i];return new Y(_e(e))}get canRedo(){return this.#i<this.#e.length-1}redo(){this.canRedo&&(this.#i+=1);const[e]=this.#e[this.#i];return new Y(_e(e))}}function ht(n){return n===Me?"l":n===pe?"r":n===ot?"d":"l"}function cr(n,e,t,i,s){return n===t&&e===i?[]:s==="d"?[new U(n,e,t,i)]:e===i?[new U(n,e,t,i)]:n===t?[new U(n,e,t,i)]:s==="l"?[new U(n,e,t,e),new U(t,e,t,i)]:[new U(n,e,n,i),new U(n,i,t,i)]}const X=10,ur=4,hr=30;class x{static defaultZoom=new x;#e;#i;#n;#t;static snap(e){return g(e/X)*X}static floor(e){return Math.floor(e/X)*X}static ceil(e){return Math.ceil(e/X)*X}constructor(e=X,t=0,i=0){e=g(e),t=g(t),i=g(i),e=Math.max(ur,e),e=Math.min(hr,e),this.#e=e,this.#i=t,this.#n=i,this.#t=e/X}get gridSize(){return this.#e}get x(){return this.#i}get y(){return this.#n}get scale(){return this.#t}scaleTo(e){return new x(X*e,this.#i,this.#n)}scaleBy(e){return new x(X*(this.#t+e),this.#i,this.#n)}zoomTo(e){return new x(e,this.#i,this.#n)}zoomBy(e){return new x(this.#e+e,this.#i,this.#n)}moveTo(e,t){return new x(this.#e,e,t)}moveBy(e,t){return new x(this.#e,this.#i+e,this.#n+t)}toGridX(e){return g((e-this.#i)/this.#t)}toGridY(e){return g((e-this.#n)/this.#t)}toScreenX(e){return g(e*this.#t+this.#i)}toScreenY(e){return g(e*this.#t+this.#n)}snapScreenX(e){return this.toScreenX(x.snap(this.toGridX(e)))}snapScreenY(e){return this.toScreenY(x.snap(this.toGridY(e)))}static center(e,t,i,s=!1){const r=i.x1-i.x0,o=i.y1-i.y0;let l=x.defaultZoom;return s&&r>0&&o>0&&(l=l.scaleTo(Math.min(e/(r+X*2),t/(o+X*2)))),l.moveTo(e/2-(r/2+i.x0)*l.scale,t/2-(o/2+i.y0)*l.scale)}}ee(new x);class tn{#e;constructor(e){this.#e=[...e].map(t=>({element:t,x:t.x,y:t.y}))}moveBy(e,t){for(const{element:i,x:s,y:r}of this.#e)i.moveTo(s+e,r+t)}reset(){for(const{element:e,x:t,y:i}of this.#e)e.moveTo(t,i)}}function fr(n,e){const t=Fn(n);switch(e){case"center":{const i=x.snap((t.x0+t.x1)/2),s=x.snap((t.y0+t.y1)/2);for(const r of n)r.moveTo(r.x-i,r.y-s);break}}return n}const T={symbol:{normal:"#222222",selected:"#0000ff"},pin:{normal:"#222222",selected:"#0000ff"},pinFill:{normal:"#ffffff",selected:"#ffffff"},wire:{normal:"#222222",selected:"#0000ff"},outline:"#22222222",selection:"#0000ff11",gridFine:"#00000066",gridCoarse:"#000000FF",crosshair:"#0000FF66"},C=.5;class Jn{#e;#i;constructor(e){this.#e=e,this.#i=e.getContext("2d")}get canvas(){return this.#e}get ctx(){return this.#i}get width(){return this.#e.width}get height(){return this.#e.height}reset(){this.#i.reset()}paintGrid(e){const t=e.scale,i=e.x,s=e.y,r=e.gridSize,o=10,l=i%r,a=i%(r*o),c=s%r,f=s%(r*o);this.#t((h,d,p)=>{if(t>=1){h.strokeStyle=T.gridFine,h.lineWidth=1,h.lineCap="butt",h.setLineDash([1,r-1]);for(let _=c;_<p;_+=r)h.beginPath(),h.moveTo(l,_+C),h.lineTo(d,_+C),h.stroke()}}),this.#t((h,d,p)=>{h.strokeStyle=t>=1?T.gridCoarse:T.gridFine,h.lineWidth=1,h.lineCap="butt",h.setLineDash([1,r-1]);for(let _=f;_<p;_+=r*o)h.beginPath(),h.moveTo(l,_+C),h.lineTo(d,_+C),h.stroke();for(let _=a;_<d;_+=r*o)h.beginPath(),h.moveTo(_+C,c),h.lineTo(_+C,p),h.stroke()}),this.#t((h,d,p)=>{h.strokeStyle=T.gridFine,h.lineWidth=1,h.lineCap="butt",h.beginPath(),h.moveTo(g(i-10*t)+C,g(s)+C),h.lineTo(g(i+10*t)+C,g(s)+C),h.moveTo(g(i)+C,g(s-10*t)+C),h.lineTo(g(i)+C,g(s+10*t)+C),h.stroke()})}paintCrosshair(e,{x:t,y:i},s){this.#t((r,o,l)=>{s?(r.strokeStyle=T.crosshair,r.lineWidth=1,r.lineCap="butt"):(r.strokeStyle=T.outline,r.lineWidth=1,r.lineCap="butt"),r.beginPath(),r.moveTo(0,e.snapScreenY(i)+C),r.lineTo(o,e.snapScreenY(i)+C),r.moveTo(e.snapScreenX(t)+C,0),r.lineTo(e.snapScreenX(t)+C,l),r.stroke()})}paintSelection(e,t,i){this.#t(s=>{s.fillStyle=T.selection,s.fillRect(g(t.x),g(t.y),g(i.x-t.x),g(i.y-t.y))})}paintInstance(e,t,i=!1){const s=e.scale,r=e.x,o=e.y,l=t.x,a=t.y;this.#t(c=>{i?(c.fillStyle=T.symbol.selected,c.strokeStyle=T.symbol.selected,c.lineWidth=3,c.lineCap="square"):(c.fillStyle=T.symbol.normal,c.strokeStyle=T.symbol.normal,c.lineWidth=1,c.lineCap="square");for(const f of t.shapes)switch(f[0]){case"l":{const[h,d,p,_,v]=f;c.beginPath(),c.moveTo(g(r+(l+d)*s)+C,g(o+(a+p)*s)+C),c.lineTo(g(r+(l+_)*s)+C,g(o+(a+v)*s)+C),c.stroke();break}case"c":{const[h,d,p,_]=f;c.beginPath(),c.ellipse(g(r+(l+d)*s)+C,g(o+(a+p)*s)+C,g(_*s),g(_*s),0,0,2*Math.PI),c.stroke();break}case"a":{const[h,d,p,_,v,w]=f;c.beginPath(),c.ellipse(g(r+(l+d)*s)+C,g(o+(a+p)*s)+C,g(_*s),g(_*s),0,v*(Math.PI/180),w*(Math.PI/180)),c.stroke();break}case"t":{const[h,d,p,_,v]=f;this.#n(c,e,_),c.fillText(v,r+(l+d)*s,o+(a+p)*s);break}}})}paintPins(e,t,i=!1){const s=e.scale,r=e.x,o=e.y,l=t.x,a=t.y;this.#t(c=>{i?(c.fillStyle=T.pinFill.selected,c.strokeStyle=T.pin.selected,c.lineWidth=3,c.lineCap="square"):(c.fillStyle=T.pinFill.normal,c.strokeStyle=T.pin.normal,c.lineWidth=1,c.lineCap="square");for(const f of t.pins){const[h,d,p]=f;c.beginPath(),c.ellipse(g(r+(l+d)*s)+C,g(o+(a+p)*s)+C,g(3*s),g(3*s),0,0,2*Math.PI),c.fill(),c.stroke()}})}paintLabels(e,t,i=!1){const s=e.scale,r=e.x,o=e.y,l=t.x,a=t.y;this.#t(c=>{i?c.fillStyle=T.symbol.selected:c.fillStyle=T.symbol.normal;const[f,h,d]=t.labels;this.#n(c,e,d),c.fillText(t.name,r+(l+f)*s,o+(a+h)*s)})}paintWire(e,t,i=!1){const s=e.scale,r=e.x,o=e.y;this.#t(l=>{i?(l.strokeStyle=T.wire.selected,l.lineWidth=3,l.lineCap="square"):(l.strokeStyle=T.wire.normal,l.lineWidth=1,l.lineCap="square");const{x0:a,y0:c,x1:f,y1:h}=t;l.beginPath(),l.moveTo(g(r+a*s)+C,g(o+c*s)+C),l.lineTo(g(r+f*s)+C,g(o+h*s)+C),l.stroke()})}paintJoins(e,t){const i=e.scale,s=e.x,r=e.y;this.#t(o=>{o.fillStyle=T.wire.normal;for(const{x:l,y:a}of t)o.beginPath(),o.ellipse(g(s+l*i)+C,g(r+a*i)+C,g(3*i),g(3*i),0,0,2*Math.PI),o.fill()})}paintArea(e,{x0:t,y0:i,x1:s,y1:r}){const o=e.scale,l=e.x,a=e.y;this.#t(c=>{c.strokeStyle=T.outline,c.lineWidth=1,c.lineCap="square",c.strokeRect(g(l+t*o)+C,g(a+i*o)+C,g((s-t)*o),g((r-i)*o))})}paintSymbolIcon(e,t,i){const s=jn(e,0,0),r=x.center(t,i,s,!0);this.paintInstance(r,{x:0,y:0,shapes:e.shapes})}#n(e,t,i){switch(e.font=`${20*t.scale}px serif`,i.charAt(0)){case"l":e.textAlign="left";break;case"c":e.textAlign="center";break;case"r":e.textAlign="right";break}switch(i.charAt(1)){case"t":e.textBaseline="top";break;case"m":e.textBaseline="middle";break;case"b":e.textBaseline="bottom";break}}#t=e=>{const t=this.#i;t.save(),e(t,this.#e.width,this.#e.height),t.restore()}}class W{#e;constructor(e=[]){this.#e=new Set;for(const{id:t}of e)this.#e.add(t)}[Symbol.iterator](){return this.#e[Symbol.iterator]()}get size(){return this.#e.size}get full(){return this.#e.size>0}has({id:e}){return this.#e.has(e)}filter(e){return[...e].filter(({id:t})=>this.#e.has(t))}select(e){return new W(e)}add(e){const t=new W;for(const i of this.#e)t.#e.add(i);for(const{id:i}of e)t.#e.add(i);return t}delete(e){const t=new W;for(const i of this.#e)t.#e.add(i);for(const{id:i}of e)t.#e.delete(i);return t}clear(){return new W}}class pr{#e;#i;#n=ee(new Y([]));#t=ee(new x);#r=ee(new W);#s=ee({type:"idle",cursor:{x:100,y:100},hovered:null});#a=new Xs;#u={current:null};#p;#o;constructor(e,t){this.#e=e,this.#i=new ar(t),this.#n.value=t;const i=o=>()=>{this.#t.value=this.#t.value.zoomBy(o)},s=(o,l)=>()=>{this.#t.value=this.#t.value.moveBy(o,l)},r=o=>()=>{this.pasteInstance(o)};this.#p=Kn(["Digit0",()=>{this.zoomTo("0")}],["Equal",i(1)],["Minus",i(-1)],["Home",()=>{this.zoomTo("1")}],["Space",()=>{this.zoomTo("all")}],["ArrowLeft",s(-10,0)],["Shift+ArrowLeft",s(-100,0)],["ArrowRight",s(10,0)],["Shift+ArrowRight",s(100,0)],["ArrowUp",s(0,-10)],["Shift+ArrowUp",s(0,-100)],["ArrowDown",s(0,10)],["Shift+ArrowDown",s(0,100)],["Ctrl+a",()=>{this.select("all")}],["Ctrl+x",()=>{this.selectionCut()}],["Ctrl+c",()=>{this.selectionCopy()}],["Ctrl+v",()=>{this.selectionPaste()}],["Delete",()=>{this.selectionDelete()}],["Ctrl+z",()=>{this.undo()}],["Ctrl+y",()=>{this.redo()}],["Alt+l",()=>{if(!this.transformSelection("rl"))return!1}],["Alt+r",()=>{if(!this.transformSelection("rr"))return!1}],["Alt+h",()=>{if(!this.transformSelection("mx"))return!1}],["Alt+v",()=>{if(!this.transformSelection("my"))return!1}],["Escape",()=>{if(!this.#c()){if(this.#r.value.full){this.#r.value=this.#r.value.clear();return}return!1}}],["w",()=>{if(this.#c(),!this.#v())return!1}],["g",r(ie.ground)],["o",r(ie.port)],["v",r(Le.vdc)],["i",r(Le.idc)],["r",r(Fe.resistor)],["c",r(Fe.capacitor)],["l",r(Fe.inductor)],["d",r(Z.diode)],["n",r(Z.npn)],["p",r(Z.pnp)],["Shift+N",r(Z.nmos)],["Shift+P",r(Z.pmos)],["a",r(Z.opamp)])}get library(){return this.#e}get schematic(){return this.#n.value}get zoom(){return this.#t.value}get selection(){return this.#r.value}get mouseAction(){return this.#s.value}get focusRef(){return this.#u}attach(e){this.#o=new Jn(e),this.#t.value=this.#_(!1)}handleFocus=e=>{this.#l()};handleBlur=e=>{this.#c(),this.#l()};handleKeyDown=e=>{this.#p(e)||this.#m(e)};handleKeyUp=e=>{this.#m(e)};#m(e){const{key:t}=e,i=we(e);if(t==="Shift"&&this.#x(t,i)){e.preventDefault();return}if(t==="Alt"&&this.#x(t,i)){e.preventDefault();return}if(t==="Shift"&&this.#H(t,i)){e.preventDefault();return}}handleMouseDown=e=>{const t=e.button,i=we(e),s=ut(e);t===0&&i===Me&&(this.#d(s,i)||this.#b(s,i)||this.#y(s))||t===0&&i===pe&&(this.#d(s,i)||this.#b(s,i)||this.#y(s))||t===0&&i===ot&&this.#d(s,i)||t===1&&i===Me&&this.#G(s)};handleMouseMove=e=>{const t=we(e),i=ut(e);this.#k(i)||this.#w(i,t)||this.#I(i)||this.#P(i)||this.#g(i,t)||this.#B(i)||this.#s.value.type==="idle"&&this.#C(i)&&this.#l(i)};handleMouseUp=e=>{const t=ut(e);this.#D(t)||this.#$(t)||this.#N(t)||this.#S(t)||this.#l(t)};handleWheel=e=>{e.preventDefault();const t=we(e);if(this.#s.value.type==="idle"&&t===Me){this.#t.value=this.#t.value.zoomBy(-Math.sign(e.deltaY));return}};handleContextMenu=e=>{e.preventDefault()};#C(e){const t=this.#t.value.toGridX(e.x),i=this.#t.value.toGridY(e.y),s=this.#t.value.toGridX(this.#s.value.cursor.x),r=this.#t.value.toGridY(this.#s.value.cursor.y);return x.snap(t)!==x.snap(s)||x.snap(i)!==x.snap(r)}#l(e=this.#s.value.cursor){const t=x.snap(this.#t.value.toGridX(e.x)),i=x.snap(this.#t.value.toGridY(e.y)),s=Jt(this.#n.value,t,i,"instance");this.#s.value={type:"idle",cursor:e,hovered:s}}#v(){if(this.#s.value.type==="idle"){this.#r.value=this.#r.value.clear();const{cursor:e}=this.#s.value;return this.#s.value={type:"place-wire",cursor:e},!0}return!1}#k(e){return this.#s.value.type==="place-wire"?(this.#s.value={type:"place-wire",cursor:e},!0):!1}#M(){return this.#s.value.type==="place-wire"?(this.#l(),!0):!1}#y(e){return this.#s.value.type==="idle"?(this.#r.value=this.#r.value.clear(),this.#s.value={type:"select",cursor:{...e},origin:{...e}},!0):!1}#g(e,t){if(this.#s.value.type==="select"){const{origin:i}=this.#s.value,s={x0:this.#t.value.toGridX(Math.min(i.x,e.x)),y0:this.#t.value.toGridY(Math.min(i.y,e.y)),x1:this.#t.value.toGridX(Math.max(i.x,e.x)),y1:this.#t.value.toGridY(Math.max(i.y,e.y))};for(const r of this.#n.value)(t===pe?Is(s,r.area):$s(s,r.area))?this.#r.value=this.#r.value.add([r]):this.#r.value=this.#r.value.delete([r]);return this.#s.value={type:"select",cursor:e,origin:i},!0}return!1}#H(e,t){return this.#s.value.type==="select"?this.#g(this.#s.value.cursor,t):!1}#S(e){if(this.#s.value.type==="select"){const{origin:t}=this.#s.value;return e.x===t.x&&e.y===t.y&&(this.#r.value=this.#r.value.clear()),this.#l(e),!0}return!1}#A(){return this.#s.value.type==="select"?(this.#r.value=new W,this.#l(),!0):!1}#b(e,t){if(this.#s.value.type==="idle"){const i=Jt(this.#n.value,this.#t.value.toGridX(e.x),this.#t.value.toGridY(e.y));if(i!=null){this.#r.value.has(i)||(this.#r.value=t===pe?this.#r.value.add([i]):this.#r.value.select([i]));const s=Pe(this.#n.value),r=new tn(this.#r.value.filter(this.#n.value));return this.#n.value=this.#n.value.unwire(),this.#s.value={type:"move",cursor:{...e},origin:{...e},undo:s,mover:r},!0}}return!1}#I(e){if(this.#s.value.type==="move"){const{origin:t,undo:i,mover:s}=this.#s.value,r=x.snap(this.#t.value.toGridX(t.x)),o=x.snap(this.#t.value.toGridY(t.y)),l=x.snap(this.#t.value.toGridX(e.x)),a=x.snap(this.#t.value.toGridY(e.y));return s.moveBy(l-r,a-o),this.#n.value=this.#n.value.unwire(),this.#s.value={type:"move",cursor:e,origin:t,undo:i,mover:s},!0}return!1}#$(e){return this.#s.value.type==="move"?(this.#n.value=this.#n.value.rewire(),this.#l(e),this.#f("move selection"),!0):!1}#L(){if(this.#s.value.type==="move"){const{undo:e}=this.#s.value;return this.#n.value=new Y(_e(e)),this.#r.value=new W,this.#l(),!0}return!1}#V(e){if(this.#s.value.type==="idle"){const{cursor:t}=this.#s.value,i=Pe(this.#n.value),s=new tn(fr(e,"center")),r=x.snap(this.#t.value.toGridX(t.x)),o=x.snap(this.#t.value.toGridY(t.y));return s.moveBy(r,o),this.#n.value=this.#n.value.unwire().append(e).rename(),this.#r.value=new W(e),this.#s.value={type:"paste",cursor:t,undo:i,mover:s},!0}return!1}#P(e){if(this.#s.value.type==="paste"){const{undo:t,mover:i}=this.#s.value,s=x.snap(this.#t.value.toGridX(e.x)),r=x.snap(this.#t.value.toGridY(e.y));return i.moveBy(s,r),this.#n.value=this.#n.value.unwire(),this.#s.value={type:"paste",cursor:e,undo:t,mover:i},!0}return!1}#N(e){return this.#s.value.type==="paste"?(this.#n.value=this.#n.value.rewire(),this.#l(e),this.#f("paste"),!0):!1}#T(){if(this.#s.value.type==="paste"){const{undo:e}=this.#s.value;return this.#n.value=new Y(_e(e)),this.#r.value=new W,this.#l(),!0}return!1}#d(e,t){return this.#s.value.type==="idle"&&this.#O(e)?(this.#r.value=this.#r.value.clear(),this.#s.value={type:"connect",cursor:{...e},origin:{...e},wires:[],shape:ht(t)},!0):this.#s.value.type==="place-wire"?(this.#s.value={type:"connect",cursor:{...e},origin:{...e},wires:[],shape:ht(t)},!0):!1}#w(e,t){if(this.#s.value.type==="connect"){const{origin:i}=this.#s.value,s=x.snap(this.#t.value.toGridX(i.x)),r=x.snap(this.#t.value.toGridY(i.y)),o=x.snap(this.#t.value.toGridX(e.x)),l=x.snap(this.#t.value.toGridY(e.y)),a=ht(t),c=cr(s,r,o,l,a);return this.#s.value={type:"connect",cursor:e,origin:i,wires:c,shape:a},!0}return!1}#x(e,t){return this.#s.value.type==="connect"?this.#w(this.#s.value.cursor,t):!1}#D(e){return this.#s.value.type==="connect"?(this.#n.value=this.#n.value.append(this.#s.value.wires),this.#l(e),this.#f("draw wires"),!0):!1}#E(){return this.#s.value.type==="connect"?(this.#l(),!0):!1}#G(e){return this.#s.value.type==="idle"?(this.#s.value={type:"scroll",cursor:{...e},origin:{...e},offset:{x:this.#t.value.x,y:this.#t.value.y}},!0):!1}#B(e){if(this.#s.value.type==="scroll"){const{origin:t,offset:i}=this.#s.value;return this.#t.value=this.#t.value.moveTo(i.x+(e.x-t.x),i.y+(e.y-t.y)),this.#s.value={type:"scroll",cursor:e,origin:t,offset:i},!0}return!1}#c(){return!!(this.#M()||this.#E()||this.#L()||this.#T()||this.#A())}#O(e){const{network:t}=this.#n.value,i=this.#t.value.toGridX(e.x),s=this.#t.value.toGridY(e.y),r=x.snap(i),o=x.snap(s);return r-5<=i&&i<=r+5&&o-5<=s&&s<=o+5&&(t.getWires(r,o)!=null||t.getPins(r,o)!=null)}#_(e){return x.center(this.#o.width,this.#o.height,Fn(this.#n.peek()),e)}#f(e){this.#i.push(this.#n.value,e)}transformSelection(e){if(this.#r.value.full){const[t]=this.#r.value.filter(this.#n.value);return t instanceof te&&t.transformBy(e),this.#n.value=new Y(this.#n.value),this.#f("transform selection"),!0}return!1}pasteInstance(e){this.#c(),e===ie.wire?this.#v():this.#V([new te(e)])}get canUndo(){return this.#i.canUndo}undo(){this.#i.canUndo&&(this.#c(),this.#n.value=this.#i.undo(),this.#r.value=new W)}get canRedo(){return this.#i.canRedo}redo(){this.#i.canRedo&&(this.#c(),this.#n.value=this.#i.redo(),this.#r.value=new W)}select(e){switch(this.#c(),e){case"all":this.#r.value=new W(this.#n.value);break;case"none":this.#r.value=new W;break;case"invert":this.#r.value=new W([...this.#n.value].filter(t=>!this.#r.value.has(t)));break;default:this.#r.value=new W(e);break}}selectionCut(){this.#c(),this.#r.value.size>0&&(this.#a.put(this.#r.value.filter(this.#n.value)),this.#n.value=this.#n.value.delete(this.#r.value),this.#r.value=new W,this.#f("cut"))}selectionCopy(){this.#c(),this.#r.value.size>0&&this.#a.put(this.#r.value.filter(this.#n.value))}selectionPaste(){this.#a.full&&(this.#c(),this.#V(this.#a.take()))}selectionDelete(){this.#c(),this.#r.value.size>0&&(this.#n.value=this.#n.value.delete(this.#r.value),this.#r.value=new W,this.#f("delete"))}zoomTo(e){switch(e){case"+":this.#t.value=this.#t.value.zoomBy(1);break;case"-":this.#t.value=this.#t.value.zoomBy(-1);break;case"0":this.#t.value=new x().moveTo(20,20);break;case"1":this.#t.value=this.#_(!1);break;case"all":this.#t.value=this.#_(!0);break}}focus(){this.#u.current?.focus()}blur(){this.#u.current?.blur()}get focused(){return this.#u.current?.focused??!1}paint(){const e=this.#t.peek(),t=this.#s.peek();switch(this.#o.reset(),this.#o.paintGrid(e),t.type){case"idle":this.#h(!1,t.hovered),this.focused&&this.#o.paintCrosshair(e,t.cursor,!1);break;case"scroll":this.#h(!1,null);break;case"select":this.#h(!1,null),this.#o.paintSelection(e,t.origin,t.cursor);break;case"place-wire":this.#h(!0,null),this.#o.paintCrosshair(e,t.cursor,!0);break;case"connect":this.#o.paintCrosshair(e,t.cursor,!0),this.#h(!0,null);for(const i of t.wires)this.#o.paintWire(e,i,!0);break;case"move":this.#h(!0,null);break;case"paste":this.#h(!0,null);break}}#h(e,t){const i=this.#n.peek(),s=this.#t.peek(),r=this.#r.peek();for(const o of i.instances)this.#o.paintInstance(s,o,r.has(o));for(const o of i.instances)this.#o.paintLabels(s,o,r.has(o));for(const o of i.wires)this.#o.paintWire(s,o,r.has(o));for(const o of i.instances)(e||o===t)&&this.#o.paintPins(s,o,r.has(o));this.#o.paintJoins(s,i.network.joins)}}const Qn=Mt(null);function re(){return Cn(Qn)}function ei(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=ei(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function ti(){for(var n,e,t=0,i="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=ei(n))&&(i&&(i+=" "),i+=e);return i}const dr="_root_1813r_1",_r="_item_1813r_9",mr="_selected_1813r_22";function vr(){const n=re(),{schematic:e,selection:t}=n;return u("ul",{class:dr,children:e.instances.filter(({symbol:i})=>i!==ie.ground&&i!==ie.port).map(i=>u("li",{class:ti(_r,t.has(i)&&mr),onClick:()=>{n.select([i]),n.focus()},children:[i.symbol.id,":",i.name," (#",i.id,")"]},i.id))})}function ni({canvas:n,style:e,...t}){return u("canvas",{...t,ref:n,style:{display:"block",inlineSize:"100%",blockSize:"100%",...e}})}const ii=n=>{const e=n.getContext("2d"),t=devicePixelRatio,{width:i,height:s}=n.getBoundingClientRect(),r=Math.max(1,i*t),o=Math.max(1,s*t);return(n.width!==r||n.height!==o)&&(n.width=r,n.height=o,e.scale(t,t)),{width:r,height:o}},yr="_root_1ar66_1",gr="_category_1ar66_5",br="_title_1ar66_10",Vr="_list_1ar66_15",wr="_symbol_1ar66_24";function xr(){const{library:n}=re(),e=Object.groupBy(n,({category:t})=>t);return u("div",{class:yr,children:Object.entries(e).map(([t,i])=>u(Cr,{name:t,symbols:i},t))})}function Cr({name:n,symbols:e}){return u("div",{class:gr,children:[u("div",{class:br,children:n}),u("div",{class:Vr,children:e.map(t=>u(kr,{symbol:t},t.id))})]})}function kr({symbol:n}){const e=re(),t=$e(null);return et(()=>{const{width:i,height:s}=ii(t.current);new Jn(t.current).paintSymbolIcon(n,i,s)},[n]),u("div",{class:wr,title:n.name,onClick:()=>{e.pasteInstance(n),e.focus()},children:u(ni,{canvas:t})})}const Mr="_root_k0zzy_1",Hr="_item_k0zzy_9";function Sr(){const n=re(),{schematic:e}=n;return u("ul",{class:Mr,children:e.network.nodes.map(t=>u("li",{class:Hr,onClick:()=>{n.select(t.elements),n.focus()},children:t.name},t.name))})}const lt="_root_17fw5_1",Ar="_empty_17fw5_7",Tt="_title_17fw5_11",Ir="_prop_17fw5_16",$r="_propName_17fw5_21",Lr="_propValue_17fw5_28",Pr="_propTitle_17fw5_32";function Nr(){const n=re(),{schematic:e,selection:t}=n,i=t.filter(e);if(i.length===1){const[s]=i;if(s instanceof te)return u(Tr,{instance:s});if(s instanceof rt)return u(Dr,{formula:s});if(s instanceof U)return u(Er,{wire:s})}return u("div",{class:lt,children:u("div",{class:Ar,children:"-"})})}function Tr({instance:n}){const{device:e}=n.symbol;return u("div",{class:lt,children:[u("div",{class:Tt,children:n.symbol.name}),u("div",{children:["name: ",n.name]}),e!=null&&u("ul",{children:Object.entries(e.propertiesSchema).map(([t,i])=>u("li",{children:[u("div",{class:Ir,children:[u("span",{class:$r,children:t})," ",u("span",{class:Lr,children:i.defaultValue||"-"})]}),u("div",{class:Pr,children:i.title})]}))})]})}function Dr({formula:n}){return u("div",{class:lt,children:[u("div",{class:Tt,children:"Formula"}),u("div",{children:n.text})]})}function Er({wire:n}){return u("div",{class:lt,children:u("div",{class:Tt,children:"Wire"})})}function Gr(n){const[e,t]=Ht(new DOMRect);return et(()=>{const{current:i}=n;if(i==null)return;const s=new ResizeObserver(()=>{t(i.getBoundingClientRect())});return s.observe(i),()=>{s.disconnect()}},[n]),e}const Br="_root_ptmbs_1";function Or({formula:n}){const e=$e(null);return Ye(()=>{ui.render(n.text,e.current,{output:"mathml",displayMode:!0})},[n.text]),u("div",{ref:e,class:Br})}const Wr="_root_13qoa_1",Ur="_overlay_13qoa_14",Rr="_note_13qoa_20",zr="_selected_13qoa_25";function Fr(){const n=re(),e=$e(null),t=$e(null),{width:i,height:s}=Gr(t);return bi(n.focusRef,()=>({focus:()=>{e.current?.focus()},blur:()=>{e.current?.blur()},get focused(){return e.current===document.activeElement}})),Ye(()=>{i>0&&s>0&&(ii(t.current),n.attach(t.current))},[n,i,s]),Ye(()=>{if(i>0&&s>0){const r=requestAnimationFrame(()=>{n.paint()});return()=>{cancelAnimationFrame(r)}}},[n,i,s,n.schematic,n.zoom,n.selection,n.mouseAction]),u("div",{ref:e,class:Wr,tabIndex:0,autofocus:!0,onFocus:n.handleFocus,onBlur:n.handleBlur,onKeyDown:n.handleKeyDown,onKeyUp:n.handleKeyUp,children:[u(ni,{canvas:t,onMouseDown:n.handleMouseDown,onMouseMove:n.handleMouseMove,onMouseUp:n.handleMouseUp,onWheel:n.handleWheel,onContextMenu:n.handleContextMenu}),u(qr,{})]})}function qr(){const{schematic:n,zoom:e,selection:t}=re();return u("div",{class:Ur,style:{transformOrigin:"0px 0px",translate:`${e.x}px ${e.y}px`,scale:`${e.scale}`},children:n.formulas.map(i=>u("div",{class:ti(Rr,t.has(i)&&zr),style:{left:i.x,top:i.y},children:u(Or,{formula:i},i.id)}))})}const jr=Mt(null),Zr="_root_3m5pl_1 _fadeIn_kq333_1";let Yr=0;class Xr{constructor(e,t){this.message=e,this.options=t}#e=Yr+=1;get key(){return this.#e}}const me=ee([]);function Kr(n){me.value=[...me.value,n]}function Jr(n){me.value=me.value.filter(e=>e!==n)}function Qr({message:n}){const e=$e(null);return et(()=>{n.options.modal?e.current?.showModal():e.current?.show()},[n]),u("dialog",{ref:e,class:Zr,onClose:()=>{Jr(n),n.options.onClose()},children:u(jr.Provider,{value:{close:()=>{e.current?.close()}},children:n.message})},n.key)}const eo="_root_5uo3x_1";function to(){return u("div",{class:eo,hidden:me.value.length===0,children:me.value.map(n=>u(Qr,{message:n}))})}function nn(n,{modal:e=!0,onClose:t=()=>{}}={}){Kr(new Xr(n,{modal:e,onClose:t}))}const no="_alert_ppbdc_1 _fadeIn_kq333_1",io="_message_ppbdc_17";var so="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z",ro="M7,2H17A2,2 0 0,1 19,4V20A2,2 0 0,1 17,22H7A2,2 0 0,1 5,20V4A2,2 0 0,1 7,2M7,4V8H17V4H7M7,10V12H9V10H7M11,10V12H13V10H11M15,10V12H17V10H15M7,14V16H9V14H7M11,14V16H13V14H11M15,14V16H17V14H15M7,18V20H9V18H7M11,18V20H13V18H11M15,18V20H17V18H15Z",oo="M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M12 20C7.59 20 4 16.41 4 12S7.59 4 12 4 20 7.59 20 12 16.41 20 12 20M16.59 7.58L10 14.17L7.41 11.59L6 13L10 17L18 9L16.59 7.58Z",lo="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",ao="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z",co="M19,3L13,9L15,11L22,4V3M12,12.5A0.5,0.5 0 0,1 11.5,12A0.5,0.5 0 0,1 12,11.5A0.5,0.5 0 0,1 12.5,12A0.5,0.5 0 0,1 12,12.5M6,20A2,2 0 0,1 4,18C4,16.89 4.9,16 6,16A2,2 0 0,1 8,18C8,19.11 7.1,20 6,20M6,8A2,2 0 0,1 4,6C4,4.89 4.9,4 6,4A2,2 0 0,1 8,6C8,7.11 7.1,8 6,8M9.64,7.64C9.87,7.14 10,6.59 10,6A4,4 0 0,0 6,2A4,4 0 0,0 2,6A4,4 0 0,0 6,10C6.59,10 7.14,9.87 7.64,9.64L10,12L7.64,14.36C7.14,14.13 6.59,14 6,14A4,4 0 0,0 2,18A4,4 0 0,0 6,22A4,4 0 0,0 10,18C10,17.41 9.87,16.86 9.64,16.36L12,14L19,21H22V20L9.64,7.64Z",uo="M19,20H5V4H7V7H17V4H19M12,2A1,1 0 0,1 13,3A1,1 0 0,1 12,4A1,1 0 0,1 11,3A1,1 0 0,1 12,2M19,2H14.82C14.4,0.84 13.3,0 12,0C10.7,0 9.6,0.84 9.18,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V4A2,2 0 0,0 19,2Z",ho="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z",fo="M15 21H17V19H15M19 9H21V7H19M3 5V19C3 20.1 3.9 21 5 21H9V19H5V5H9V3H5C3.9 3 3 3.9 3 5M19 3V5H21C21 3.9 20.1 3 19 3M11 23H13V1H11M19 17H21V15H19M15 5H17V3H15M19 13H21V11H19M19 21C20.1 21 21 20.1 21 19H19Z",po="M3 15V17H5V15M15 19V21H17V19M19 3H5C3.9 3 3 3.9 3 5V9H5V5H19V9H21V5C21 3.9 20.1 3 19 3M21 19H19V21C20.1 21 21 20.1 21 19M1 11V13H23V11M7 19V21H9V19M19 15V17H21V15M11 19V21H13V19M3 19C3 20.1 3.9 21 5 21V19Z",_o="M20 18H4V8H20M20 6H12L10 4H4A2 2 0 0 0 2 6V18A2 2 0 0 0 4 20H20A2 2 0 0 0 22 18V8A2 2 0 0 0 20 6M14 9H16V13H19L15 17L11 13H14Z",mo="M13 19C13 19.34 13.04 19.67 13.09 20H4C2.9 20 2 19.11 2 18V6C2 4.89 2.89 4 4 4H10L12 6H20C21.1 6 22 6.89 22 8V13.81C21.39 13.46 20.72 13.22 20 13.09V8H4V18H13.09C13.04 18.33 13 18.66 13 19M20 18V15H18V18H15V20H18V23H20V20H23V18H20Z",vo="M20 18H4V8H20M20 6H12L10 4H4A2 2 0 0 0 2 6V18A2 2 0 0 0 4 20H20A2 2 0 0 0 22 18V8A2 2 0 0 0 20 6M16 17H14V13H11L15 9L19 13H16Z",yo="M10,19H13V22H10V19M12,2C17.35,2.22 19.68,7.62 16.5,11.67C15.67,12.67 14.33,13.33 13.67,14.17C13,15 13,16 13,17H10C10,15.33 10,13.92 10.67,12.92C11.33,11.92 12.67,11.33 13.5,10.67C15.92,8.43 15.32,5.26 12,5A3,3 0 0,0 9,8H6A6,6 0 0,1 12,2Z",go="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",bo="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z",Vo="M18 16H17.42L16.61 15.19C17.5 14 18 12.5 18 11C18 7.13 14.87 4 11 4C9.5 4 8 4.5 6.79 5.4C3.7 7.72 3.07 12.11 5.39 15.2C7.71 18.29 12.1 18.92 15.19 16.6L16 17.41V18L21 23L23 21L18 16M11 16C8.24 16 6 13.76 6 11S8.24 6 11 6 16 8.24 16 11 13.76 16 11 16M3 6L1 8V1H8L6 3H3V6M21 1V8L19 6V3H16L14 1H21M6 19L8 21H1V14L3 16V19H6Z",wo="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z",xo="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z",Co="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z",ko="M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z",Mo="M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10L15.55,5.55Z",Ho="M9,9H15V15H9M7,17H17V7H7M15,5H17V3H15M15,21H17V19H15M19,17H21V15H19M19,9H21V7H19M19,21A2,2 0 0,0 21,19H19M19,13H21V11H19M11,21H13V19H11M9,3H7V5H9M3,17H5V15H3M5,21V19H3A2,2 0 0,0 5,21M19,3V5H21A2,2 0 0,0 19,3M13,3H11V5H13M3,9H5V7H3M7,21H9V19H7M3,13H5V11H3M3,5H5V3A2,2 0 0,0 3,5Z",So="M5,3H7V5H9V3H11V5H13V3H15V5H17V3H19V5H21V7H19V9H21V11H19V13H21V15H19V17H21V19H19V21H17V19H15V21H13V19H11V21H9V19H7V21H5V19H3V17H5V15H3V13H5V11H3V9H5V7H3V5H5V3Z",Ao="M1,4.27L2.28,3L21,21.72L19.73,23L17,20.27V21H15V19H15.73L5,8.27V9H3V7H3.73L1,4.27M20,3A1,1 0 0,1 21,4V5H19V3H20M15,5V3H17V5H15M11,5V3H13V5H11M7,5V3H9V5H7M11,21V19H13V21H11M7,21V19H9V21H7M4,21A1,1 0 0,1 3,20V19H5V21H4M3,15H5V17H3V15M21,15V17H19V15H21M3,11H5V13H3V11M21,11V13H19V11H21M21,7V9H19V7H21Z",Io="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z",$o="M16.59,5.41L15.17,4L12,7.17L8.83,4L7.41,5.41L12,10M7.41,18.59L8.83,20L12,16.83L15.17,20L16.58,18.59L12,14L7.41,18.59Z",Lo="M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z";function Po(n,e){for(var t in e)n[t]=e[t];return n}function bt(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var i in e)if(i!=="__source"&&n[i]!==e[i])return!0;return!1}function sn(n,e){this.props=n,this.context=e}function No(n,e){function t(s){var r=this.props.ref,o=r==s.ref;return!o&&r&&(r.call?r(null):r.current=null),e?!e(this.props,s)||!o:bt(this.props,s)}function i(s){return this.shouldComponentUpdate=t,qe(n,s)}return i.displayName="Memo("+(n.displayName||n.name)+")",i.prototype.isReactComponent=!0,i.__f=!0,i}(sn.prototype=new J).isPureReactComponent=!0,sn.prototype.shouldComponentUpdate=function(n,e){return bt(this.props,n)||bt(this.state,e)};var rn=V.__b;V.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),rn&&rn(n)};var To=V.__e;V.__e=function(n,e,t,i){if(n.then){for(var s,r=e;r=r.__;)if((s=r.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(n,e)}To(n,e,t,i)};var on=V.unmount;function si(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),n.__c.__H=null),(n=Po({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c=null),n.__k=n.__k&&n.__k.map(function(i){return si(i,e,t)})),n}function ri(n,e,t){return n&&t&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(i){return ri(i,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=t)),n}function ft(){this.__u=0,this.o=null,this.__b=null}function oi(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function We(){this.i=null,this.l=null}V.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&32&n.__u&&(n.type=null),on&&on(n)},(ft.prototype=new J).__c=function(n,e){var t=e.__c,i=this;i.o==null&&(i.o=[]),i.o.push(t);var s=oi(i.__v),r=!1,o=function(){r||(r=!0,t.__R=null,s?s(l):l())};t.__R=o;var l=function(){if(!--i.__u){if(i.state.__a){var a=i.state.__a;i.__v.__k[0]=ri(a,a.__c.__P,a.__c.__O)}var c;for(i.setState({__a:i.__b=null});c=i.o.pop();)c.forceUpdate()}};i.__u++||32&e.__u||i.setState({__a:i.__b=i.__v.__k[0]}),n.then(o,o)},ft.prototype.componentWillUnmount=function(){this.o=[]},ft.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=si(this.__b,t,i.__O=i.__P)}this.__b=null}var s=e.__a&&qe(le,null,n.fallback);return s&&(s.__u&=-33),[qe(le,null,e.__a?null:n.children),s]};var ln=function(n,e,t){if(++t[1]===t[0]&&n.l.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.l.size))for(t=n.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.i=t=t[2]}};(We.prototype=new J).__a=function(n){var e=this,t=oi(e.__v),i=e.l.get(n);return i[0]++,function(s){var r=function(){e.props.revealOrder?(i.push(s),ln(e,n,i)):s()};t?t(r):r()}},We.prototype.render=function(n){this.i=null,this.l=new Map;var e=Ze(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return n.children},We.prototype.componentDidUpdate=We.prototype.componentDidMount=function(){var n=this;this.l.forEach(function(e,t){ln(n,t,e)})};var Do=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Eo=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Go=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Bo=/[A-Z0-9]/g,Oo=typeof document<"u",Wo=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(n)};J.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(J.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var an=V.event;function Uo(){}function Ro(){return this.cancelBubble}function zo(){return this.defaultPrevented}V.event=function(n){return an&&(n=an(n)),n.persist=Uo,n.isPropagationStopped=Ro,n.isDefaultPrevented=zo,n.nativeEvent=n};var Fo={enumerable:!1,configurable:!0,get:function(){return this.class}},cn=V.vnode;V.vnode=function(n){typeof n.type=="string"&&function(e){var t=e.props,i=e.type,s={},r=i.indexOf("-")===-1;for(var o in t){var l=t[o];if(!(o==="value"&&"defaultValue"in t&&l==null||Oo&&o==="children"&&i==="noscript"||o==="class"||o==="className")){var a=o.toLowerCase();o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&l===!0?l="":a==="translate"&&l==="no"?l=!1:a[0]==="o"&&a[1]==="n"?a==="ondoubleclick"?o="ondblclick":a!=="onchange"||i!=="input"&&i!=="textarea"||Wo(t.type)?a==="onfocus"?o="onfocusin":a==="onblur"?o="onfocusout":Go.test(o)&&(o=a):a=o="oninput":r&&Eo.test(o)?o=o.replace(Bo,"-$&").toLowerCase():l===null&&(l=void 0),a==="oninput"&&s[o=a]&&(o="oninputCapture"),s[o]=l}}i=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=Ze(t.children).forEach(function(c){c.props.selected=s.value.indexOf(c.props.value)!=-1})),i=="select"&&s.defaultValue!=null&&(s.value=Ze(t.children).forEach(function(c){c.props.selected=s.multiple?s.defaultValue.indexOf(c.props.value)!=-1:s.defaultValue==c.props.value})),t.class&&!t.className?(s.class=t.class,Object.defineProperty(s,"className",Fo)):(t.className&&!t.class||t.class&&t.className)&&(s.class=s.className=t.className),e.props=s}(n),n.$$typeof=Do,cn&&cn(n)};var un=V.__r;V.__r=function(n){un&&un(n),n.__c};var hn=V.diffed;V.diffed=function(n){hn&&hn(n);var e=n.props,t=n.__e;t!=null&&n.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};const qo="_root_80zc6_1",be=No(function({shape:e,viewBox:t="0 0 24 24",...i}){return u("svg",{...i,class:qo,viewBox:t,children:u("path",{d:e})})});class jo{#e=new Set;get pending(){return this.#e.size}delayed(e,t){let i=!1,s=!1;const r=()=>{s||(s=!0,this.#e.delete(o),clearTimeout(l))},o=new class{cancel(){r()}get fired(){return i}get cancelled(){return s}};this.#e.add(o);const l=setTimeout(()=>{s||(this.#e.delete(o),i=!0,t())},e);return o}repeated(e,t){let i=!1,s=!1;const r=()=>{s||(s=!0,this.#e.delete(o),clearInterval(l))},o=new class{cancel(){r()}get fired(){return i}get cancelled(){return s}};this.#e.add(o);const l=setInterval(()=>{s||(i=!0,t())},e);return o}cancelAll(){for(const e of this.#e)e.cancel();return this}}const Zo=new jo;let Yo=0;class Xo{constructor(e,t){this.message=e,this.options=t}#e=Yo+=1;#i=null;get key(){return this.#e}delayed(e,t){this.clearDelayed(),this.#i=Zo.delayed(t,e)}clearDelayed(){this.#i!=null&&(this.#i.cancel(),this.#i=null)}}const ve=ee([]);function Ko(n){ve.value=[...ve.value,n],li(n)}function Vt(n){ve.value=ve.value.filter(e=>e!==n)}function Jo(n,e){e?n.clearDelayed():li(n)}function li(n){n.options.autoClose&&n.delayed(()=>{Vt(n)},n.options.autoClose)}const ai=Mt(null);function Qo({toast:n,children:e}){return u(ai.Provider,{value:{close:()=>{Vt(n)},hover:t=>{n.options.autoClose&&n.options.pauseOnHover&&Jo(n,t)},click:()=>{n.options.closeOnClick&&Vt(n)}},children:e})}function Dt(){return Cn(ai)}function ci(n){return{onMouseEnter:()=>{n.hover(!0)},onMouseLeave:()=>{n.hover(!1)},onClick:()=>{n.click()}}}function el({children:n}){return vi(n,{...n.props,...ci(Dt())})}function tl(){const n=Dt();return u(be,{shape:lo,onClick:()=>{n.close()}})}function nl({severity:n}){switch(n){case"info":return u(il,{});case"success":return u(sl,{});case"error":return u(rl,{});default:return null}}function il(){return u(be,{shape:go})}function sl(){return u(be,{shape:oo})}function rl(){return u(be,{shape:so})}function ol({children:n,severity:e=null,closeButton:t=!0}){const i=Dt();return u("div",{class:no,...ci(i),popover:!0,children:[e&&u(nl,{severity:e}),u("div",{class:io,children:n}),t&&u(tl,{})]})}const ll="_root_1k080_1";function al(){return u("div",{class:ll,hidden:ve.value.length===0,children:[...ve.value].reverse().map(n=>u(Qo,{toast:n,children:u(el,{children:n.message})},n.key))})}function cl(n,{autoClose:e=3e3,pauseOnHover:t=!0,closeOnClick:i=!0}={}){Ko(new Xo(n,{autoClose:e,pauseOnHover:t,closeOnClick:i}))}function Se({error:n}){return u(ol,{severity:"error",children:n instanceof AggregateError?n.errors.map((e,t)=>u("p",{children:String(e)},t)):u("p",{children:String(n)})})}function ul(n,{autoClose:e=3e3,pauseOnHover:t=!0,closeOnClick:i=!1}={}){cl(u(Se,{error:n}),{autoClose:e,pauseOnHover:t,closeOnClick:i})}Se.report=ul;const hl="_root_yio74_1",fl="_header_yio74_9",pl="_headerText_yio74_14",dl="_headerButton_yio74_25",_l="_content_yio74_29",ml="_resize_yio74_36";function Ue({title:n,children:e,style:t}){const[i,s]=Ht(!0);return u("div",{class:hl,style:t,children:[u("div",{class:fl,children:[u("span",{class:pl,children:n}),u("span",{class:dl,onClick:()=>{s(!i)},children:u(be,{shape:i?$o:Lo})})]}),i&&u(le,{children:[u("div",{class:_l,children:e}),u(vl,{})]})]})}function vl(){return u("svg",{class:ml,viewBox:"0 0 24 24",children:u("path",{d:"M22,22H20V20H22V22M22,18H20V16H22V18M18,22H16V20H18V22M18,18H16V16H18V18M14,22H12V20H14V22M22,14H20V12H22V14Z"})})}const yl="_root_948vb_1",gl="_toolbar_948vb_8",bl="_schematic_948vb_17";function Vl(){return new Y(_e([["i",50,50,0,"vdc","V1",{}],["i",150,50,0,"r","R1",{}],["i",50,120,0,"g","G1",{}],["f",70,-50,"cm","I = \\frac{V}{R}"],["w",50,0,150,0],["w",50,100,150,100],["w",50,0,50,20],["w",50,80,50,100],["w",50,100,50,120],["w",150,0,150,20],["w",150,80,150,100]]))}const wl="_root_sg434_1",xl="_button_sg434_8",Cl="_separator_sg434_38";function H({children:n}){return u("div",{class:wl,children:n})}function kl({shape:n,title:e,...t}){return u("button",{...t,class:xl,title:e,children:u(be,{shape:n})})}H.Button=kl;function Ml(){return u("span",{class:Cl})}H.Separator=Ml;const Hl="_root_1bk49_1",Sl="_select_1bk49_8",Al="_content_1bk49_13";function Il(){return u("p",{children:"Capacitive reactance"})}function $l(){return u("p",{children:"Inductive reactance"})}function Ll(){return u("p",{children:"Resistive voltage divider"})}function Pl(){return u("p",{children:"LC resonance"})}function Nl(){return u("p",{children:"Wavelength and frequency"})}const Re=[{name:"Resistive voltage divider",component:Ll},{name:"Capacitive reactance",component:Il},{name:"Inductive reactance",component:$l},{name:"LC resonance",component:Pl},{name:"Wavelength and frequency",component:Nl}];function Tl(){const[n,e]=Ht(Re[0]),{component:t}=n;return u("section",{class:Hl,children:[u("select",{class:Sl,value:n.name,onInput:({target:i})=>{const{value:s}=i;e(Re.find(({name:r})=>r===s)??Re[0])},children:Re.map(({name:i})=>u("option",{value:i,children:i}))}),u("div",{class:Al,children:u(t,{})})]})}const Dl="_root_8tr57_1";function El(){return u("section",{class:Dl,children:[u("p",{children:["To draw a wire, click and start moving the pointer from a device pin, a wire end, or a wire junction. To draw a wire from any location on the grid, press ",u("kbd",{children:"W"}),". To change a wire's angle, press ",u("kbd",{children:"Shift"}),". To draw a diagonal wire, press ",u("kbd",{children:"Alt"}),"."]}),u("p",{children:"Shortcuts:"}),u("ul",{children:[u("li",{children:[u("kbd",{children:"W"})," Start drawing a wire from any point on the grid"]}),u("li",{children:[u("kbd",{children:"Shift"})," While drawing a wire, changes the angle of the wire"]}),u("li",{children:[u("kbd",{children:"Alt"})," While drawing a wire, draws a diagonal wire"]}),u("li",{children:[u("kbd",{children:"G"})," Place a ground symbol"]}),u("li",{children:[u("kbd",{children:"O"})," Place a port symbol"]}),u("li",{children:[u("kbd",{children:"V"})," Place a voltage source"]}),u("li",{children:[u("kbd",{children:"I"})," Place a current source"]}),u("li",{children:[u("kbd",{children:"R"})," Place a resistor"]}),u("li",{children:[u("kbd",{children:"C"})," Place a capacitor"]}),u("li",{children:[u("kbd",{children:"L"})," Place an inductor"]}),u("li",{children:[u("kbd",{children:"D"})," Place a diode"]}),u("li",{children:[u("kbd",{children:"N"})," Place an NPN transistor"]}),u("li",{children:[u("kbd",{children:"P"})," Place a PNP transistor"]}),u("li",{children:[u("kbd",{children:"Shift+N"})," Place an N-channel MOSFET"]}),u("li",{children:[u("kbd",{children:"Shift+P"})," Place a P-channel MOSFET"]}),u("li",{children:[u("kbd",{children:"A"})," Place an operational amplifier"]}),u("li",{children:[u("kbd",{children:"Home"})," Zoom to 100%"]}),u("li",{children:[u("kbd",{children:"Space"})," Expand or shrink to cover the whole screen"]}),u("li",{children:[u("kbd",{children:"Ctrl+X"})," Cut selected item(s) to clipboard"]}),u("li",{children:[u("kbd",{children:"Ctrl+C"})," Copy selected item(s) to clipboard"]}),u("li",{children:[u("kbd",{children:"Ctrl+V"})," Paste item(s) from clipboard"]}),u("li",{children:[u("kbd",{children:"Ctrl+A"})," Select all"]}),u("li",{children:[u("kbd",{children:"Delete"})," Delete selected item(s)"]}),u("li",{children:[u("kbd",{children:"Alt+L"})," Rotate selected item(s) to the left"]}),u("li",{children:[u("kbd",{children:"Alt+R"})," Rotate selected item(s) to the right"]}),u("li",{children:[u("kbd",{children:"Alt+H"})," Flip selected item(s) from left to right"]}),u("li",{children:[u("kbd",{children:"Alt+V"})," Flip selected item(s) from top to bottom"]}),u("li",{children:[u("kbd",{children:"Ctrl+Z"})," Undo"]}),u("li",{children:[u("kbd",{children:"Ctrl+Y"})," Redo"]})]})]})}function Gl(){const n=re();return u(H,{children:[u(H.Button,{shape:_o,title:"Open schematic",onClick:()=>{Se.report("Not implemented")}}),u(H.Button,{shape:vo,title:"Save schematic",onClick:()=>{Se.report("Not implemented")}}),u(H.Button,{shape:mo,title:"New schematic",onClick:()=>{Se.report("Not implemented")}}),u(H.Separator,{}),u(H.Button,{shape:Ho,title:"Select all",onClick:()=>{n.select("all"),n.focus()}}),u(H.Button,{shape:So,title:"Invert selection",onClick:()=>{n.select("invert"),n.focus()}}),u(H.Button,{shape:Ao,title:"Clear selection",onClick:()=>{n.select("none"),n.focus()}}),u(H.Separator,{}),u(H.Button,{shape:co,title:"Cut selected item(s) to clipboard",onClick:()=>{n.selectionCut(),n.focus()}}),u(H.Button,{shape:ao,title:"Copy selected item(s) to clipboard",onClick:()=>{n.selectionCopy(),n.focus()}}),u(H.Button,{shape:uo,title:"Paste item(s) from clipboard",onClick:()=>{n.selectionPaste(),n.focus()}}),u(H.Button,{shape:ho,title:"Delete selected item(s)",onClick:()=>{n.selectionDelete(),n.focus()}}),u(H.Separator,{}),u(H.Button,{shape:ko,title:"Rotate selected item(s) to the left",disabled:!n.selection.full,onClick:()=>{n.transformSelection("rl")}}),u(H.Button,{shape:Mo,title:"Rotate selected item(s) to the right",disabled:!n.selection.full,onClick:()=>{n.transformSelection("rr")}}),u(H.Button,{shape:fo,title:"Flip selected item(s) from left to right",disabled:!n.selection.full,onClick:()=>{n.transformSelection("mx")}}),u(H.Button,{shape:po,title:"Flip selected item(s) from top to bottom",disabled:!n.selection.full,onClick:()=>{n.transformSelection("my")}}),u(H.Separator,{}),u(H.Button,{shape:Io,title:"Undo",disabled:!n.canUndo,onClick:()=>{n.undo(),n.focus()}}),u(H.Button,{shape:Co,title:"Redo",disabled:!n.canRedo,onClick:()=>{n.redo(),n.focus()}}),u(H.Separator,{}),u(H.Button,{shape:bo,title:"Zoom 100%",onClick:()=>{n.zoomTo("1"),n.focus()}}),u(H.Button,{shape:xo,title:"Zoom in",onClick:()=>{n.zoomTo("+"),n.focus()}}),u(H.Button,{shape:wo,title:"Zoom out",onClick:()=>{n.zoomTo("-"),n.focus()}}),u(H.Button,{shape:Vo,title:"View all",onClick:()=>{n.zoomTo("all"),n.focus()}}),u(H.Separator,{}),u(H.Button,{shape:ro,title:"Calculator",onClick:()=>{nn(u(Tl,{}),{modal:!0,onClose:()=>{n.focus()}})}}),u(H.Separator,{}),u(H.Button,{shape:yo,title:"Help",onClick:()=>{nn(u(El,{}),{modal:!0,onClose:()=>{n.focus()}})}})]})}function Bl(){const n=tt(()=>new pr(Tn,Vl()),[]);return et(()=>{const e=Kn(["Alt+v",()=>{}],["Alt+h",()=>{}],["Alt+r",()=>{}],["Alt+l",()=>{}],["Ctrl+a",()=>{}],["Ctrl+s",()=>{}],["Ctrl+o",()=>{}],["Ctrl+n",()=>{}],["Ctrl+r",()=>{}]);return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[n]),u(Qn.Provider,{value:n,children:[u("main",{class:yl,children:[u("div",{class:gl,children:u(Gl,{})}),u("div",{class:bl,children:u(Fr,{})}),u(Ue,{title:"Instances",style:{insetInlineEnd:"38rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:u(vr,{})}),u(Ue,{title:"Nodes",style:{insetInlineEnd:"20rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:u(Sr,{})}),u(Ue,{title:"Library",style:{insetInlineEnd:"2rem",insetBlockStart:"4rem",inlineSize:"15rem"},children:u(xr,{})}),u(Ue,{title:"Properties",style:{insetInlineStart:"2rem",insetBlockStart:"4rem",inlineSize:"20rem"},children:u(Nr,{})})]}),u(to,{}),u(al,{})]})}mi(u(Bl,{}),document.querySelector("#app"));
